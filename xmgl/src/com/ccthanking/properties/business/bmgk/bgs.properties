FEGL=select  b.row_id ngdw, nvl(ZS,0) ZS,\
       nvl(pj,0) pj,\
       nvl(yj,0) yj,\
       nvl(jj,0) jj,\
       nvl(tj,0) tj \
       from (select  ngdw,\
       count(*) ZS,\
       sum(decode(a.hj, '1', 1, 0)) pj,\
       sum(decode(a.hj, '2', 1, 0)) yj,\
       sum(decode(a.hj, '3', 1, 0)) jj,\
       sum(decode(a.hj, '4', 1, 0)) tj \
  	   from xtbg_gwgl_fwgl a where 1=1 and a.sfyx='1'NDTJ \
	   group by a.ngdw ) a,FS_ORG_DEPT b  \
 where a.ngdw(+)=b.row_id \
	    union all  \
	 	SELECT '<b>合计</b>' hj,\
       COUNT(*) ZS,\
       nvl(SUM(DECODE(A.HJ, '1', 1, 0)),0) PJ,\
       nvl(SUM(DECODE(A.HJ, '2', 1, 0)),0) YJ,\
      nvl(SUM(DECODE(A.HJ, '3', 1, 0)),0) JJ,\
       nvl(SUM(DECODE(A.HJ, '4', 1, 0)),0) TJ \
 	FROM xtbg_gwgl_fwgl A  where 1=1 and a.sfyx='1' NDTJ  order by ngdw asc 
SWGL=select wz,\
       count(*) ZS,\
       sum(decode(a.hj, '1', 1, 0)) pj,\
       sum(decode(a.hj, '2', 1, 0)) yj,\
       sum(decode(a.hj, '3', 1, 0)) jj,\
       sum(decode(a.hj, '4', 1, 0)) tj \
	 from xtbg_gwgl_swgl a where 1=1 and a.sfyx='1' NDTJ group by  a.wz \
	 union all  \
		 	SELECT '<b>合计</b>' hj,\
	       COUNT(*) ZS,\
	       nvl(SUM(DECODE(A.HJ, '1', 1, 0)),0) PJ,\
	       nvl(SUM(DECODE(A.HJ, '2', 1, 0)),0) YJ,\
	       nvl(SUM(DECODE(A.HJ, '3', 1, 0)),0) JJ,\
	       nvl(SUM(DECODE(A.HJ, '4', 1, 0)),0) TJ \
	 	FROM XTBG_GWGL_SWGL A  where 1=1 and a.sfyx='1' NDTJ    

LCZXQK=with lsb as( \
	 	select g.ROW_ID cjdwdm,nvl(lczs,0) lczs,nvl(lcwc,0) lcwc,nvl(lczcblz,0) lczcblz,nvl(lcyj,0) lcyj,nvl(lccq,0) lccq,nvl(lccqwwc,0) lccqwwc from ( \
		select count(*) lczs,cjdwdm from ap_processinfo  ap  where 1=1   NDTJ  group by ap.cjdwdm) a , \
		(select count(*) lcwc, cjdwdm \
	 	 from ap_processinfo ap \
		 where  ap.result = '1'  NDTJ \
		 group by ap.cjdwdm)e, \
		(select count(*) lczcblz, cjdwdm \
		 from ap_processinfo ap \
		 where   1=1 NDTJ  \
           and result='0'  and  ap.processoid not in \
	       (select PROCESSOID \
          from (select apdt.PROCESSOID, \
                       STEPSEQUENCE, \
                       NAME, \
                       ap.result, \
                       ap.CLOSETIME, \
                       SHEDULE_TIME, \
                       (apdt.closetime - SHEDULE_TIME) * 24 as timex, \
                       (sysdate - SHEDULE_TIME) * 24 as timey \
                  from ap_processdetail apdt, ap_processinfo ap  \
                 where apdt.processoid = ap.processoid  NDTJ) a \
         where  \
        timey>0 \
         group by a.PROCESSOID) \
 group by cjdwdm) b, \
(select count(*) lcyj, cjdwdm \
  from ap_processinfo ap \
 where   1=1 NDTJ and  ap.processoid in \
       (select PROCESSOID \
          from (select apdt.PROCESSOID, \
                       STEPSEQUENCE, \
                       NAME, \
                       ap.result, \
                       ap.CLOSETIME, \
                       SHEDULE_TIME, \
                       (apdt.closetime - SHEDULE_TIME) * 24 as timex, \
                       (sysdate - SHEDULE_TIME) * 24 as timey \
                  from ap_processdetail apdt, ap_processinfo ap \
                 where apdt.processoid = ap.processoid  NDTJ ) a \
         where a.SHEDULE_TIME is not null \
           and result='0' \
           and TRUNC(SYSDATE + 5) > SHEDULE_TIME \
           AND TRUNC(SYSDATE) < SHEDULE_TIME \
         group by a.PROCESSOID) \
 group by cjdwdm)c, \
 (select count(*) lccq, cjdwdm \
  from ap_processinfo ap \
 where 1=1 NDTJ and  ap.processoid in \
       (select PROCESSOID \
          from (select apdt.PROCESSOID, \
                       STEPSEQUENCE, \
                       NAME, \
                       ap.result, \
                       ap.CLOSETIME, \
                       SHEDULE_TIME, \
                       (apdt.closetime - SHEDULE_TIME) * 24 as timex, \
                       (sysdate - SHEDULE_TIME) * 24 as timey \
                  from ap_processdetail apdt, ap_processinfo ap \
                 where apdt.processoid = ap.processoid  NDTJ) a \
         where  result='1' and CLOSETIME is not null \
           AND timex>0 \
         group by a.PROCESSOID) \
 group by cjdwdm)d, \
( select count(*) lccqwwc, cjdwdm \
  from ap_processinfo ap \
 where 1=1 NDTJ and ap.processoid in \
       (select PROCESSOID \
          from (select apdt.PROCESSOID, \
                       STEPSEQUENCE, \
                       NAME, \
                       ap.result, \
                       ap.CLOSETIME, \
                       SHEDULE_TIME, \
                       (apdt.closetime - SHEDULE_TIME) * 24 as timex, \
                       (sysdate - SHEDULE_TIME) * 24 as timey \
                  from ap_processdetail apdt, ap_processinfo ap \
                 where apdt.processoid = ap.processoid  NDTJ) a \
         where  result='0'  \
           AND timey>0 \
         group by a.PROCESSOID) \
 group by cjdwdm)f, \
  FS_ORG_DEPT g  \
 where a.cjdwdm(+)=g.ROW_ID and b.cjdwdm(+)=g.ROW_ID and c.cjdwdm(+)=g.ROW_ID and d.cjdwdm(+)=g.ROW_ID and f.cjdwdm(+)=g.ROW_ID and g.ROW_ID=e.cjdwdm(+) \
 order by cjdwdm asc) \
 select * from lsb \
 union all \
 select '<b>合计</b>' cjdwdm, sum(lczs),sum(lcwc),sum(lczcblz),sum(lcyj),sum(lccq),sum(lccqwwc)  from lsb \

CZWT=select nvl(YJJZJ, '0') YJJZJ,nvl(WYJJZJ, '0') WYJJZJ,nvl(YJJYBWT, '0') YJJYBWT,\
		nvl(YJJYZWT, '0') YJJYZWT,nvl(YJJJQYZWT, '0') YJJJQYZWT,\
		nvl(WJJYBWT, '0') WJJYBWT,nvl(WJJYZWT, '0') WJJYZWT,nvl(WJJJQYZWT, '0') WJJJQYZWT,\
		b.row_id LRBM from ( SELECT nvl(SUM(DECODE(A.SJZT, '6', 1, 0)),'0')  YJJZJ, \
       nvl(SUM(DECODE(A.SJZT, '6', 0, 1)),'0')  WYJJZJ, \
       nvl(SUM(DECODE(A.SJZT, '6', DECODE(A.WTXZ, '11', 1, 0), 0)),'0')  YJJYBWT, \
       nvl(SUM(DECODE(A.SJZT, '6', DECODE(A.WTXZ, '12', 1, 0), 0)),'0')  YJJYZWT, \
      nvl( SUM(DECODE(A.SJZT, '6', DECODE(A.WTXZ, '13', 1, 0), 0)),'0')  YJJJQYZWT, \
       nvl(SUM(DECODE(A.SJZT, '6', 0, DECODE(A.WTXZ, '11', 1, 0))),'0')  WJJYBWT, \
       nvl(SUM(DECODE(A.SJZT, '6', 0, DECODE(A.WTXZ, '12', 1, 0))),'0')  WJJYZWT, \
       nvl(SUM(DECODE(A.SJZT, '6', 0, DECODE(A.WTXZ, '13', 1, 0))),'0')  WJJJQYZWT, \
       LRBM \
	   FROM WTTB_INFO A WHERE 1=1 and a.sfyx='1'  NDTJ \
	   GROUP BY A.LRBM ) a,FS_ORG_DEPT b where a.LRBM(+)=b.row_id  \
	    union all \
  SELECT nvl(SUM(DECODE(A.SJZT, '6', 1, 0)),'0')  YJJZJ, \
       nvl(SUM(DECODE(A.SJZT, '6', 0, 1)),'0') WYJJZJ, \
       nvl(SUM(DECODE(A.SJZT, '6', DECODE(A.WTXZ, '11', 1, 0), 0)),'0')  YJJYBWT, \
       nvl(SUM(DECODE(A.SJZT, '6', DECODE(A.WTXZ, '12', 1, 0), 0)),'0')  YJJYZWT, \
       nvl(SUM(DECODE(A.SJZT, '6', DECODE(A.WTXZ, '13', 1, 0), 0)),'0')  YJJJQYZWT, \
       nvl(SUM(DECODE(A.SJZT, '6', 0, DECODE(A.WTXZ, '11', 1, 0))),'0')  WJJYBWT, \
       nvl(SUM(DECODE(A.SJZT, '6', 0, DECODE(A.WTXZ, '12', 1, 0))),'0')  WJJYZWT, \
       nvl(SUM(DECODE(A.SJZT, '6', 0, DECODE(A.WTXZ, '13', 1, 0))),'0')  WJJJQYZWT, \
       '<b>合计</b>' hj \
 FROM WTTB_INFO A  WHERE 1=1 and a.sfyx='1'  NDTJ \
 order by LRBM asc

TCJHJD= with  lsb  as  (select '手续情况' JD, zs, \
       wc, \
       hpjds + kypf + GCXKZ + SGXK zc, \
       yjhpjds + yjkypf + yjGCXKZ + yjSGXK yj, \
       cqwchpjds + cqwckypf + cqwcGCXKZ + cqwcyjSGXK cqwc, \
       wwyfklx + wwyfksg + wwyfkgh + wwyfktd wwyfk, \
       wwwfkhpjds + wwwfkkypf + wwwfkGCXKZ + wwwfkSGXK wwwfk \
  from (select sum(DECODE(A.ISKYPF, '1', 1, 0)) + \
               sum(DECODE(A.ishpjds, '1', 1, 0)) + \
               sum(DECODE(A.isGCXKZ, '1', 1, 0)) + \
               sum(DECODE(A.isSGXK, '1', 1, 0)) zs, \
               sum(decode(a.kypf_sj, null, 0, 1)) + \
               sum(decode(a.hpjds_sj, null, 0, 1)) + \
               sum(decode(a.GCXKZ_SJ, null, 0, 1)) + \
               sum(decode(a.SGXK_SJ, null, 0, 1)) WC \
          from gc_jh_sj a where a.sfyx='1' NDTJ ) a, \
       (select count(*) kypf \
          from gc_jh_sj b \
         where  b.kypf_sj is null \
           and b.iskypf = '1' \
           and (trunc(SYSDATE) < b.kypf or b.kypf is null ) and  b.sfyx='1' NDTJ) b, \
       (select count(*) hpjds \
          from gc_jh_sj b \
         where  b.hpjds_sj is null \
           and b.ishpjds = '1' \
           and (trunc(SYSDATE) < b.hpjds or b.hpjds is null) and  b.sfyx='1' NDTJ) c, \
       (select count(*) GCXKZ \
          from gc_jh_sj b \
         where b.GCXKZ_sj is null \
           and b.isGCXKZ = '1' \
           and (trunc(SYSDATE) < b.GCXKZ or b.GCXKZ is null) and  b.sfyx='1' NDTJ) d, \
       (select count(*) SGXK \
          from gc_jh_sj b \
         where  b.SGXK_sj is null \
           and b.isSGXK = '1' \
           and (trunc(SYSDATE) < b.SGXK or b.SGXK is null) and  b.sfyx='1' NDTJ) e, \
       (select count(*) yjkypf \
          from gc_jh_sj b \
         where b.kypf is not null \
           and b.kypf_sj is null \
           and b.iskypf = '1' \
           and trunc(SYSDATE + 5) > b.kypf \
           and trunc(SYSDATE) < b.kypf and  b.sfyx='1' NDTJ) yjf, \
       (select count(*) yjhpjds \
          from gc_jh_sj b \
         where b.hpjds is not null \
           and b.hpjds_sj is null \
           and b.ishpjds = '1' \
           and trunc(SYSDATE + 5) > b.hpjds \
           and trunc(SYSDATE) < b.hpjds and  b.sfyx='1' NDTJ) yjg, \
       (select count(*) yjGCXKZ \
          from gc_jh_sj b \
         where b.GCXKZ is not null \
           and b.GCXKZ_sj is null \
           and b.isGCXKZ = '1' \
           and trunc(SYSDATE + 5) > b.GCXKZ \
           and trunc(SYSDATE) < b.GCXKZ and  b.sfyx='1' NDTJ) yjh, \
       (select count(*) yjSGXK \
          from gc_jh_sj b \
         where b.SGXK is not null \
           and b.SGXK_sj is null \
           and b.isSGXK = '1' \
           and trunc(SYSDATE + 5) > b.SGXK \
           and trunc(SYSDATE) < b.SGXK and  b.sfyx='1' NDTJ) yji, \
       (select count(*) cqwckypf \
          from gc_jh_sj b \
         where b.kypf_sj is not null \
           and b.iskypf = '1' \
           and trunc(b.kypf_sj) > trunc(b.kypf) and  b.sfyx='1' NDTJ) cqwcf, \
       (select count(*) cqwchpjds \
          from gc_jh_sj b \
         where b.hpjds_sj is not null \
           and trunc(b.hpjds_sj) > trunc(b.hpjds) and  b.sfyx='1' NDTJ) cqwcfg, \
       (select count(*) cqwcGCXKZ \
          from gc_jh_sj b \
         where b.GCXKZ_sj is not null \
           and b.isGCXKZ = '1' \
           and trunc(b.GCXKZ_sj) > trunc(b.GCXKZ) and  b.sfyx='1' NDTJ) cqwcfh, \
       (select count(*) cqwcyjSGXK \
          from gc_jh_sj b \
         where b.SGXK_sj is not null \
           and b.isSGXK = '1' \
           and trunc(b.SGXK_sj) > trunc(b.SGXK) and  b.sfyx='1' NDTJ) cqwcfi, \
       (select count(distinct(a.gc_jh_sj_id)) wwyfklx \
          from gc_jh_sj a, gc_jh_fkqk b \
         where a.kypf_sj is null \
           and a.iskypf = '1' \
           and a.gc_jh_sj_id = b.jhsjid \
           and a.kypf is not null and trunc(SYSDATE) > a.kypf \
           and b.fklx = '1003002' and  b.sfyx='1' NDTJ ) wwyfklxa, \
       (select count(distinct(a.gc_jh_sj_id)) wwyfksg \
          from gc_jh_sj a, gc_jh_fkqk b \
         where a.sgxk_sj is null \
           and a.issgxk = '1' \
           and a.gc_jh_sj_id = b.jhsjid \
           and a.sgxk is not null and trunc(SYSDATE) > a.sgxk \
           and b.fklx = '1003008' and  b.sfyx='1' NDTJ ) wwyfksg, \
       (select count(distinct(a.gc_jh_sj_id)) wwyfktd \
          from gc_jh_sj a, gc_jh_fkqk b \
         where a.hpjds_sj is null \
           and a.ishpjds = '1' \
           and a.gc_jh_sj_id = b.jhsjid \
           and a.hpjds is not null and trunc(SYSDATE) > a.hpjds \
           and b.fklx = '1003004' and  a.sfyx='1' NDTJ) wwyfktd, \
       (select count(distinct(a.gc_jh_sj_id)) wwyfkgh \
          from gc_jh_sj a, gc_jh_fkqk b \
         where a.gcxkz_sj is null \
           and a.isgcxkz = '1' \
           and a.gc_jh_sj_id = b.jhsjid \
           and a.gcxkz is not null and trunc(SYSDATE) > a.gcxkz \
           and b.fklx = '1003006' and  a.sfyx='1' NDTJ) wwyfkgh, \
       (select count(*) wwwfkkypf \
          from gc_jh_sj a \
         where a.kypf_sj is null \
           and a.iskypf = '1'  and  a.sfyx='1' NDTJ\
           and a.kypf is not null and trunc(SYSDATE) > a.kypf \
           and a.gc_jh_sj_id not in \
               ((select distinct (a.gc_jh_sj_id) wwyfklx \
                  from gc_jh_sj a, gc_jh_fkqk b \
                 where a.gc_jh_sj_id = b.jhsjid \
                   and b.fklx = '1003002'))) wwwfkkypf, \
       (select count(*) wwwfksgxk \
          from gc_jh_sj a \
         where a.sgxk_sj is null \
           and a.issgxk = '1' and  a.sfyx='1' NDTJ \
           and a.sgxk is not null and trunc(SYSDATE) > a.sgxk \
           and a.gc_jh_sj_id not in \
               ((select distinct (a.gc_jh_sj_id) wwyfklx \
                  from gc_jh_sj a, gc_jh_fkqk b \
                 where a.gc_jh_sj_id = b.jhsjid \
                   and b.fklx = '1003008'))) wwwfksgxk, \
       (select count(*) wwwfkhpjds \
          from gc_jh_sj a \
         where a.hpjds_sj is null \
           and a.ishpjds = '1' and  a.sfyx='1' NDTJ \
           and a.hpjds is not null and trunc(SYSDATE) > a.hpjds \
           and a.gc_jh_sj_id not in \
               ((select distinct (a.gc_jh_sj_id) wwyfklx \
                  from gc_jh_sj a, gc_jh_fkqk b \
                 where a.gc_jh_sj_id = b.jhsjid \
                   and b.fklx = '1003004'))) wwwfkhpjds, \
       (select count(*) wwwfkGCXKZ \
          from gc_jh_sj a \
         where a.GCXKZ_sj is null \
           and a.isGCXKZ = '1' and  a.sfyx='1' NDTJ \
           and a.GCXKZ is not null and trunc(SYSDATE) > a.GCXKZ \
           and a.gc_jh_sj_id not in \
               ((select distinct (a.gc_jh_sj_id) wwyfklx \
                  from gc_jh_sj a, gc_jh_fkqk b \
                 where a.gc_jh_sj_id = b.jhsjid \
                   and b.fklx = '1003006'))) wwwfkGCXKZ \
		union all \
		SELECT '设计情况' JD,ZS, \
       WC, \
       CQT  + CBSJPF + PQT + SGT ZC, \
       YJCQT  + YJCBSJPF + YJPQT + YJSGT YJ, \
       CQWCCQT  + CQWCCBSJPF + CQWCPQT + CQWCSGT CQWC, \
       WWYFKCQT + WWYFKCBSJPF + WWYFKPQT + WWYFKSGT WWYFK, \
       WWWFKCQT  + WWWFKCBSJPF + WWWFKPQT + WWWFKSGT WWWFK \
  FROM (SELECT SUM(DECODE(A.ISCBSJPF, '1', 1, 0)) + \
               SUM(DECODE(A.ISCQT , '1', 1, 0)) + \
               SUM(DECODE(A.ISPQT, '1', 1, 0)) + \
               SUM(DECODE(A.ISSGT, '1', 1, 0)) ZS, \
               SUM(DECODE(A.CBSJPF_SJ, NULL, 0, 1)) + \
               SUM(DECODE(A.CQT_SJ, NULL, 0, 1)) + \
               SUM(DECODE(A.PQT_SJ, NULL, 0, 1)) + \
               SUM(DECODE(A.SGT_SJ, NULL, 0, 1)) WC \
          FROM GC_JH_SJ  A WHERE A.SFYX='1' NDTJ ) A, \
       (SELECT COUNT(*) CBSJPF \
          FROM GC_JH_SJ B \
         WHERE  B.CBSJPF_SJ IS NULL \
           AND B.ISCBSJPF = '1' \
           AND (TRUNC(SYSDATE) < B.CBSJPF or b.CBSJPF is null) AND  B.SFYX='1' NDTJ) B, \
       (SELECT COUNT(*) CQT  \
          FROM GC_JH_SJ B \
         WHERE  B.CQT_SJ IS NULL \
           AND B.ISCQT  = '1' \
           AND (TRUNC(SYSDATE) < B.CQT or B.CQT is null)  AND  B.SFYX='1' NDTJ) C, \
       (SELECT COUNT(*) PQT \
          FROM GC_JH_SJ B \
         WHERE  B.PQT_SJ IS NULL \
           AND B.ISPQT = '1' \
           AND (TRUNC(SYSDATE) < B.PQT or B.PQT is null ) AND  B.SFYX='1' NDTJ) D, \
       (SELECT COUNT(*) SGT \
          FROM GC_JH_SJ B \
         WHERE  B.SGT_SJ IS NULL \
           AND B.ISSGT = '1' \
           AND (TRUNC(SYSDATE) < B.SGT or B.SGT is null ) AND  B.SFYX='1' NDTJ) E, \
       (SELECT COUNT(*) YJSGT \
          FROM GC_JH_SJ B \
         WHERE B.CBSJPF IS NOT NULL \
           AND B.CBSJPF_SJ IS NULL \
           AND B.ISCBSJPF = '1' \
           AND TRUNC(SYSDATE + 5) > B.CBSJPF \
           AND TRUNC(SYSDATE) < B.CBSJPF AND  B.SFYX='1' NDTJ) YJF, \
       (SELECT COUNT(*) YJCQT  \
          FROM GC_JH_SJ B \
         WHERE B.CQT  IS NOT NULL \
           AND B.CQT_SJ IS NULL \
           AND B.ISCQT  = '1' \
           AND TRUNC(SYSDATE + 5) > B.CQT  \
           AND TRUNC(SYSDATE) < B.CQT  AND  B.SFYX='1' NDTJ) YJG, \
       (SELECT COUNT(*) YJPQT \
          FROM GC_JH_SJ B \
         WHERE B.PQT IS NOT NULL \
           AND B.PQT_SJ IS NULL \
           AND B.ISPQT = '1' \
           AND TRUNC(SYSDATE + 5) > B.PQT \
           AND TRUNC(SYSDATE) < B.PQT AND  B.SFYX='1' NDTJ) YJH, \
       (SELECT COUNT(*) YJCBSJPF \
          FROM GC_JH_SJ B \
         WHERE B.CBSJPF IS NOT NULL \
           AND B.CBSJPF_SJ IS NULL \
           AND B.ISCBSJPF = '1' \
           AND TRUNC(SYSDATE + 5) > B.CBSJPF \
           AND TRUNC(SYSDATE) < B.CBSJPF AND  B.SFYX='1' NDTJ) YJI, \
       (SELECT COUNT(*) CQWCCBSJPF \
          FROM GC_JH_SJ B \
         WHERE B.CBSJPF_SJ IS NOT NULL \
           AND B.ISCBSJPF = '1' \
           AND TRUNC(B.CBSJPF_SJ) > TRUNC(B.CBSJPF) AND  B.SFYX='1' NDTJ) CQWCF, \
       (SELECT COUNT(*) CQWCCQT  \
          FROM GC_JH_SJ B \
         WHERE B.CQT_SJ IS NOT NULL \
           AND TRUNC(B.CQT_SJ) > TRUNC(B.CQT ) AND  B.SFYX='1' NDTJ) CQWCFG, \
       (SELECT COUNT(*) CQWCPQT \
          FROM GC_JH_SJ B \
         WHERE B.PQT_SJ IS NOT NULL \
           AND B.ISPQT = '1' \
           AND TRUNC(B.PQT_SJ) > TRUNC(B.PQT) AND  B.SFYX='1' NDTJ) CQWCFH, \
       (SELECT COUNT(*) CQWCSGT \
          FROM GC_JH_SJ B \
         WHERE B.SGT_SJ IS NOT NULL \
           AND B.ISSGT = '1' \
           AND TRUNC(B.SGT_SJ) > TRUNC(B.SGT) AND  B.SFYX='1' NDTJ) CQWCFI, \
       (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKCBSJPF \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.CBSJPF_SJ IS NULL \
           AND A.ISCBSJPF = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
           and a.CBSJPF is not null and trunc(SYSDATE) > a.CBSJPF \
           AND B.FKLX = '1007002' AND  A.SFYX='1' NDTJ ) WWYFKLXA, \
       (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKSGT \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.SGT_SJ IS NULL \
           AND A.ISSGT  = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
           and a.SGT is not null and trunc(SYSDATE) > a.SGT \
           AND B.FKLX = '1007008' AND  A.SFYX='1' NDTJ ) WWYFKSG, \
       (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKCQT \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.CQT_SJ IS NULL \
           AND A.ISCQT  = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
           and a.CQT is not null and trunc(SYSDATE) > a.CQT \
           AND B.FKLX = '1007004' AND  A.SFYX='1' NDTJ) WWYFKTD, \
       (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKPQT \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.PQT_SJ IS NULL \
           AND A.ISPQT = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
           and a.PQT is not null and trunc(SYSDATE) > a.PQT \
           AND B.FKLX = '1007006' AND  A.SFYX='1' NDTJ) WWYFKGH, \
       (SELECT COUNT(*) WWWFKSGT \
          FROM GC_JH_SJ A \
         WHERE A.SGT_SJ IS NULL \
           AND A.ISSGT = '1'  AND  A.SFYX='1' NDTJ\
            and a.SGT is not null and trunc(SYSDATE) > a.SGT \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '1007008'))) WWWSGT, \
       (SELECT COUNT(*) WWWFKCBSJPF  \
          FROM GC_JH_SJ A \
         WHERE A.CBSJPF_SJ IS NULL \
           AND A.ISCBSJPF  = '1' AND  A.SFYX='1' NDTJ \
            and a.CBSJPF is not null and trunc(SYSDATE) > a.CBSJPF \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '1007002'))) WWWFKCBSJPF , \
       (SELECT COUNT(*) WWWFKCQT  \
          FROM GC_JH_SJ A \
         WHERE A.CQT_SJ IS NULL \
           AND A.ISCQT  = '1' AND  A.SFYX='1' NDTJ \
            and a.CQT is not null and trunc(SYSDATE) > a.CQT \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '1007004'))) WWWFKCQT , \
       (SELECT COUNT(*) WWWFKPQT \
          FROM GC_JH_SJ A \
         WHERE A.PQT_SJ IS NULL \
           AND A.ISPQT = '1' AND  A.SFYX='1' NDTJ \
           and a.PQT is not null and trunc(SYSDATE) > a.PQT \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '1007006'))) WWWFKPQT \
   union all \
	SELECT '造价情况' JD,ZS, \
       WC, \
       TBJ  + CS ZC, \
       YJTBJ  + YJCS YJ, \
       CQWCTBJ  + CQWCCS CQWC, \
       WWYFKTBJ + WWYFKCS  WWYFK, \
       WWWFKTBJ  + WWWFKCS  WWWFK \
  FROM (SELECT SUM(DECODE(A.ISCS, '1', 1, 0)) + \
               SUM(DECODE(A.ISTBJ , '1', 1, 0)) ZS, \
               SUM(DECODE(A.CS_SJ, NULL, 0, 1)) + \
               SUM(DECODE(A.TBJ_SJ, NULL, 0, 1))\ WC \
          FROM GC_JH_SJ  A WHERE A.SFYX='1' NDTJ ) A, \
       (SELECT COUNT(*) CS \
          FROM GC_JH_SJ B \
         WHERE B.CS_SJ IS NULL \
           AND B.ISCS = '1' \
           AND (TRUNC(SYSDATE) < B.CS or b.cs is null) AND  B.SFYX='1' NDTJ) B, \
       (SELECT COUNT(*) TBJ  \
          FROM GC_JH_SJ B \
         WHERE B.TBJ_SJ IS NULL \
           AND B.ISTBJ  = '1' \
           AND (TRUNC(SYSDATE) < B.TBJ or b.tbj is null)  AND  B.SFYX='1' NDTJ) C, \
    (SELECT COUNT(*) YJTBJ  \
          FROM GC_JH_SJ B \
         WHERE B.TBJ  IS NOT NULL \
           AND B.TBJ_SJ IS NULL \
           AND B.ISTBJ  = '1' \
           AND TRUNC(SYSDATE + 5) > B.TBJ  \
           AND TRUNC(SYSDATE) < B.TBJ  AND  B.SFYX='1' NDTJ) YJG, \
      (SELECT COUNT(*) YJCS \
          FROM GC_JH_SJ B \
         WHERE B.SGT IS NOT NULL \
           AND B.SGT_SJ IS NULL \
           AND B.ISSGT = '1' \
           AND TRUNC(SYSDATE + 5) > B.SGT \
           AND TRUNC(SYSDATE) < B.SGT AND  B.SFYX='1' NDTJ) YJI, \
       (SELECT COUNT(*) CQWCCS \
          FROM GC_JH_SJ B \
         WHERE B.CS_SJ IS NOT NULL \
           AND B.ISCS = '1' \
           AND TRUNC(B.CS_SJ) > TRUNC(B.CS) AND  B.SFYX='1' NDTJ) CQWCF, \
       (SELECT COUNT(*) CQWCTBJ  \
          FROM GC_JH_SJ B \
         WHERE B.TBJ_SJ IS NOT NULL \
           AND TRUNC(B.TBJ_SJ) > TRUNC(B.TBJ ) AND  B.SFYX='1' NDTJ) CQWCFG, \
       (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKCS \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.CS_SJ IS NULL \
           AND A.ISCS = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
           and a.CS is not null and trunc(SYSDATE) > a.CS \
           AND B.FKLX = '2001102' AND  A.SFYX='1' NDTJ ) WWYFKLXA, \
       (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKTBJ \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.TBJ_SJ IS NULL \
           AND A.ISTBJ  = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
           and a.TBJ is not null and trunc(SYSDATE) > a.TBJ \
           AND B.FKLX = '2001002' AND  A.SFYX='1' NDTJ) WWYFKTD, \
       (SELECT COUNT(*) WWWFKCS  \
          FROM GC_JH_SJ A \
         WHERE A.CS_SJ IS NULL \
           AND A.ISCS  = '1' AND  A.SFYX='1' NDTJ \
           and a.CS is not null and trunc(SYSDATE) > a.CS \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '2001102'))) WWWFKCS , \
       (SELECT COUNT(*) WWWFKTBJ  \
          FROM GC_JH_SJ A \
         WHERE A.TBJ_SJ IS NULL \
           AND A.ISTBJ  = '1' AND  A.SFYX='1' NDTJ \
           and a.TBJ is not null and trunc(SYSDATE) > a.TBJ \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '2001002'))) WWWFKTBJ \
                      union all \
        SELECT '招标情况' JD,ZS, \
       WC, \
       JLDW  + SGDW ZC, \
       YJJLDW  + YJSGDW YJ, \
       CQWCJLDW  + CQWCSGDW CQWC, \
       WWYFKJLDW + WWYFKSGDW  WWYFK, \
       WWWFKJLDW  + WWWFKSGDW  WWWFK \
  FROM (SELECT SUM(DECODE(A.ISSGDW, '1', 1, 0)) + \
               SUM(DECODE(A.ISJLDW , '1', 1, 0)) ZS, \
               SUM(DECODE(A.SGDW_SJ, NULL, 0, 1)) + \
               SUM(DECODE(A.JLDW_SJ, NULL, 0, 1))\ WC \
          FROM GC_JH_SJ  A WHERE A.SFYX='1' NDTJ ) A, \
       (SELECT COUNT(*) SGDW \
          FROM GC_JH_SJ B \
         WHERE B.SGDW_SJ IS NULL \
           AND B.ISSGDW = '1' \
           AND (TRUNC(SYSDATE) < B.SGDW or B.SGDW is null) AND  B.SFYX='1' NDTJ) B, \
       (SELECT COUNT(*) JLDW  \
          FROM GC_JH_SJ B \
         WHERE B.JLDW_SJ IS NULL \
           AND B.ISJLDW  = '1' \
           AND (TRUNC(SYSDATE) < B.JLDW or B.JLDW is null)  AND  B.SFYX='1' NDTJ) C, \
    (SELECT COUNT(*) YJJLDW  \
          FROM GC_JH_SJ B \
         WHERE B.JLDW  IS NOT NULL \
           AND B.JLDW_SJ IS NULL \
           AND B.ISJLDW  = '1' \
           AND TRUNC(SYSDATE + 5) > B.JLDW  \
           AND TRUNC(SYSDATE) < B.JLDW  AND  B.SFYX='1' NDTJ) YJG, \
      (SELECT COUNT(*) YJSGDW \
          FROM GC_JH_SJ B \
         WHERE B.SGDW IS NOT NULL \
           AND B.SGDW_SJ IS NULL \
           AND B.ISSGDW = '1' \
           AND TRUNC(SYSDATE + 5) > B.SGDW \
           AND TRUNC(SYSDATE) < B.SGDW AND  B.SFYX='1' NDTJ) YJI, \
       (SELECT COUNT(*) CQWCSGDW \
          FROM GC_JH_SJ B \
         WHERE B.SGDW_SJ IS NOT NULL \
           AND B.ISSGDW = '1' \
           AND TRUNC(B.SGDW_SJ) > TRUNC(B.SGDW) AND  B.SFYX='1' NDTJ) CQWCF, \
       (SELECT COUNT(*) CQWCJLDW  \
          FROM GC_JH_SJ B \
         WHERE B.JLDW_SJ IS NOT NULL \
           AND TRUNC(B.JLDW_SJ) > TRUNC(B.JLDW ) AND  B.SFYX='1' NDTJ) CQWCFG, \
       (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKSGDW \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.SGDW_SJ IS NULL \
           AND A.ISSGDW = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
           and a.SGDW is not null and trunc(SYSDATE) > a.SGDW \
           AND B.FKLX = '1010002' AND  A.SFYX='1' NDTJ ) WWYFKLXA, \
       (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKJLDW \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.JLDW_SJ IS NULL \
           AND A.ISJLDW  = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
           and a.JLDW is not null and trunc(SYSDATE) > a.JLDW \
           AND B.FKLX = '1011002' AND  A.SFYX='1' NDTJ) WWYFKTD, \
       (SELECT COUNT(*) WWWFKSGDW  \
          FROM GC_JH_SJ A \
         WHERE A.SGDW_SJ IS NULL \
           AND A.ISSGDW  = '1' AND  A.SFYX='1' NDTJ \
            and a.SGDW is not null and trunc(SYSDATE) > a.SGDW \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '1010002'))) WWWFKSGDW , \
       (SELECT COUNT(*) WWWFKJLDW  \
          FROM GC_JH_SJ A \
         WHERE A.JLDW_SJ IS NULL \
           AND A.ISJLDW  = '1' AND  A.SFYX='1' NDTJ \
            and a.JLDW is not null and trunc(SYSDATE) > a.JLDW \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '1011002'))) WWWFKJLDW \
   union all \
 SELECT '征拆情况' JD,ZS, \
       WC, \
       ZC   ZC, \
       YJZC  YJ, \
       CQWCZC  CQWC, \
       WWYFKZC WWYFK, \
       WWWFKZC    WWWFK \
  FROM (SELECT SUM(DECODE(A.ISZC, '1', 1, 0)) ZS, \
               SUM(DECODE(A.ZC_SJ, NULL, 0, 1)) WC \
          FROM GC_JH_SJ  A WHERE A.SFYX='1' NDTJ ) A, \
      (SELECT COUNT(*) ZC  \
          FROM GC_JH_SJ B \
         WHERE B.ZC_SJ IS NULL \
           AND B.ISZC  = '1' \
           AND (TRUNC(SYSDATE) < B.ZC or b.zc is null)  AND  B.SFYX='1' NDTJ) C, \
    (SELECT COUNT(*) YJZC  \
          FROM GC_JH_SJ B \
         WHERE B.ZC  IS NOT NULL \
           AND B.ZC_SJ IS NULL \
           AND B.ISZC  = '1' \
           AND TRUNC(SYSDATE + 5) > B.ZC  \
           AND TRUNC(SYSDATE) < B.ZC  AND  B.SFYX='1' NDTJ) YJG, \
    (SELECT COUNT(*) CQWCZC  \
          FROM GC_JH_SJ B \
         WHERE B.ZC_SJ IS NOT NULL \
           AND TRUNC(B.ZC_SJ) > TRUNC(B.ZC ) AND  B.SFYX='1' NDTJ) CQWCFG, \
      (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKZC \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.ZC_SJ IS NULL \
           AND A.ISZC  = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
            and a.ZC is not null and trunc(SYSDATE) > a.ZC \
           AND B.FKLX = '1009002' AND  A.SFYX='1' NDTJ) WWYFKTD, \
      (SELECT COUNT(*) WWWFKZC  \
          FROM GC_JH_SJ A \
         WHERE A.ZC_SJ IS NULL \
           AND A.ISZC  = '1' AND  A.SFYX='1' NDTJ \
           and a.ZC is not null and trunc(SYSDATE) > a.ZC \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '1009002'))) WWWFKZC \
   union all  \
      SELECT '排迁情况' JD,ZS, \
       WC, \
       PQ   PQ, \
       YJPQ  YJ, \
       CQWCPQ  CQWC, \
       WWYFKPQ WWYFK, \
       WWWFKPQ    WWWFK \
  FROM (SELECT SUM(DECODE(A.ISPQ, '1', 1, 0)) ZS, \
               SUM(DECODE(A.PQ_SJ, NULL, 0, 1)) WC \
          FROM GC_JH_SJ  A WHERE A.SFYX='1' NDTJ ) A, \
      (SELECT COUNT(*) PQ  \
          FROM GC_JH_SJ B \
         WHERE  B.PQ_SJ IS NULL \
           AND B.ISPQ  = '1' \
           AND (TRUNC(SYSDATE) < B.PQ  or b.pq is null) AND  B.SFYX='1' NDTJ) C, \
    (SELECT COUNT(*) YJPQ  \
          FROM GC_JH_SJ B \
         WHERE B.PQ_SJ IS NULL \
           AND B.ISPQ  = '1' \
           AND TRUNC(SYSDATE + 5) > B.PQ  \
           AND TRUNC(SYSDATE) < B.PQ  AND  B.SFYX='1' NDTJ) YJG, \
    (SELECT COUNT(*) CQWCPQ  \
          FROM GC_JH_SJ B \
         WHERE B.PQ_SJ IS NOT NULL \
           AND TRUNC(B.PQ_SJ) > TRUNC(B.PQ ) AND  B.SFYX='1' NDTJ) CQWCFG, \
      (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKPQ \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.PQ_SJ IS NULL \
           AND A.ISPQ  = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
            and a.PQ is not null and trunc(SYSDATE) > a.PQ \
           AND B.FKLX = '1001101' AND  A.SFYX='1' NDTJ) WWYFKTD, \
      (SELECT COUNT(*) WWWFKPQ  \
          FROM GC_JH_SJ A \
         WHERE A.PQ_SJ IS NULL \
           AND A.ISPQ  = '1' AND  A.SFYX='1' NDTJ \
           and a.PQ is not null and trunc(SYSDATE) > a.PQ \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '1001101'))) WWWFKPQ     \
   union all  \
     SELECT '开工情况' JD,ZS, \
       WC, \
       KGSJ   KGSJ, \
       YJKGSJ  YJ, \
       CQWCKGSJ  CQWC, \
       WWYFKKGSJ WWYFK, \
       WWWFKKGSJ    WWWFK \
  FROM (SELECT SUM(DECODE(A.ISKGSJ, '1', 1, 0)) ZS, \
               SUM(DECODE(A.KGSJ_SJ, NULL, 0, 1)) WC \
          FROM GC_JH_SJ  A WHERE A.SFYX='1' NDTJ ) A, \
      (SELECT COUNT(*) KGSJ  \
          FROM GC_JH_SJ B \
         WHERE B.KGSJ_SJ IS NULL \
           AND B.ISKGSJ  = '1' \
           AND (TRUNC(SYSDATE) < B.KGSJ  or B.KGSJ is null ) AND  B.SFYX='1' NDTJ) C, \
    (SELECT COUNT(*) YJKGSJ  \
          FROM GC_JH_SJ B \
         WHERE B.KGSJ  IS NOT NULL \
           AND B.KGSJ_SJ IS NULL \
           AND B.ISKGSJ  = '1' \
           AND TRUNC(SYSDATE + 5) > B.KGSJ  \
           AND TRUNC(SYSDATE) < B.KGSJ  AND  B.SFYX='1' NDTJ) YJG, \
    (SELECT COUNT(*) CQWCKGSJ  \
          FROM GC_JH_SJ B \
         WHERE B.KGSJ_SJ IS NOT NULL \
           AND TRUNC(B.KGSJ_SJ) > TRUNC(B.KGSJ ) AND  B.SFYX='1' NDTJ) CQWCFG, \
      (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKKGSJ \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.KGSJ_SJ IS NULL \
           AND A.ISKGSJ  = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
          and a.KGSJ is not null and trunc(SYSDATE) > a.KGSJ \
           AND B.FKLX = '1008012' AND  A.SFYX='1' NDTJ) WWYFKTD, \
      (SELECT COUNT(*) WWWFKKGSJ  \
          FROM GC_JH_SJ A \
         WHERE A.KGSJ_SJ IS NULL \
           AND A.ISKGSJ  = '1' AND  A.SFYX='1' NDTJ \
           and a.KGSJ is not null and trunc(SYSDATE) > a.KGSJ \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '1008012'))) WWWFKKGSJ \
   union all \
     SELECT '完工情况' JD,ZS, \
       WC, \
       WGSJ   WGSJ, \
       YJWGSJ  YJ, \
       CQWCWGSJ  CQWC, \
       WWYFKWGSJ WWYFK, \
       WWWFKWGSJ    WWWFK \
  FROM (SELECT SUM(DECODE(A.ISWGSJ, '1', 1, 0)) ZS, \
               SUM(DECODE(A.WGSJ_SJ, NULL, 0, 1)) WC \
          FROM GC_JH_SJ  A WHERE A.SFYX='1' NDTJ ) A, \
      (SELECT COUNT(*) WGSJ  \
          FROM GC_JH_SJ B \
         WHERE B.WGSJ_SJ IS NULL \
           AND B.ISWGSJ  = '1' \
           AND (TRUNC(SYSDATE) < B.WGSJ or B.WGSJ is  null)  AND  B.SFYX='1' NDTJ) C, \
    (SELECT COUNT(*) YJWGSJ  \
          FROM GC_JH_SJ B \
         WHERE B.WGSJ  IS NOT NULL \
           AND B.WGSJ_SJ IS NULL \
           AND B.ISWGSJ  = '1' \
           AND TRUNC(SYSDATE + 5) > B.WGSJ  \
           AND TRUNC(SYSDATE) < B.WGSJ  AND  B.SFYX='1' NDTJ) YJG, \
    (SELECT COUNT(*) CQWCWGSJ  \
          FROM GC_JH_SJ B \
         WHERE B.WGSJ_SJ IS NOT NULL \
           AND TRUNC(B.WGSJ_SJ) > TRUNC(B.WGSJ ) AND  B.SFYX='1' NDTJ) CQWCFG, \
      (SELECT COUNT(DISTINCT(A.GC_JH_SJ_ID)) WWYFKWGSJ \
          FROM GC_JH_SJ A, GC_JH_FKQK B \
         WHERE A.WGSJ_SJ IS NULL \
           AND A.ISWGSJ  = '1' \
           AND A.GC_JH_SJ_ID = B.JHSJID \
           and a.WGSJ is not null and trunc(SYSDATE) > a.WGSJ \
           AND B.FKLX = '1008014' AND  A.SFYX='1' NDTJ) WWYFKTD, \
      (SELECT COUNT(*) WWWFKWGSJ  \
          FROM GC_JH_SJ A \
         WHERE A.WGSJ_SJ IS NULL \
           AND A.ISWGSJ  = '1' AND  A.SFYX='1' NDTJ \
            and a.WGSJ is not null and trunc(SYSDATE) > a.WGSJ \
           AND A.GC_JH_SJ_ID NOT IN \
               ((SELECT DISTINCT (A.GC_JH_SJ_ID) WWYFKLX \
                  FROM GC_JH_SJ A, GC_JH_FKQK B \
                 WHERE A.GC_JH_SJ_ID = B.JHSJID \
                   AND B.FKLX = '1008014'))) WWWFKWGSJ) \
  select JD,zs,wc,  zc, yj, cqwc,  wwyfk,  wwwfk \
   from lsb \
  union all  \
  select '<b>合计</b>' JD,sum(zs),sum(wc),  sum(zc), sum(yj), sum(cqwc),  sum(wwyfk),  sum(wwwfk)  from lsb
                   
                             
                   
                   
                  
                   

















TCJHGK=SELECT * \
  FROM (SELECT DISTINCT T.JHPCH,\
                        (decode(MQBB, 0, '-', MQBB)) as MQBB,\
                        TO_CHAR(T.XDRQ, 'yyyy-MM-dd') as XDRQ,\
                        (SELECT COUNT(GC_JH_SJ_ID)\
                           FROM GC_JH_SJ\
                          WHERE JHID = T.GC_JH_ZT_ID\
                           NDTJ \
                            AND XMBS = '0'\
                            AND SFYX = '1') AS ZS,\
                        (SELECT COUNT(GC_JH_SJ_ID)\
                           FROM GC_JH_SJ\
                          WHERE JHID = T.GC_JH_ZT_ID\
                            AND XMSX = '2'\
                            NDTJ\
                            AND XMBS = '0'\
                            AND SFYX = '1') AS YJ,\
                        (SELECT COUNT(GC_TCJH_XMXDK_ID) as bt\
                           FROM GC_TCJH_XMXDK \
                          WHERE ISBT = '1' \
                            AND GC_TCJH_XMXDK_ID in \
                                (select DISTINCT XMID \
                                   from gc_jh_sj \
                                  where  1=1 NDTJ \
                                    AND JHID = T.GC_JH_ZT_ID)), \
                        (SELECT COUNT(DISTINCT XMID) \
                           FROM GC_JH_BGXM \
                          WHERE T.GC_JH_ZT_ID = JHID \
                            AND SFXG = '1' \
                            NDTJ \
                            AND SFYX = '1') AS TZ, \
                        (SELECT COUNT(GC_JH_SJ_ID) \
                           FROM GC_JH_SJ \
                          WHERE XMGLGS = '100000000012' \
                            NDTJ \
                            AND SFYX = '1' \
                            AND XMBS = '0' \
                            AND JHID = T.GC_JH_ZT_ID), \
                        (SELECT COUNT(GC_JH_SJ_ID) \
                           FROM GC_JH_SJ \
                          WHERE XMGLGS = '100000000011' \
                            NDTJ \
                            AND SFYX = '1' \
                            AND XMBS = '0' \
                            AND JHID = T.GC_JH_ZT_ID), \
                        (SELECT COUNT(GC_JH_SJ_ID) \
                           FROM GC_JH_SJ \
                          WHERE XMGLGS = '100000000010' \
                            NDTJ \
                            AND SFYX = '1' \
                            AND XMBS = '0' \
                            AND JHID = T.GC_JH_ZT_ID), \
                        (SELECT COUNT(GC_JH_SJ_ID) \
                           FROM GC_JH_SJ \
                          WHERE XMGLGS = '100000000013' \
                            NDTJ \
                            AND SFYX = '1' \
                            AND XMBS = '0' \
                            AND JHID = T.GC_JH_ZT_ID), \
                        (SELECT COUNT(GC_JH_SJ_ID) \
                           FROM GC_JH_SJ \
                          WHERE XMGLGS = '100000000021' \
                            NDTJ \
                            AND SFYX = '1' \
                            AND XMBS = '0' \
                            AND JHID = T.GC_JH_ZT_ID), \
                        (SELECT COUNT(GC_JH_SJ_ID) \
                           FROM GC_JH_SJ \
                          WHERE XMGLGS = '200000000001' \
                            NDTJ \
                            AND SFYX = '1' \
                            AND XMBS = '0' \
                            AND JHID = T.GC_JH_ZT_ID), \
                        (SELECT COUNT(GC_TCJH_XMXDK_ID) \
                           FROM GC_TCJH_XMXDK \
                          WHERE XMGLGS IS NULL \
                            AND GC_TCJH_XMXDK_ID IN \
                                (SELECT XMID \
                                   FROM GC_JH_SJ \
                                  WHERE JHID = T.GC_JH_ZT_ID \
                                    NDTJ \
                                    AND SFYX = '1')) AS QT, \
                        (SELECT trunc(SUM(JHZTZE) / 10000, 5) \
                           FROM GC_TCJH_XMXDK \ 
                          WHERE GC_TCJH_XMXDK_ID IN \
                                (SELECT XMID \
                                   FROM GC_JH_SJ \
                                  WHERE JHID = T.GC_JH_ZT_ID \
                                    NDTJ \
                                    AND SFYX = '1')) AS ZTZ \
          FROM GC_JH_ZT T, GC_JH_SJ T1 \
         WHERE T1.JHID = T.GC_JH_ZT_ID \
           NDTJ \
           AND t.JHPCH NOT LIKE '零星%' \
         ORDER BY t.JHPCH ASC) \
UNION ALL \
SELECT * \
  FROM (SELECT DISTINCT T.JHPCH, \
                        (decode(MQBB, 0, '-', MQBB)) as MQBB, \
                        TO_CHAR(T.XDRQ, 'yyyy-MM-dd') as XDRQ, \
                        (SELECT COUNT(GC_JH_SJ_ID) \
                           FROM GC_JH_SJ \
                          WHERE JHID = T.GC_JH_ZT_ID \
                            NDTJ \
                            AND XMBS = '0' \
                            AND SFYX = '1') AS ZS, \
                        (SELECT COUNT(GC_JH_SJ_ID) \
                           FROM GC_JH_SJ \
                          WHERE JHID = T.GC_JH_ZT_ID \
                            AND XMSX = '2' \
                            NDTJ \
                            AND XMBS = '0' \
                            AND SFYX = '1') AS YJ, \
                        (SELECT COUNT(GC_TCJH_XMXDK_ID) \
                           FROM GC_TCJH_XMXDK \
                          WHERE ISBT = '1' \
                            AND T1.JHID = T.GC_JH_ZT_ID \
                            AND GC_TCJH_XMXDK_ID = T1.XMID \
                            NDTJ1 \
                            AND t1.SFYX = '1') AS BT, \
                        (SELECT COUNT(DISTINCT XMID) \
                           FROM GC_JH_BGXM \
                          WHERE T.GC_JH_ZT_ID = JHID \
                            AND SFXG = '1' \
                            NDTJ \
                            AND SFYX = '1') AS TZ, \
                        (SELECT COUNT(GC_TCJH_XMXDK_ID) \
                           FROM GC_TCJH_XMXDK \
                          WHERE XMGLGS = '100000000012' \
                            AND GC_TCJH_XMXDK_ID IN \
                                (SELECT XMID \
                                   FROM GC_JH_SJ \
                                  WHERE JHID = T.GC_JH_ZT_ID \
                                    NDTJ \
                                    AND SFYX = '1')), \
                        (SELECT COUNT(GC_TCJH_XMXDK_ID) \
                           FROM GC_TCJH_XMXDK \
                          WHERE XMGLGS = '100000000011' \
                            AND GC_TCJH_XMXDK_ID IN \
                                (SELECT XMID \
                                   FROM GC_JH_SJ \
                                  WHERE JHID = T.GC_JH_ZT_ID \
                                    NDTJ \
                                    AND SFYX = '1')), \
                        (SELECT COUNT(GC_TCJH_XMXDK_ID) \
                           FROM GC_TCJH_XMXDK \
                          WHERE XMGLGS = '100000000010' \
                            AND GC_TCJH_XMXDK_ID IN \
                                (SELECT XMID \
                                   FROM GC_JH_SJ \
                                  WHERE JHID = T.GC_JH_ZT_ID \
                                    NDTJ \
                                    AND SFYX = '1')), \
                        (SELECT COUNT(GC_TCJH_XMXDK_ID) \
                           FROM GC_TCJH_XMXDK \
                          WHERE XMGLGS = '100000000013' \
                            AND GC_TCJH_XMXDK_ID IN \
                                (SELECT XMID \
                                   FROM GC_JH_SJ \
                                  WHERE JHID = T.GC_JH_ZT_ID \
                                    NDTJ \
                                    AND SFYX = '1')), \
                        (SELECT COUNT(GC_TCJH_XMXDK_ID) \
                           FROM GC_TCJH_XMXDK \
                          WHERE XMGLGS = '100000000021' \
                            AND GC_TCJH_XMXDK_ID IN \
                                (SELECT XMID \
                                   FROM GC_JH_SJ \
                                  WHERE JHID = T.GC_JH_ZT_ID \
                                    NDTJ \
                                    AND SFYX = '1')), \
                        (SELECT COUNT(GC_TCJH_XMXDK_ID) \
                           FROM GC_TCJH_XMXDK \
                          WHERE XMGLGS = '200000000001' \
                            AND GC_TCJH_XMXDK_ID IN \
                                (SELECT XMID \
                                   FROM GC_JH_SJ \
                                  WHERE JHID = T.GC_JH_ZT_ID \
                                    NDTJ \
                                    AND SFYX = '1')), \
                        (SELECT COUNT(GC_TCJH_XMXDK_ID) \
                           FROM GC_TCJH_XMXDK \
                          WHERE XMGLGS IS NULL \
                            AND GC_TCJH_XMXDK_ID IN \
                                (SELECT XMID \
                                   FROM GC_JH_SJ \
                                  WHERE JHID = T.GC_JH_ZT_ID \
                                    NDTJ \
                                    AND SFYX = '1')) AS QT, \
                        (SELECT trunc(SUM(JHZTZE) / 10000, 5) \
                           FROM GC_TCJH_XMXDK \
                          WHERE GC_TCJH_XMXDK_ID IN \
                                (SELECT XMID \
                                   FROM GC_JH_SJ \
                                  WHERE JHID = T.GC_JH_ZT_ID \
                                    NDTJ \
                                    AND SFYX = '1')) AS ZTZ \
          FROM GC_JH_ZT T, GC_JH_SJ T1 \
         WHERE T1.JHID = T.GC_JH_ZT_ID \
           NDTJ \
           AND t.JHPCH LIKE '零星%' \
         ORDER BY t.JHPCH ASC) \
 WHERE ROWNUM = 1
