#问题概括查询SQL
WTGKSQL = select nvl(LJWTS,0) LJWTS, \
		nvl(LJJQYZWT,0) LJJQYZWT, \
		nvl(LJYZWT,0) LJYZWT, \
		nvl(LJYBWT,0) LJYBWT, \
		nvl(BNDWTS,0) BNDWTS, \
		nvl(NDJQYZWT,0) NDJQYZWT, \
	    nvl(NDYZWT,0) NDYZWT, \
	    nvl(NDYBWT,0) NDYBWT, \
	    nvl(ND,0) ND,  \
	    nvl(YJJ,0) YJJ, \
	    nvl(SWJJ,0) SWJJ, \
	    nvl(WFJJ,0) WFJJ, \
	    nvl(CLZ,0) CLZ, \
		nvl(LJYJJWT,0) LJYJJWT, \
		nvl(LJWJJWT,0) LJWJJWT, \
		nvl(LJZZJJWT,0) LJZZJJWT, \
		nvl(WTZDXM,'无') WTZDXM, \
		nvl(WTZDLX,'无') WTZDLX, \
		nvl(TJGXMGLGS,0) TJGXMGLGS,\
		nvl(TJGXMGLGSYJJ,0) TJGXMGLGSYJJ,\
		nvl(TJGZXGBM,0) TJGZXGBM,\
		nvl(TJGZXGBMYJJ,0) TJGZXGBMYJJ,\
		nvl(TJGZXLD,0) TJGZXLD,\
		nvl(TJGZXLDYJJ,0) TJGZXLDYJJ,\
		nvl(CQWJJWT,0) CQWJJWT, \
		nvl(CQWFKWT,0) CQWFKWT, \
	    case LJWTS when 0 then '0' else nvl(to_char(round((LJJQYZWT/LJWTS)*100,2),'fm999999999990.00'),0) end LJJQYZWTBFB, \
	    case LJWTS when 0 then '0' else nvl(to_char(round((LJYZWT/LJWTS)*100,2),'fm999999999990.00'),0) end LJYZWTBFB, \
	    case LJWTS when 0 then '0' else nvl(to_char(round((LJYBWT/LJWTS)*100,2),'fm999999999990.00'),0) end LJYBWTBFB, \
	    case BNDWTS when 0 then '0' else nvl(to_char(round((NDJQYZWT/BNDWTS)*100,2),'fm999999999990.00'),0) end NDJQYZWTBFB, \
	    case BNDWTS when 0 then '0' else nvl(to_char(round((NDYZWT/BNDWTS)*100,2),'fm999999999990.00'),0) end NDYZWTBFB, \
	    case BNDWTS when 0 then '0' else nvl(to_char(round((NDYBWT/BNDWTS)*100,2),'fm999999999990.00'),0) end NDYBWTBFB,  \
	    case BNDWTS when 0 then '0' else nvl(to_char(round((YJJ/BNDWTS)*100,2),'fm999999999990.00'),0) end YJJBFB,  \
	    case BNDWTS when 0 then '0' else nvl(to_char(round((SWJJ/BNDWTS)*100,2),'fm999999999990.00'),0) end SWJJBFB  \
	    from( \
	    select (select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and T1.SJZT in ('2','3','4','6')) as LJWTS, \
	    (select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and WTXZ='13' and T1.SJZT in ('2','3','4','6')) as LJJQYZWT, \
	    (select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and WTXZ='12' and T1.SJZT in ('2','3','4','6')) as LJYZWT, \
	    (select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and WTXZ='11' and T1.SJZT in ('2','3','4','6')) as LJYBWT,\
		(select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and SJZT='6' and T1.SJZT in ('2','3','4','6')) LJYJJWT,\
		(select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','3','4','5')) LJWJJWT,\
		(select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','4')) LJZZJJWT,\
		(select B.XMMC from(select WTCOUNT,XMID from(select count(WTTB_INFO_ID) WTCOUNT,XMID from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','3','4','5','6') and XMID is not null group by XMID order by WTCOUNT desc) where ROWNUM<2) A,GC_TCJH_XMXDK B where A.XMID=B.GC_TCJH_XMXDK_ID group by B.XMMC) WTZDXM,\
		(select A.WTLX from(select WTCOUNT,WTLX from(select count(WTTB_INFO_ID) WTCOUNT,WTLX from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','3','4','5','6') and WTLX is not null group by WTLX order by WTCOUNT desc) where ROWNUM<2) A group by A.WTLX) WTZDLX,\
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
			where A.WTTB_INFO_ID=B.WTID \
			and A.SFYX='1' \
			and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1='1') and A.SJZT in ('2','3','4','6')) TJGXMGLGS, \
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
			where A.WTTB_INFO_ID=B.WTID \
			and A.SFYX='1' \
			and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1='1') and A.SJZT in ('6')) TJGXMGLGSYJJ, \
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1!='1' and ROW_ID!='100000000000' and ROW_ID!='200000000000') \
		and A.SJZT in ('2','3','4','6')) TJGZXGBM, \
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1!='1' and ROW_ID!='100000000000' and ROW_ID!='200000000000') \
		and A.SJZT in ('6')) TJGZXGBMYJJ, \
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSR in (select ACCOUNT from VIEW_ZR where ACCOUNT!='hanag') and A.SJZT in ('2','3','4','6')) TJGZXLD, \
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSR in (select ACCOUNT from VIEW_ZR where ACCOUNT!='hanag') and A.SJZT in ('6')) TJGZXLDYJJ, \
		(select count(WTTB_INFO_ID) from WTTB_INFO where YJSJ<sysdate and SJZT in ('2','4') and SFYX='1') CQWJJWT,  \
		(select count(WTTB_INFO_ID) from WTTB_INFO where YJSJ<sysdate and SJZT in ('2') and SFYX='1') CQWFKWT,  \
		nvl(BNDWTS,0) BNDWTS, \
		nvl(NDJQYZWT,0) NDJQYZWT, \
	    nvl(NDYZWT,0) NDYZWT, \
	    nvl(NDYBWT,0) NDYBWT, \
	    nvl(B.ND,0) ND,  \
	    nvl(YJJ,0) YJJ, \
	    nvl(SWJJ,0) SWJJ, \
	    nvl(WFJJ,0) WFJJ, \
	    nvl(CLZ,0) CLZ \
	    from ( select \
	    count(WTTB_INFO_ID) BNDWTS,  \
	    sum(decode(WTXZ,'13',1,0)) NDJQYZWT, \
	    sum(decode(WTXZ,'12',1,0)) NDYZWT, \
	    sum(decode(WTXZ,'11',1,0)) NDYBWT, \
	    sum(decode(SJZT,'6',1,0)) YJJ, \
	    sum(decode(SJZT,'6',0,1)) SWJJ, \
	    sum(decode(SJZT,'3',1,0)) WFJJ,\
	    sum(case when SJZT='2' or SJZT='4' then 1 else 0 end) CLZ,\
	    to_char(LRSJ,'yyyy') ND  \
	    from wttb_info where SFYX='1' and SJZT in ('2','3','4','6') group by to_char(LRSJ,'yyyy')) A \
	    right JOIN \
	    (select ND from GC_JH_SJ where SFYX='1' group by ND  union all select distinct to_char(I.LRSJ,'yyyy') ND from WTTB_INFO I ,GC_JH_SJ J where  to_char(I.LRSJ,'yyyy')!=J.ND and I.SFYX='1') B  \
	    on A.ND(+)=B.ND\
	    )
		
#问题概括查询SQL
WTGKSQL_NEW = select nvl(LJWTS,0) LJWTS, \
		nvl(LJJQYZWT,0) LJJQYZWT, \
		nvl(LJYZWT,0) LJYZWT, \
		nvl(LJYBWT,0) LJYBWT, \
		nvl(BNDWTS,0) BNDWTS, \
		nvl(NDJQYZWT,0) NDJQYZWT, \
	    nvl(NDYZWT,0) NDYZWT, \
	    nvl(NDYBWT,0) NDYBWT, \
	    nvl(ND,0) ND,  \
	    nvl(YJJ,0) YJJ, \
	    nvl(SWJJ,0) SWJJ, \
	    nvl(WFJJ,0) WFJJ, \
	    nvl(CLZ,0) CLZ, \
		nvl(LJYJJWT,0) LJYJJWT, \
		nvl(LJWJJWT,0) LJWJJWT, \
		nvl(LJZZJJWT,0) LJZZJJWT, \
		nvl(WTZDXM,'无') WTZDXM, \
		nvl(TJGXMGLGS,0) TJGXMGLGS,\
		nvl(TJGXMGLGSWJJ,0) TJGXMGLGSWJJ,\
		nvl(TJGZXGBM,0) TJGZXGBM,\
		nvl(TJGZXGBMWJJ,0) TJGZXGBMWJJ,\
		nvl(TJGZXLD,0) TJGZXLD,\
		nvl(TJGZXLDWJJ,0) TJGZXLDWJJ,\
		nvl(CQWJJWT,0) CQWJJWT, \
		nvl(CQWFKWT,0) CQWFKWT, \
	    nvl(WTZDLX1,'') WTZDLX1, \
	    nvl(WTZDLX2,'') WTZDLX2, \
	    nvl(WTZDLX3,'') WTZDLX3, \
	    nvl(SJXMWT,0) SJXMWT, \
	    nvl(SJXMWTWJJ,0) SJXMWTWJJ, \
	    case LJWTS when 0 then '0' else nvl(to_char(round((LJJQYZWT/LJWTS)*100,2),'fm999999999990.00'),0) end LJJQYZWTBFB, \
	    case LJWTS when 0 then '0' else nvl(to_char(round((LJYZWT/LJWTS)*100,2),'fm999999999990.00'),0) end LJYZWTBFB, \
	    case LJWTS when 0 then '0' else nvl(to_char(round((LJYBWT/LJWTS)*100,2),'fm999999999990.00'),0) end LJYBWTBFB, \
	    case BNDWTS when 0 then '0' else nvl(to_char(round((NDJQYZWT/BNDWTS)*100,2),'fm999999999990.00'),0) end NDJQYZWTBFB, \
	    case BNDWTS when 0 then '0' else nvl(to_char(round((NDYZWT/BNDWTS)*100,2),'fm999999999990.00'),0) end NDYZWTBFB, \
	    case BNDWTS when 0 then '0' else nvl(to_char(round((NDYBWT/BNDWTS)*100,2),'fm999999999990.00'),0) end NDYBWTBFB,  \
	    case BNDWTS when 0 then '0' else nvl(to_char(round((YJJ/BNDWTS)*100,2),'fm999999999990.00'),0) end YJJBFB,  \
	    case BNDWTS when 0 then '0' else nvl(to_char(round((SWJJ/BNDWTS)*100,2),'fm999999999990.00'),0) end SWJJBFB  \
	    from( \
	    select (select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and T1.SJZT in ('2','3','4','6')) as LJWTS, \
	    (select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and WTXZ='13' and T1.SJZT in ('2','3','4','6')) as LJJQYZWT, \
	    (select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and WTXZ='12' and T1.SJZT in ('2','3','4','6')) as LJYZWT, \
	    (select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and WTXZ='11' and T1.SJZT in ('2','3','4','6')) as LJYBWT,\
		(select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and SJZT='6' and T1.SJZT in ('2','3','4','6')) LJYJJWT,\
		(select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','3','4','5')) LJWJJWT,\
		(select count(WTTB_INFO_ID) from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','4')) LJZZJJWT,\
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
			where A.WTTB_INFO_ID=B.WTID \
			and A.SFYX='1' \
			and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1='1') and A.SJZT in ('2','3','4','6')) TJGXMGLGS, \
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
			where A.WTTB_INFO_ID=B.WTID \
			and A.SFYX='1' \
			and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1='1') and A.SJZT in ('2','3','4')) TJGXMGLGSWJJ, \
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1!='1' and ROW_ID!='100000000000' and ROW_ID!='200000000000') \
		and A.SJZT in ('2','3','4','6')) TJGZXGBM, \
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1!='1' and ROW_ID!='100000000000' and ROW_ID!='200000000000') \
		and A.SJZT in ('2','3','4')) TJGZXGBMWJJ, \
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSR in (select ACCOUNT from VIEW_ZR where ACCOUNT!='hanag') and A.SJZT in ('2','3','4','6')) TJGZXLD, \
		(select count(WTTB_INFO_ID) from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSR in (select ACCOUNT from VIEW_ZR where ACCOUNT!='hanag') and A.SJZT in ('2','3','4')) TJGZXLDWJJ, \
		(select count(WTTB_INFO_ID) from WTTB_INFO where YJSJ<sysdate and SJZT in ('2','4') and SFYX='1') CQWJJWT,  \
		(select count(WTTB_INFO_ID) from WTTB_INFO where YJSJ<sysdate and SJZT in ('2') and SFYX='1') CQWFKWT,  \
		nvl(BNDWTS,0) BNDWTS, \
		nvl(NDJQYZWT,0) NDJQYZWT, \
	    nvl(NDYZWT,0) NDYZWT, \
	    nvl(NDYBWT,0) NDYBWT, \
	    nvl(B.ND,0) ND,  \
	    nvl(YJJ,0) YJJ, \
	    nvl(SWJJ,0) SWJJ, \
	    nvl(WFJJ,0) WFJJ, \
	    nvl(CLZ,0) CLZ, \
	    WTZDXM, \
	    nvl(WTZDLX1,'') WTZDLX1, \
	    nvl(WTZDLX2,'') WTZDLX2, \
	    nvl(WTZDLX3,'') WTZDLX3, \
	    nvl(SJXMWT,0) SJXMWT, \
	    nvl(SJXMWTWJJ,0) SJXMWTWJJ \
	    from ( select \
	    count(WTTB_INFO_ID) BNDWTS,  \
	    sum(decode(WTXZ,'13',1,0)) NDJQYZWT, \
	    sum(decode(WTXZ,'12',1,0)) NDYZWT, \
	    sum(decode(WTXZ,'11',1,0)) NDYBWT, \
	    sum(decode(SJZT,'6',1,0)) YJJ, \
	    sum(decode(SJZT,'6',0,1)) SWJJ, \
	    sum(decode(SJZT,'3',1,0)) WFJJ,\
	    sum(case when SJZT='2' or SJZT='4' then 1 else 0 end) CLZ,\
	    sum(decode(JHSJID,null,0,1)) SJXMWT,\
	    sum(decode(JHSJID,null,0,decode(SJZT,'6',0,1))) SJXMWTWJJ,\
	    to_char(LRSJ,'yyyy') ND  \
	    from wttb_info where SFYX='1' and SJZT in ('2','3','4','6') group by to_char(LRSJ,'yyyy')) A \
	    , \
	    (select ND from GC_JH_SJ where SFYX='1' group by ND  union all select distinct to_char(I.LRSJ,'yyyy') ND from WTTB_INFO I ,GC_JH_SJ J where  to_char(I.LRSJ,'yyyy')!=J.ND and I.SFYX='1') B  \
	    , \
	    (select B.XMMC WTZDXM,A.ND from(select WTCOUNT,XMID,ND from (select count(WTTB_INFO_ID) WTCOUNT,XMID, to_char(LRSJ,'yyyy') ND from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','3','4','5','6') and XMID is not null group by XMID, to_char(LRSJ,'yyyy') order by  to_char(LRSJ,'yyyy'),WTCOUNT desc) where ROWNUM<2) A,GC_TCJH_XMXDK B where A.XMID=B.GC_TCJH_XMXDK_ID group by B.XMMC,A.ND) C \
		, \
		(select A.WTLX WTZDLX1,A.ND from(select WTCOUNT,WTLX,ND from(select count(WTTB_INFO_ID) WTCOUNT,WTLX, to_char(LRSJ,'yyyy') ND from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','3','4','5','6') and WTLX is not null group by WTLX, to_char(LRSJ,'yyyy') order by WTCOUNT desc) where ROWNUM<2) A group by A.WTLX,A.ND) D,\
		(select A.WTLX WTZDLX2,A.ND from(select WTCOUNT,WTLX,ND from(select count(WTTB_INFO_ID) WTCOUNT,WTLX, to_char(LRSJ,'yyyy') ND from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','3','4','5','6') and WTLX is not null group by WTLX, to_char(LRSJ,'yyyy') order by WTCOUNT desc) where ROWNUM=2) A group by A.WTLX,A.ND) E,\
		(select A.WTLX WTZDLX3,A.ND from(select WTCOUNT,WTLX,ND from(select count(WTTB_INFO_ID) WTCOUNT,WTLX, to_char(LRSJ,'yyyy') ND from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','3','4','5','6') and WTLX is not null group by WTLX, to_char(LRSJ,'yyyy') order by WTCOUNT desc) where ROWNUM=3) A group by A.WTLX,A.ND) F \
	    where A.ND(+)=B.ND and B.ND=C.ND(+) and B.ND=D.ND(+) and B.ND=E.ND(+) and B.ND=F.ND(+) %ndCondition% \
	    )
		
#问题性质分布
WTXZFBSQL=select DIC_VALUE LABEL,(select count(1) from WTTB_INFO where WTXZ = t.dic_code %ndCondition% and SFYX='1' and SJZT in ('2','3','4','6')) VALUE,'QZHJ_'||DIC_CODE FIELDNAME \
		from FS_DIC_TREE T \
		where T.PARENT_ID = '1000000000070' order by DIC_CODE 


#问题日期分布
WTRQFBSQL=select '1-3天' LABEL,nvl(sum(case when TS between 0 and 2 then 1 else 0 end),0) VALUE from (select nvl(floor(decode(SJSJ,null,sysdate,SJSJ)-LRSJ),0) TS from WTTB_INFO where SFYX='1' %ndCondition% and SJZT in ('2','3','4','6')) \
		union all \
		select '3-5天' LABEL,nvl(sum(case when TS between 3 and 4 then 1 else 0 end),0) VALUE from (select nvl(floor(decode(SJSJ,null,sysdate,SJSJ)-LRSJ),0) TS from WTTB_INFO where SFYX='1' %ndCondition% and SJZT in ('2','3','4','6')) \
		union all \
		select '5-10天' LABEL,nvl(sum(case when TS between 5 and 9 then 1 else 0 end),0) VALUE from (select nvl(floor(decode(SJSJ,null,sysdate,SJSJ)-LRSJ),0) TS from WTTB_INFO where SFYX='1' %ndCondition% and SJZT in ('2','3','4','6')) \
		union all \
		select '10天以上' LABEL,nvl(sum(case when TS>9 then 1 else 0 end),0) VALUE from (select nvl(floor(decode(SJSJ,null,sysdate,SJSJ)-LRSJ),0) TS from WTTB_INFO where SFYX='1' %ndCondition% and SJZT in ('2','3','4','6')) 

#问题类别分布
WTLBFBSQL=select T.DIC_VALUE2 LABEL,count(I.WTTB_INFO_ID) VALUE,to_char(I.LRSJ, 'yyyy') as ND,'WTLX_'||DIC_CODE FIELDNAME \
		from WTTB_INFO I, FS_DIC_TREE T \
		where I.WTLX(+) = T.DIC_CODE  and I.SFYX='1'  and SJZT in ('2','3','4','6') \
		and T.PARENT_ID = '1000000000330' %ndCondition% \
		group by to_char(I.LRSJ, 'yyyy'), DIC_VALUE2,DIC_CODE

#问题超期情况
WTCQQKSQL=select T.DIC_VALUE LABEL,count(I.WTTB_INFO_ID) VALUE,to_char(I.LRSJ,'yyyy') as ND,'BLSX_'||DIC_CODE FIELDNAME \
		from WTTB_INFO I,FS_DIC_TREE T \
		where I.CQBZ(+)=T.DIC_CODE and I.SFYX='1' and SJZT in ('2','3','4','6') \
		and T.DIC_NAME_CODE='CQBZ' %ndCondition% \
		group by to_char(I.LRSJ, 'yyyy'), DIC_VALUE,DIC_CODE
		
#问题解决程度
WTJJCDSQL=select VALUE,LABEL,ORDERNUM,ND,FIELDNAME from( \
		select count(WTTB_INFO_ID) VALUE,'已解决' LABEL,1 ORDERNUM,to_char(I.LRSJ,'yyyy') as ND,'JJQK_YJJ' FIELDNAME from WTTB_INFO I where SJZT='6' and SFYX='1' group by to_char(I.LRSJ,'yyyy') \
		union all \
		select count(WTTB_INFO_ID) VALUE,'未解决' LABEL,2 ORDERNUM,to_char(I.LRSJ,'yyyy') as ND,'JJQK_WFJJ' FIELDNAME from WTTB_INFO I where SJZT='3' and SFYX='1' group by to_char(I.LRSJ,'yyyy') \
		union all \
		select count(WTTB_INFO_ID) VALUE,'处理中' LABEL,3 ORDERNUM,to_char(I.LRSJ,'yyyy') as ND,'JJQK_CLZ' FIELDNAME from WTTB_INFO I where SJZT in ('2','4') and SFYX='1' group by to_char(I.LRSJ,'yyyy') \
		) where 1=1 %ndCondition% order by ORDERNUM

#问题类别分布详细
WTLBFBXXSQL=select * from ( \
		select nvl(zs,0) VALUE,DIC_CODE,DIC_VALUE LABEL,(select DIC_VALUE from FS_DIC_TREE where DIC_NAME_CODE='WTXZ' and DIC_CODE='11') as SERIESNAME, 1 as XH \
		from \
		(select  count(WTLX) zs,WTLX  from WTTB_INFO I where WTXZ='11' and SFYX='1' and SJZT in ('2','3','4','6') %ndCondition% group by I.WTLX) a,\
		(select c.dic_code, c.dic_value from fs_dic_tree c where c.parent_id = '1000000000330') b \
		where a.WTLX(+)=b.DIC_CODE \
		union all \
		select nvl(zs,0) VALUE,DIC_CODE,DIC_VALUE LABEL,(select DIC_VALUE from FS_DIC_TREE where DIC_NAME_CODE='WTXZ' and DIC_CODE='12') as SERIESNAME, 2 as XH \
		from \
		(select  count(WTLX) zs,WTLX  from WTTB_INFO I where WTXZ='12' and SFYX='1' and SJZT in ('2','3','4','6')  %ndCondition% group by I.WTLX) a,\
		(select c.dic_code, c.dic_value from fs_dic_tree c where c.parent_id = '1000000000330') b \
		where a.WTLX(+)=b.DIC_CODE \
		union all \
		select nvl(zs,0) VALUE,DIC_CODE,DIC_VALUE LABEL,(select DIC_VALUE from FS_DIC_TREE where DIC_NAME_CODE='WTXZ' and DIC_CODE='13') as SERIESNAME, 3 as XH \
		from \
		(select  count(WTLX) zs,WTLX  from WTTB_INFO I where WTXZ='13' and SFYX='1' and SJZT in ('2','3','4','6')  %ndCondition% group by I.WTLX) a, \
		(select c.dic_code, c.dic_value from fs_dic_tree c where c.parent_id = '1000000000330') b \
		where a.WTLX(+)=b.DIC_CODE \
		) order by DIC_CODE,XH \
		
		
#主办部门SQL
ZBBMSQL = select * from ( \
		select nvl(zs,0) VALUE,BMJC LABEL,'解决' as SERIESNAME, 1 as XH ,b.SORT,'WTZZ_'||b.ROW_ID||'@'||'JJQK_YJJ' FIELDNAME \
		from \
		(select  count(distinct WTTB_INFO_ID) zs,L.JSBM  from WTTB_INFO I,WTTB_LZLS L where I.WTTB_INFO_ID=L.WTID(+) and L.BLRJS='1' and I.SJZT='6' and I.SFYX='1' %ndCondition% group by L.JSBM) a, \
		(select D.ROW_ID,D.BMJC,SORT from FS_ORG_DEPT D where D.ROW_ID not in ('100000000000','200000000000','100000000008') and EXTEND1!='1') b \
		where a.JSBM(+)=b.ROW_ID \
		union all \
		select nvl(zs,0) VALUE,BMJC LABEL,'未解决' as SERIESNAME, 2 as XH,b.SORT,'WTZZ_'||b.ROW_ID||'@'||'JJQK_WJJ' FIELDNAME \
		from \
		(select  count(distinct WTTB_INFO_ID) zs,L.JSBM  from WTTB_INFO I,WTTB_LZLS L where I.WTTB_INFO_ID=L.WTID(+) and L.BLRJS='1' and I.SJZT!='6' and SJZT in ('2','3','4','6') and I.SFYX='1' %ndCondition% group by L.JSBM) a, \
		(select D.ROW_ID,D.BMJC,SORT from FS_ORG_DEPT D where D.ROW_ID not in ('100000000000','200000000000','100000000008') and EXTEND1!='1') b \
		where a.JSBM(+)=b.ROW_ID \
		union all \
        select sum(nvl(ZS, 0)) VALUE,to_nchar('项目管理公司') LABEL,'解决' as SERIESNAME,1 as XH,5 as SORT,'WTZZ_XMGLGS'||'@'||'JJQK_YJJ' FIELDNAME \
          from (select count(distinct WTTB_INFO_ID) zs, L.JSBM \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and I.SJZT = '6' \
                   and I.SFYX = '1' \
                   %ndCondition% \
                 group by L.JSBM) A, \
               FS_ORG_DEPT D \
         where A.JSBM(+) = D.ROW_ID \
           and D.EXTEND1 = '1' \
        union all \
        select sum(nvl(ZS, 0)) VALUE, \
               to_nchar('项目管理公司') LABEL, \
               '未解决' as SERIESNAME, \
               2 as XH, \
               5 as SORT,'WTZZ_XMGLGS'||'@'||'JJQK_WJJ' FIELDNAME \
          from (select count(distinct WTTB_INFO_ID) zs, L.JSBM \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and SJZT in ('2', '3', '4') \
                   and I.SFYX = '1' \
                   %ndCondition% \
                 group by L.JSBM) A, \
               FS_ORG_DEPT D \
         where A.JSBM(+) = D.ROW_ID \
           and D.EXTEND1 = '1' \
		union all \
		select sum(nvl(ZS, 0)) VALUE, \
			to_nchar('长建管') LABEL, \
			'解决' as SERIESNAME, \
			1 as XH, \
			6 as SORT,'WTZZ_100000000000'||'@'||'JJQK_YJJ' FIELDNAME \
			from (select count(*) zs \
	          from WTTB_INFO I, WTTB_LZLS L \
	         where I.WTTB_INFO_ID = L.WTID(+) \
	           and L.BLRJS = '1' \
	           and SJZT = '6' \
	           and I.SFYX = '1' \
	           and L.JSBM = '100000000000' \
	           %ndCondition% \
	           and JSR not in (select ACCOUNT from VIEW_ZXZR)) A \
		union all \
		select sum(nvl(ZS, 0)) VALUE, \
			to_nchar('长建管') LABEL, \
			'未解决' as SERIESNAME, \
			2 as XH, \
			6 as SORT,'WTZZ_100000000000'||'@'||'JJQK_WJJ' FIELDNAME \
			from (select count(*) zs \
	          from WTTB_INFO I, WTTB_LZLS L \
	         where I.WTTB_INFO_ID = L.WTID(+) \
	           and L.BLRJS = '1' \
	           and SJZT in ('2', '3', '4') \
	           and I.SFYX = '1' \
	           and L.JSBM = '100000000000' \
	           %ndCondition% \
	           and JSR not in (select ACCOUNT from VIEW_ZXZR)) A \
		) order by SORT,XH \

#主办部门满意程度SQL
ZBBMMYCDSQL = select * \
  from (select nvl(zs, 0) VALUE, \
               BMJC LABEL, \
               '不满意' as SERIESNAME, \
               1 as XH, \
               b.SORT, \
               'WTZZ_' || b.ROW_ID || '@' || 'MYCD_1' FIELDNAME \
          from (select count(distinct WTTB_INFO_ID) zs, L.JSBM \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '1' \
                   and I.SFYX = '1' %ndCondition% \
                 group by L.JSBM) a, \
               (select D.ROW_ID, D.BMJC, SORT \
                  from FS_ORG_DEPT D \
                 where D.ROW_ID not in \
                       ('100000000000', '200000000000', '100000000008') \
                   and EXTEND1 != '1') b \
         where a.JSBM(+) = b.ROW_ID \
        union all \
        select nvl(zs, 0) VALUE, \
               BMJC LABEL, \
               '基本满意' as SERIESNAME, \
               2 as XH, \
               b.SORT, \
               'WTZZ_' || b.ROW_ID || '@' || 'MYCD_2' FIELDNAME \
          from (select count(distinct WTTB_INFO_ID) zs, L.JSBM \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '2' \
                   and SJZT in ('2', '3', '4', '6') \
                   and I.SFYX = '1' %ndCondition% \
                 group by L.JSBM) a, \
               (select D.ROW_ID, D.BMJC, SORT \
                  from FS_ORG_DEPT D \
                 where D.ROW_ID not in \
                       ('100000000000', '200000000000', '100000000008') \
                   and EXTEND1 != '1') b \
         where a.JSBM(+) = b.ROW_ID \
        union all \
        select nvl(zs, 0) VALUE, \
               BMJC LABEL, \
               '非常满意' as SERIESNAME, \
               3 as XH, \
               b.SORT, \
               'WTZZ_' || b.ROW_ID || '@' || 'MYCD_3' FIELDNAME \
          from (select count(distinct WTTB_INFO_ID) zs, L.JSBM \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '3' \
                   and SJZT in ('2', '3', '4', '6') \
                   and I.SFYX = '1' %ndCondition% \
                 group by L.JSBM) a, \
               (select D.ROW_ID, D.BMJC, SORT \
                  from FS_ORG_DEPT D \
                 where D.ROW_ID not in \
                       ('100000000000', '200000000000', '100000000008') \
                   and EXTEND1 != '1') b \
         where a.JSBM(+) = b.ROW_ID \
        union all \
        select sum(nvl(ZS, 0)) VALUE, \
               to_nchar('项目管理公司') LABEL, \
               '不满意' as SERIESNAME, \
               1 as XH, \
               5 as SORT, \
               'WTZZ_XMGLGS' || '@' || 'MYCD_1' FIELDNAME \
          from (select count(distinct WTTB_INFO_ID) zs, L.JSBM \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '1' \
                   and I.SFYX = '1' %ndCondition% \
                 group by L.JSBM) A, \
               FS_ORG_DEPT D \
         where A.JSBM(+) = D.ROW_ID \
           and D.EXTEND1 = '1' \
        union all \
        select sum(nvl(ZS, 0)) VALUE, \
               to_nchar('项目管理公司') LABEL, \
               '基本满意' as SERIESNAME, \
               2 as XH, \
               5 as SORT, \
               'WTZZ_XMGLGS' || '@' || 'MYCD_2' FIELDNAME \
          from (select count(distinct WTTB_INFO_ID) zs, L.JSBM \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '2' \
                   and I.SFYX = '1' %ndCondition% \
                 group by L.JSBM) A, \
               FS_ORG_DEPT D \
         where A.JSBM(+) = D.ROW_ID \
           and D.EXTEND1 = '1' \
        union all \
        select sum(nvl(ZS, 0)) VALUE, \
               to_nchar('项目管理公司') LABEL, \
               '非常满意' as SERIESNAME, \
               3 as XH, \
               5 as SORT, \
               'WTZZ_XMGLGS' || '@' || 'MYCD_3' FIELDNAME \
          from (select count(distinct WTTB_INFO_ID) zs, L.JSBM \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '3' \
                   and I.SFYX = '1' %ndCondition% \
                 group by L.JSBM) A, \
               FS_ORG_DEPT D \
         where A.JSBM(+) = D.ROW_ID \
           and D.EXTEND1 = '1' \
        union all \
        select sum(nvl(ZS, 0)) VALUE, \
               to_nchar('长建管') LABEL, \
               '不满意' as SERIESNAME, \
               1 as XH, \
               6 as SORT, \
               'WTZZ_100000000000' || '@' || 'MYCD_1' FIELDNAME \
          from (select count(*) zs \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '1' \
                   and I.SFYX = '1' \
                   and L.JSBM = '100000000000' \
                 %ndCondition% \
                   and JSR not in (select ACCOUNT from VIEW_ZXZR)) A \
        union all \
        select sum(nvl(ZS, 0)) VALUE, \
               to_nchar('长建管') LABEL, \
               '基本满意' as SERIESNAME, \
               2 as XH, \
               6 as SORT, \
               'WTZZ_100000000000' || '@' || 'MYCD_2' FIELDNAME \
          from (select count(*) zs \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '2' \
                   and I.SFYX = '1' \
                   and L.JSBM = '100000000000' \
                 %ndCondition% \
                   and JSR not in (select ACCOUNT from VIEW_ZXZR)) A \
        union all \
        select sum(nvl(ZS, 0)) VALUE, \
               to_nchar('长建管') LABEL, \
               '非常满意' as SERIESNAME, \
               3 as XH, \
               6 as SORT, \
               'WTZZ_100000000000' || '@' || 'MYCD_3' FIELDNAME \
          from (select count(*) zs \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '3' \
                   and I.SFYX = '1' \
                   and L.JSBM = '100000000000' \
                 %ndCondition% \
                   and JSR not in (select ACCOUNT from VIEW_ZXZR)) A \
        union all \
        select sum(nvl(ZS, 0)) VALUE, \
               to_nchar('中心领导') LABEL, \
               '不满意' as SERIESNAME, \
               1 as XH, \
               7 as SORT, \
               'WTZZ_ZXLD' || '@' || 'MYCD_1' FIELDNAME \
          from (select count(*) zs \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '1' \
                   and I.SFYX = '1' \
                 %ndCondition% \
                   and JSR in (select ACCOUNT from VIEW_ZXZR)) A \
        union all \
        select sum(nvl(ZS, 0)) VALUE, \
               to_nchar('中心领导') LABEL, \
               '基本满意' as SERIESNAME, \
               2 as XH, \
               7 as SORT, \
               'WTZZ_ZXLD' || '@' || 'MYCD_2' FIELDNAME \
          from (select count(*) zs \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '2' \
                   and I.SFYX = '1' \
                 %ndCondition% \
                   and JSR in (select ACCOUNT from VIEW_ZXZR)) A \
        union all \
        select sum(nvl(ZS, 0)) VALUE, \
               to_nchar('长建管') LABEL, \
               '非常满意' as SERIESNAME, \
               3 as XH, \
               7 as SORT, \
               'WTZZ_ZXLD' || '@' || 'MYCD_3' FIELDNAME \
          from (select count(*) zs \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID(+) \
                   and L.BLRJS = '1' \
                   and L.MYCD = '3' \
                   and I.SFYX = '1' \
                 %ndCondition% \
                   and JSR in (select ACCOUNT from VIEW_ZXZR)) A) \
 order by SORT, XH \

#主办领导SQL
ZBLDSQL = select * from ( \
		select nvl(zs,0) VALUE,ACCOUNT,NAME LABEL,'解决' as SERIESNAME, 1 as XH ,b.SORT,'WTZZ_'||ACCOUNT||'@'||'JJQK_YJJ' FIELDNAME \
		from \
		(select  count(distinct WTTB_INFO_ID) zs,L.JSR  from WTTB_INFO I,WTTB_LZLS L where I.WTTB_INFO_ID=L.WTID(+) and L.BLRJS='1' and I.SJZT='6' and I.SFYX='1' %ndCondition% group by L.JSR) a, \
		(select ACCOUNT,NAME,SORT from VIEW_ZXZR) b \
		where a.JSR(+)=b.ACCOUNT \
		union all \
		select nvl(zs,0) VALUE,ACCOUNT,NAME LABEL,'未解决' as SERIESNAME, 2 as XH,b.SORT,'WTZZ_'||ACCOUNT||'@'||'JJQK_WJJ' FIELDNAME \
		from \
		(select  count(distinct WTTB_INFO_ID) zs,L.JSR  from WTTB_INFO I,WTTB_LZLS L where I.WTTB_INFO_ID=L.WTID(+) and L.BLRJS='1' and I.SJZT!='6' and SJZT in ('2','3','4','6') and I.SFYX='1' %ndCondition% group by L.JSR) a, \
		(select ACCOUNT,NAME,SORT from VIEW_ZXZR) b \
		where a.JSR(+)=b.ACCOUNT \
		) order by SORT,XH \

#问题提出情况SQL		
WTTCSQL = select * from ( \
select nvl(zs, 0) VALUE, BMJC LABEL, '解决' as SERIESNAME, 1 as XH, D.SORT,'TCBM_'||D.ROW_ID||'@'||'JJQK_YJJ' FIELDNAME \
  from (select count(WTTB_INFO_ID) ZS, I.LRBM \
          from WTTB_INFO I \
         where SFYX = '1' \
           and SJZT = '6' \
           %ndCondition% \
         group by I.LRBM) A, \
       FS_ORG_DEPT D \
 where A.LRBM(+) = D.ROW_ID \
   and D.ROW_ID not in ('200000000000','100000000008') \
   and EXTEND1 != '1' \
union all \
select nvl(zs, 0) VALUE, \
       BMJC LABEL, \
       '未解决' as SERIESNAME, \
       2 as XH, \
       D.SORT,'TCBM_'||D.ROW_ID||'@'||'JJQK_WJJ' FIELDNAME \
  from (select count(WTTB_INFO_ID) ZS, I.LRBM \
          from WTTB_INFO I \
         where SFYX = '1' \
           and SJZT in ('2', '3', '4') \
           %ndCondition% \
         group by I.LRBM) A, \
       FS_ORG_DEPT D \
 where A.LRBM(+) = D.ROW_ID \
   and D.ROW_ID not in ('200000000000','100000000008') \
   and EXTEND1 != '1' \
union all \
select sum(nvl(ZS, 0)) VALUE, \
       to_nchar('项目管理公司') LABEL, \
       '解决' as SERIESNAME, \
       1 as XH, \
       5 as SORT,'TCBM_XMGLGS@JJQK_YJJ' FIELDNAME \
  from (select count(WTTB_INFO_ID) ZS, I.LRBM \
          from WTTB_INFO I \
         where SFYX = '1' \
           and SJZT = '6' \
           %ndCondition% \
         group by I.LRBM) A, \
       FS_ORG_DEPT D \
 where A.LRBM(+) = D.ROW_ID \
   and D.EXTEND1 = '1' \
union all \
select sum(nvl(ZS, 0)) VALUE, \
       to_nchar('项目管理公司') LABEL, \
       '未解决' as SERIESNAME, \
       2 as XH, \
       5 as SORT,'TCBM_XMGLGS@JJQK_WJJ' FIELDNAME \
  from (select count(WTTB_INFO_ID) ZS, I.LRBM \
          from WTTB_INFO I \
         where SFYX = '1' \
           and SJZT in ('2', '3', '4') \
           %ndCondition% \
         group by I.LRBM) A, \
       FS_ORG_DEPT D \
 where A.LRBM(+) = D.ROW_ID \
   and D.EXTEND1 = '1') order by SORT,XH \

#问题提出饼图
WTTCBTSQL = select * from ( \
select count(WTTB_INFO_ID) VALUE, \
       (select DIC_VALUE2 \
          from FS_DIC_TREE \
         where DIC_NAME_CODE = 'WTLX' \
           and DIC_CODE = WTLX) LABEL, \
       '中心各部门' CATEGORY, \
		'TCBM_ZXGBM'||'@WTLX_'||WTLX FIELDNAME,\
		'TCBM_ZXGBM' CATEGORYFIELDNAME,\
       1 SORT \
  from WTTB_INFO I, FS_ORG_DEPT D \
 where I.LRBM = D.ROW_ID \
   and I.SJZT in ('2', '3', '4', '6') \
   and I.SFYX='1' \
	%ndCondition% \
   and D.ROW_ID!='100000000020' \
   and D.EXTEND1 != '1' \
 group by WTLX \
union all \
select count(WTTB_INFO_ID) VALUE, \
       (select DIC_VALUE2 \
          from FS_DIC_TREE \
         where DIC_NAME_CODE = 'WTLX' \
           and DIC_CODE = WTLX) LABEL, \
       '建委计财处' CATEGORY, \
	   'TCBM_100000000020'||'@WTLX_'||WTLX FIELDNAME,\
		'TCBM_100000000020' CATEGORYFIELDNAME,\
       2 SORT \
  from WTTB_INFO I, FS_ORG_DEPT D \
 where I.LRBM = D.ROW_ID \
   and I.SJZT in ('2', '3', '4', '6') \
   and I.SFYX='1' \
	%ndCondition% \
   and D.ROW_ID='100000000020' \
   and D.EXTEND1 != '1' \
 group by WTLX \
union all \
select count(WTTB_INFO_ID) VALUE, \
       (select DIC_VALUE2 \
          from FS_DIC_TREE \
         where DIC_NAME_CODE = 'WTLX' \
           and DIC_CODE = WTLX) LABEL, \
       '项目管理公司' CATEGORY, \
		'TCBM_XMGLGS'||'@WTLX_'||WTLX FIELDNAME,\
		'TCBM_XMGLGS' CATEGORYFIELDNAME,\
       3 SORT \
  from WTTB_INFO I, FS_ORG_DEPT D \
 where I.LRBM = D.ROW_ID \
   and I.SJZT in ('2', '3', '4', '6') \
   and I.SFYX='1' \
	%ndCondition% \
   and D.EXTEND1 = '1' \
 group by WTLX) order by SORT

#问题接收饼图SQL
WTJSBTSQL=select * \
  from (select count(WTTB_INFO_ID) VALUE, \
               (select DIC_VALUE2 \
                  from FS_DIC_TREE \
                 where DIC_NAME_CODE = 'WTLX' \
                   and DIC_CODE = WTLX) LABEL, \
               '中心各部门' CATEGORY, \
				'WTZZ_ZXGBM'||'@WTLX_'||WTLX FIELDNAME,\
				'WTZZ_ZXGBM' CATEGORYFIELDNAME,\
               1 SORT \
          from (select WTTB_INFO_ID, WTLX, L.JSBM, I.LRSJ \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID \
                   and L.BLRJS = '1' \
                   and I.SFYX = '1' \
                   and L.SFYX = '1' \
                   and L.JSR not in (select ACCOUNT from VIEW_ZXZR) \
					%ndCondition% \
                   and I.SJZT in ('2', '3', '4', '6')) I, \
               FS_ORG_DEPT D \
         where I.JSBM = D.ROW_ID \
           %ndCondition% \
           and D.EXTEND1 != '1' \
         group by WTLX \
        union all \
        select count(WTTB_INFO_ID) VALUE, \
		       (select DIC_VALUE2 \
		          from FS_DIC_TREE \
		         where DIC_NAME_CODE = 'WTLX' \
		           and DIC_CODE = WTLX) LABEL, \
		       '中心领导' CATEGORY, \
				'WTZZ_ZXLD'||'@WTLX_'||WTLX FIELDNAME,\
				'WTZZ_ZXLD' CATEGORYFIELDNAME,\
		       2 SORT \
		  from (select WTTB_INFO_ID, WTLX, L.JSBM, I.LRSJ \
		          from WTTB_INFO I, WTTB_LZLS L \
		         where I.WTTB_INFO_ID = L.WTID \
		           and L.BLRJS = '1' \
		           and I.SFYX = '1' \
		           and L.SFYX = '1' %ndCondition% \
		           and L.JSR in (select ACCOUNT from VIEW_ZXZR) \
		           and I.SJZT in ('2', '3', '4', '6')) I \
		 where 1=1 \
		 group by WTLX \
        union all \
        select count(WTTB_INFO_ID) VALUE, \
               (select DIC_VALUE2 \
                  from FS_DIC_TREE \
                 where DIC_NAME_CODE = 'WTLX' \
                   and DIC_CODE = WTLX) LABEL, \
               '项目管理公司' CATEGORY, \
				'WTZZ_XMGLGS'||'@WTLX_'||WTLX FIELDNAME,\
				'WTZZ_XMGLGS' CATEGORYFIELDNAME,\
               3 SORT \
          from (select WTTB_INFO_ID, WTLX, L.JSBM, I.LRSJ \
                  from WTTB_INFO I, WTTB_LZLS L \
                 where I.WTTB_INFO_ID = L.WTID \
                   and L.BLRJS = '1' \
                   and I.SFYX = '1' \
                   and L.SFYX = '1' \
	%ndCondition% \
                   and I.SJZT in ('2', '3', '4', '6')) I, \
               FS_ORG_DEPT D \
         where I.JSBM = D.ROW_ID \
           %ndCondition% \
           and D.ROW_ID != '100000000020' \
           and D.EXTEND1 = '1' \
         group by WTLX) \
 order by SORT \


#年度问题提报情况
NDWTTBQK=select * from ( \
		select nvl(zs,0) VALUE,DIC_CODE,DIC_VALUE||'月' LABEL,'问题数量' as SERIESNAME, 1 as XH \
		from \
		(select  count(distinct WTTB_INFO_ID) zs,to_char(I.LRSJ,'MM') YF  from WTTB_INFO I where I.SFYX='1' and SJZT in ('2','3','4','6') %ndCondition% group by to_char(I.LRSJ,'MM')) a, \
		(select DIC_CODE,DIC_VALUE from FS_DIC_TREE where PARENT_ID='9000000000127') b \
		where YF(+)=b.DIC_CODE \
		union all \
		select nvl(zs,0) VALUE,DIC_CODE,DIC_VALUE||'月' LABEL,'解决数量' as SERIESNAME, 2 as XH \
		from \
		(select  count(distinct WTTB_INFO_ID) zs,to_char(I.LRSJ,'MM') YF  from WTTB_INFO I where I.SJZT='6' and I.SFYX='1' %ndCondition% group by to_char(I.LRSJ,'MM')) a, \
		(select DIC_CODE,DIC_VALUE from FS_DIC_TREE where PARENT_ID='9000000000127') b \
		where YF(+)=b.DIC_CODE \
		) order by DIC_CODE,XH \

#问题满意程度分布
WTMYCDSQL = select DIC_VALUE LABEL, \
       (select count(1) \
          from WTTB_INFO I,(select WTID,MYCD from WTTB_LZLS where BLRJS='1' and SFYX='1') L \
         where MYCD = t.dic_code and I.WTTB_INFO_ID=L.WTID  %ndCondition%  \
           and SFYX = '1' \
           and SJZT in ('2', '3', '4', '6')) VALUE, \
       'MYCD_' || DIC_CODE FIELDNAME \
  from FS_DIC_TREE T \
 where T.DIC_NAME_CODE='MYCD' and T.DIC_LAYER!=0 \
 order by DIC_CODE \


#问题最多项目
WTZDXMSQL = select WTS NUM,XMMC NAME from(select count(distinct WTTB_INFO_ID) WTS,I.XMID from WTTB_INFO I,GC_JH_SJ J where I.XMID=J.XMID and I.SFYX='1' and SJZT in ('2','3','4','6') %ndCondition% group by I.XMID) A, \
		(select XMID,XMMC from GC_JH_SJ where SFYX='1' and XMBS='0') B where A.XMID=B.XMID(+) order by WTS DESC

#延迟时间最长的问题
YCSJZCWTSQL=select WTBT as NAME,CQTS NUM  from ( \
		select WTTB_INFO_ID,floor(decode(SJSJ,null,sysdate,SJSJ)-YJSJ) as CQTS,WTBT from WTTB_INFO where SFYX='1' and SJZT in ('2','3','4','6') and YJSJ is not null and ((SJSJ is null and YJSJ<sysdate) or SJSJ>YJSJ) %ndCondition% \
		) order by CQTS desc
		
		
#解决问题最多的部门
JJWTZDBM=select distinct NAME,NUM from ( \
		select B.BMJC||'/'||B.NAME as NAME,WTS NUM from \
		(select count(WTTB_INFO_ID) WTS,L.JSBM from WTTB_INFO I,WTTB_LZLS L where I.WTTB_INFO_ID=L.WTID and I.SJZT='6' and L.BLRJS='1' %ndCondition% group by L.JSBM) A,\
		(select P.NAME,D.ROW_ID,D.BMJC from FS_ORG_PERSON P,FS_ORG_DEPT D where P.ACCOUNT=D.FZR) B where A.JSBM=B.ROW_ID \
		union all \
		select B.NAME as NAME,WTS NUM from \
		(select count(WTTB_INFO_ID) WTS,L.JSR from WTTB_INFO I,WTTB_LZLS L where I.WTTB_INFO_ID=L.WTID and I.SJZT='6' and L.BLRJS='1' %ndCondition% group by L.JSR) A,\
		VIEW_ZR B where A.JSR=B.ACCOUNT  and B.ACCOUNT!='hanag' \
		) order by NUM DESC 
		
#解决率最高的部门
JJXLZGBM=select distinct NAME,nvl(WTS,0) WTS,case WTZS when 0 then '0' else nvl(to_char(round((WTS/WTZS)*100,2),'fm999999999990.00'),0) end NUMBFB \
		from ( \
		select B.BMJC||'/'||B.NAME as NAME,\
		WTS,\
		WTZS \
		from \
		(select count(WTTB_INFO_ID) WTZS,L.JSBM,\
			(select count(WTTB_INFO_ID) from WTTB_INFO I,WTTB_LZLS B where I.WTTB_INFO_ID=B.WTID and B.JSBM=L.JSBM and SJZT='6' and B.BLRJS='1' %ndCondition% group by B.JSBM) WTS \
			from WTTB_INFO I,WTTB_LZLS L where I.WTTB_INFO_ID=L.WTID and I.SJZT in ('2','4','6') and L.BLRJS='1' %ndCondition% group by L.JSBM) A,\
		(select P.NAME,D.ROW_ID,D.BMJC from FS_ORG_PERSON P,FS_ORG_DEPT D where P.ACCOUNT=D.FZR) B where A.JSBM=B.ROW_ID \
		union all \
		select B.NAME as NAME,WTS,WTZS \
		from \
		(select count(WTTB_INFO_ID) WTZS,L.JSR,\
			(select count(WTTB_INFO_ID) from WTTB_INFO I,WTTB_LZLS B where I.WTTB_INFO_ID=B.WTID and B.JSR=L.JSR and SJZT='6' and B.BLRJS='1' %ndCondition% group by B.JSBM) WTS \
			from WTTB_INFO I,WTTB_LZLS L where I.WTTB_INFO_ID=L.WTID and I.SJZT in ('2','4','6') and L.BLRJS='1' %ndCondition% group by L.JSR) A,\
		VIEW_ZR B where A.JSR=B.ACCOUNT  and B.ACCOUNT!='hanag' \
		) order by to_number(NUMBFB) DESC 

#数据钻取-表头
THEADSQL=select distinct I.wttb_info_id, I.JHSJID, I.WTLX, I.WTBT, I.YJSJ, I.SJSJ, I.SJZT, I.WTXZ, I.CQBZ, I.LRR, I.LRSJ, I.LRBM, I.LRBMMC, I.GXR, I.GXSJ, I.GXBM, I.GXBMMC, I.YWLX, I.SJBH, I.SJMJ, I.SFYX,I.XMMC,I.BDMC \
		,'' BLQK,L.JSR,XWWCSJ,CBCS \
		from WTTB_INFO I,(select WTID,JSR,XWWCSJ \
		from WTTB_LZLS L,WTTB_INFO I \
		where L.WTID(+)=I.WTTB_INFO_ID \
		and L.BLRJS = '1' \
		and L.LRSJ in (select max(LRSJ) from WTTB_LZLS group by WTID)) L \
		where I.WTTB_INFO_ID=L.WTID and I.WTTB_INFO_ID in(%CONDSQL%)
		
#数据钻取-累计问题数
ZQ_LJWTS=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and I.SJZT in ('2','3','4','6')
#数据钻取-累计极其严重问题数
ZQ_LJJQYZWT=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and WTXZ='13' and I.SJZT in ('2','3','4','6')
#数据钻取-累计严重问题数
ZQ_LJYZWT=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and WTXZ='12' and I.SJZT in ('2','3','4','6')
#数据钻取-累计一般问题数
ZQ_LJYBWT=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and WTXZ='11' and I.SJZT in ('2','3','4','6')

#数据钻取-年度问题数
ZQ_BNDWTS=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' %ndCondition% and I.SJZT in ('2','3','4','6')
#数据钻取-年度极其严重问题数
ZQ_NDJQYZWT=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and WTXZ='13' %ndCondition% and I.SJZT in ('2','3','4','6')
#数据钻取-年度严重问题数
ZQ_NDYZWT=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and WTXZ='12' %ndCondition% and I.SJZT in ('2','3','4','6')
#数据钻取-年度一般问题数
ZQ_NDYBWT=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and WTXZ='11' %ndCondition% and I.SJZT in ('2','3','4','6')
ZQ_YJJ=	select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and SJZT='6' %ndCondition% and I.SJZT in ('2','3','4','6')
ZQ_SWJJ=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and SJZT!='6' %ndCondition% and I.SJZT in ('2','3','4','6')
ZQ_CQWJJ=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and SJZT!='6' and I.YJSJ<SYSDATE %ndCondition% and I.SJZT in ('2','3','4','6')

#数据钻取-累计已解决问题
ZQ_LJYJJWT=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and SJZT='6' 
#数据钻取-累计未解决问题
ZQ_LJWJJWT=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and SJZT in ('2','3','4','5')
#数据钻取-累计正在解决问题
ZQ_LJZZJJWT=select WTTB_INFO_ID from WTTB_INFO I where I.SFYX='1' and SJZT in ('2','4')
#数据钻取-问题最多项目
ZQ_WTZDXM=select WTTB_INFO_ID from WTTB_INFO \
		where XMID in(select A.XMID from(select count(WTTB_INFO_ID) WTCOUNT,XMID \
						from WTTB_INFO T1 \
						where T1.SFYX='1' and SJZT in ('2','3','4','6') and XMID is not null group by XMID order by WTCOUNT desc) A where ROWNUM<2 group by A.XMID)
#数据钻取-问题最多类型
ZQ_WTZDLX=select WTTB_INFO_ID from WTTB_INFO \
		where SFYX='1' and WTLX in(select A.WTLX from(select count(WTTB_INFO_ID) WTCOUNT,WTLX from WTTB_INFO T1 where T1.SFYX='1' and SJZT in ('2','3','4','6') and WTLX is not null group by WTLX order by WTCOUNT desc) A where ROWNUM<2 group by A.WTLX)
#数据钻取-提交给项目管理公司
ZQ_TJGXMGLGS=select WTTB_INFO_ID from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
			where A.WTTB_INFO_ID=B.WTID \
			and A.SFYX='1' \
			and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1='1') and A.SJZT in ('2','3','4','6')
#数据钻取-提交给项目管理公司已解决		
ZQ_TJGXMGLGSYJJ=select WTTB_INFO_ID from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
			where A.WTTB_INFO_ID=B.WTID \
			and A.SFYX='1' \
			and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1='1') and A.SJZT in ('6')
#数据钻取-提交给中心各部门
ZQ_TJGZXGBM=select WTTB_INFO_ID from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1!='1' and ROW_ID!='100000000000' and ROW_ID!='200000000000') \
		and A.SJZT in ('2','3','4','6')
#数据钻取-提交给中心各部门已解决
ZQ_TJGZXGBMYJJ=select WTTB_INFO_ID from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSBM in (select ROW_ID from FS_ORG_DEPT where EXTEND1!='1' and ROW_ID!='100000000000' and ROW_ID!='200000000000') \
		and A.SJZT in ('6')
#数据钻取-提交给中心领导
ZQ_TJGZXLD=select WTTB_INFO_ID from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSR in (select ACCOUNT from VIEW_ZR where ACCOUNT!='hanag') and A.SJZT in ('2','3','4','6')
#数据钻取-提交给中心领导已解决
ZQ_TJGZXLDYJJ=select WTTB_INFO_ID from WTTB_INFO A,(select WTID,JSBM,JSR from WTTB_LZLS where SFYX='1' and BLRJS='1') B \
		where A.WTTB_INFO_ID=B.WTID \
		and A.SFYX='1' \
		and B.JSR in (select ACCOUNT from VIEW_ZR where ACCOUNT!='hanag') and A.SJZT in ('6')
#数据钻取-超期未解决问题
ZQ_CQWJJWT=select WTTB_INFO_ID from WTTB_INFO where YJSJ<sysdate and SJZT in ('2','4')
#数据钻取-超期未解决问题
ZQ_CQWFKWT=select WTTB_INFO_ID from WTTB_INFO where YJSJ<sysdate and SJZT in ('2')
#--------------------------------------------------------------------------项目手册
XMSC_WTGKSQL=select count(*) GTBWT,\
		NVL(sum(decode(WTXZ,'13',1,0)),0) JQYZWT,\
		NVL(sum(decode(WTXZ,'12',1,0)),0) YZWT,\
		NVL(sum(decode(WTXZ,'11',1,0)),0) YBWT, \
		NVL(sum(decode(SJZT,'6',1,0)),0) YJJWT,\
		NVL(sum(decode(SJZT,'6',0,1)),0) WJJWT, \
		NVL(sum(case when YJSJ<sysdate and SJZT!='6' then 1 else 0 end),0) CQWJJ \
		from WTTB_INFO where SJZT in ('2','3','4','6') %ndCondition%  

XMSC_JJQKFBSQL=select '已解决' LABEL,NVL(count(WTTB_INFO_ID),0) VALUE from WTTB_INFO I where I.SFYX='1' and SJZT='6' %ndCondition% \
		union all \
		select '未解决（未超期）' LABEL,NVL(count(WTTB_INFO_ID),0) VALUE from WTTB_INFO I where I.SFYX='1' and SJZT!='6' and YJSJ>=SYSDATE %ndCondition% \
		union all \
		select '未解决（已超期）' LABEL,NVL(count(WTTB_INFO_ID),0) VALUE from WTTB_INFO I where I.SFYX='1' and SJZT!='6' and YJSJ<SYSDATE %ndCondition% \

#-----------------------------------------------------所有排迁任务，白玉要的EXCEL，系统目前还未用到这个语句
ALL_ROWLIST=select  \
	WTBT as 问题标题,  \
	(select DIC_VALUE from FS_DIC_TREE where DIC_NAME_CODE='WTLX' and DIC_CODE=I.WTLX ) as 问题类型, \
	(select DIC_VALUE from FS_DIC_TREE where DIC_NAME_CODE='WTXZ' and DIC_CODE=I.WTXZ) as 问题性质, \
	(select DIC_VALUE from FS_DIC_TREE where DIC_NAME_CODE='WTZT' and DIC_CODE=I.SJZT) as 问题状态, \
	S.XMMC as 涉及项目, \
	S.BDMC as 涉及标段, \
	(select PFNR from WTTB_PFQK where WTID=I.WTTB_INFO_ID and NRLX='0' and rownum=1) 问题描述, \
	(select NAME from FS_ORG_PERSON where ACCOUNT=I.LRR) as 发起人, \
	(select NAME from FS_ORG_PERSON where ACCOUNT=H.JSR) as 审核人, \
	(select BMJC from FS_ORG_DEPT where ROW_ID=I.LRBM) as 发起部门, \
	(select NAME from FS_ORG_PERSON where ACCOUNT=L.JSR) as 主办人, \
	(select BMJC from FS_ORG_DEPT where ROW_ID=L.JSBM) as 主办部门, \
	to_char(I.LRSJ,'YYYY-MM-DD') 发起日期, \
	to_char(YJSJ,'YYYY-MM-DD') as 希望解决日期, \
	to_char(SJSJ,'YYYY-MM-DD') as 实际解决日期, \
	case when trunc(decode(SJSJ,null,sysdate,SJSJ)-I.YJSJ)<=0 or SJZT='3' \
	  then \
	    '--' \
	    else \
	      to_char(trunc(decode(SJSJ,null,sysdate,SJSJ)-I.YJSJ)) \
	  end 超期天数, \
	CBCS as 催办次数 \
	from WTTB_INFO I, \
	GC_JH_SJ S, \
	(select JSR,JSBM,WTID from WTTB_LZLS where BLRJS='1') L, \
	(select JSR,JSBM,WTID from WTTB_LZLS where BLRJS='3') H \
	where I.JHSJID=S.GC_JH_SJ_ID(+) \
	and I.WTTB_INFO_ID=L.WTID \
	and I.WTTB_INFO_ID=H.WTID \
	and I.SFYX='1' \
	order by I.LRSJ,WTXZ,WTBT \

		

