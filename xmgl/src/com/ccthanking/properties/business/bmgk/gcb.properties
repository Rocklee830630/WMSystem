#工程-进度管理-列表
GC_JDGL_LB=select t.xmmc, t.bdmc, (select bd.bddd from gc_xmbd bd where bd.jhsjid = t.gc_jh_sj_id) bddd, '-' htgq, '-' jhgq, t.zc_sj, t.pq_sj, t.kgsj_sj, t.wgsj_sj, t.wgsj, \
decode((case when t.wgsj is not null then  case when t.wgsj_sj is null then to_char(sign(sysdate-t.wgsj)) else to_char(sign(t.wgsj_sj-t.wgsj)) end else '0' end),'1','是','-1','否','0','计划完成时间为空') isyq \
from VIEW_GC_JH_SJ t,gc_tcjh_xmxdk xdk where t.xmid=xdk.gc_tcjh_xmxdk_id(+) %XMLX% %Condition% \


#工程-工程计量及支付-统筹概况//洽商业务表，累计金额的单位是“元”
GC_GCJLZF_TCGK=select * from \
/*已开（复）工xx子项xx标段   子项标段有一个开工就算一个子项。*/ \
(SELECT COUNT(DISTINCT T.XMID) 				GCGL_KFGGL_YKFG_ZX 				FROM VIEW_GC_JH_SJ T WHERE T.KGSJ_SJ IS NOT NULL AND BDBS='1' %Condition%), \
(SELECT COUNT(DISTINCT T.GC_JH_SJ_ID) 		GCGL_KFGGL_YKFG_BD  			FROM VIEW_GC_JH_SJ T WHERE T.KGSJ_SJ IS NOT NULL AND BDBS='1' %Condition%), \
(SELECT NVL(SUM(ZS), '0') 					GCGL_KFGGL_YWG_ZX   			FROM (SELECT COUNT(A.XMID) ZS FROM (SELECT COUNT(T.GC_JH_SJ_ID) ZS, T.XMID FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL%Condition% AND T.XMBS = '1' GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE T.XMBS = '1' %Condition% AND T.ISWGSJ = '1' GROUP BY T.XMID) B WHERE A.XMID = B.XMID AND A.ZS >= BDS UNION ALL SELECT COUNT(T.GC_JH_SJ_ID) ZS FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL %Condition% AND T.XMBS = '0' AND T.ISNOBDXM = '1' GROUP BY T.XMID)), \
(SELECT NVL(SUM(ZS), '0') 					GCGL_KFGGL_YWG_BD   			FROM (SELECT COUNT(T.GC_JH_SJ_ID) ZS FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL%Condition% AND T.XMBS = '1' UNION ALL  SELECT COUNT(T.GC_JH_SJ_ID) ZS FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL %Condition% AND T.XMBS = '0' AND T.ISNOBDXM = '1' GROUP BY T.XMID)), \
(SELECT  to_char(round( nvl(sum(LJJLSDZ),0) / 100000000, 3), 'fm999999999999999990.000') GC_GCJLZF_TCGK_LJWCZ from Gc_Xmglgs_Jlb where sfyx = '1' and to_char(JLYF,'YYYY') = '%_nd%' and Tcjh_Sj_Id in (select gc_jh_sj_id from VIEW_GC_JH_SJ t where (XMBS = '1' or isnobdxm = '1') %Condition% and sfyx = '1')), \
(select  to_char(round( nvl(sum(htzf.zfje),0) / 100000000, 3), 'fm999999999999999990.000') GC_GCJLZF_TCGK_YBF from gc_htgl_ht ht, gc_htgl_htsj htsj, gc_htgl_ht_htzf htzf, VIEW_GC_JH_SJ t where htsj.jhsjid = t.gc_jh_sj_id and htsj.htid = ht.id and htsj.id = htzf.htsjid and ht.htlx = 'SG' %Condition%)  \

#工程-工程计量及支付-总体情况
GC_GCJLZF_ZTQK=SELECT to_char(round( nvl(sum(LJJLSDZ),0) / 100000000, 3), 'fm999999999999999990.000')  value,'完成计量' LABEL from Gc_Xmglgs_Jlb where sfyx = '1' and to_char(JLYF,'YYYY') = '%_nd%' and Tcjh_Sj_Id in (select gc_jh_sj_id from VIEW_GC_JH_SJ t where (XMBS = '1' or isnobdxm = '1') %Condition% and sfyx = '1') \
union all \
select to_char(round( nvl(sum(htzf.zfje),0) / 100000000, 3), 'fm999999999999999990.000') value,'已支付' LABEL  from gc_htgl_ht ht, gc_htgl_htsj htsj, gc_htgl_ht_htzf htzf, VIEW_GC_JH_SJ t where htsj.jhsjid = t.gc_jh_sj_id and htsj.htid = ht.id and htsj.id = htzf.htsjid and ht.htlx = 'SG' %Condition%  \

#--已报开复工令未开工 前一条件下，计划表开工实际时间值为空的  所有的未开工是一个项目 GCGL_KFGGL_YKFG_WKG_ZX GCGL_KFGGL_YKFG_WKG_BD
#--已开工 GCGL_KFGGL_YKFG_YKG_ZX GCGL_KFGGL_YKFG_YKG_BD
#--部分开工 GCGL_KFGGL_YKFG_BFKG_ZX GCGL_KFGGL_YKFG_BFKG_BD
#--已完工XX子项XX标段 GCGL_KFGGL_YKFG_YWG_ZX GCGL_KFGGL_YKFG_YWG_BD
#--在建跨年结转 XX子项 GCGL_KFGGL_YKFG_ZJKNJZ_ZX
#--已完XX标段在建XX标段   GCGL_KFGGL_YKFG_ZJKNJZ_ZX_YWBD
#--未完XX标段在建XX标段  GCGL_KFGGL_YKFG_ZJKNJZ_ZX_WWBD
#--停工令情况 XX子项 GCGL_KFGGL_YKFG_TGL_ZX
#--已报XX标段 GCGL_KFGGL_YKFG_YB_BD
#--未报XX标段 GCGL_KFGGL_YKFG_WB_BD

#--已开复工 一个标段开复工，就算一个项目。(有时间重写) GCGL_KFGGL_YKFG_ZX GCGL_KFGGL_YKFG_BD
#--已完工所有标段都完工 才算一个项目 GCGL_KFGGL_YWG_ZX GCGL_KFGGL_YWG_BD

#--已确定施工单位计划表施工单位实际时间有值的。考虑续建项目 GCGL_KFGGL_YQDSGDW_ZX GCGL_KFGGL_YQDSGDW_BD
#--暂不具备开工条件  新增功能，由工程部，对计划添加“具备”、“不具备”的情况 GCGL_KFGGL_ZBJBKGTJ_ZX GCGL_KFGGL_ZBJBKGTJ_BD
#--具备开工条件 GCGL_KFGGL_JBKGTJ_ZX GCGL_KFGGL_JBKGTJ_BD
#--未报开复工令  （根据标段有一个开复就算开工）前一条件下，关联开复工令业务，如果关联不到，表示未报开复工令。考虑到续建项目，要用数据唯一编号关联 GCGL_KFGGL_WKFG_ZX GCGL_KFGGL_WKFG_BD
#--已报开复工令 GCGL_KFGGL_BYKFG_ZX GCGL_KFGGL_BYKFG_BD
#--未报开复工令未开工 前一条件下，计划表开工实际时间值为空的  所有的未开工是一个项目 GCGL_KFGGL_WKFG_WKG_ZX GCGL_KFGGL_WKFG_WKG_BD
#--已开工 前一条件下 GCGL_KFGGL_WKFG_YKG_ZX GCGL_KFGGL_WKFG_YKG_BD
#--部分开工 前一条件下 GCGL_KFGGL_WKFG_BFKG_ZX GCGL_KFGGL_WKFG_BFKG_BD
#--已完工 前一条件下 GCGL_KFGGL_WKFG_YWG_ZX GCGL_KFGGL_WKFG_YWG_BD
#--在建跨年结转  GCGL_KFGGL_WKFG_ZJKNJZ_ZX
#--已完XX标段 GCGL_KFGGL_WKFG_ZJKNJZ_YB_BD
#--在建XX标段   GCGL_KFGGL_WKFG_ZJKNJZ_WB_BD
#--停工令情况 同 在建跨年结转 GCGL_KFGGL_WKFG_TGL_ZX
#--已报XX标段   GCGL_KFGGL_WKFG_TGL_YB_BD
#--未报XX标段   GCGL_KFGGL_WKFG_TGL_WB_BD
#工程部-工程管理-统筹概况
#(SELECT COUNT(GC_JH_SJ_ID) ZBGL_TJGK_JGZX_DX FROM VIEW_GC_JH_SJ T WHERE DXZX LIKE '%1%' AND XMBS='0' %Condition%), 
#SELECT COUNT(GC_JH_SJ_ID) ZBGL_TJGK_JGZX_ZX FROM VIEW_GC_JH_SJ T WHERE DXZX LIKE '%0%' AND XMBS='0' %Condition%), 
#(SELECT COUNT(GC_JH_SJ_ID) ZBGL_TJGK_XINJ_DX FROM VIEW_GC_JH_SJ T WHERE DXZX LIKE '%1%' AND XMBS='0' AND CJXMXZ='0' %Condition%), 
#(SELECT COUNT(GC_JH_SJ_ID) ZBGL_TJGK_XINJ_ZX FROM VIEW_GC_JH_SJ T WHERE DXZX LIKE '%0%' AND XMBS='0' AND CJXMXZ='0' %Condition%), 

GC_GCGL_TCGK=\
WITH  \
 WITH_YBKFG_XM as (select XMID, GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.XMID in (select K.XDKID from GC_GCB_KFG K where KGFG in ('0', '1')) and (KGTJZT = '0' or KGTJZT is null) and XMBS = '0' %Condition%) \
,WITH_WBKFG_XM as (select XMID, GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.XMID not in (select K.XDKID from GC_GCB_KFG K where KGFG in ('0', '1')) and (KGTJZT = '0' or KGTJZT is null) and XMBS = '0' %Condition% ) \
,WITH_WBKFG_BD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where (T.KGTJZT='0' or T.KGTJZT is null) and XMID not in (select XDKID from GC_GCB_KFG where KGFG in ('0','1')) and BDBS='1' %Condition%) \
,WITH_YBKFG_BD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where (T.KGTJZT='0' or T.KGTJZT is null) and GC_JH_SJ_ID in (select TCJHSJID from GC_GCB_KFG where KGFG in ('0','1')) and BDBS='1' %Condition%) \
,WITH_YBKFG_WKBD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where (T.KGTJZT='0' or T.KGTJZT is null) and GC_JH_SJ_ID not in (select TCJHSJID from GC_GCB_KFG where KGFG in ('0','1')) and XMID in (select XDKID from GC_GCB_KFG where KGFG in ('0','1')) and BDBS='1' %Condition%) \
,WITH_YBKFG_QBBD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where (T.KGTJZT='0' or T.KGTJZT is null)  and BDBS='1'  %Condition%) \
SELECT * FROM \
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_ZX 				from WITH_WBKFG_XM T), \
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_BD 				from WITH_WBKFG_BD T), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_BYKFG_ZX       		from WITH_YBKFG_XM T),\
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_BYKFG_BD       		from WITH_YBKFG_BD T),\
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_BYKFG_WKBD       	from WITH_YBKFG_WKBD T),\
(SELECT NVL(COUNT(T.GC_JH_SJ_ID), '0') 				GCGL_KFGGL_ZBJBKGTJ_ZX   		FROM gc_jh_tjgl A, VIEW_GC_JH_SJ T  WHERE A.JHSJID = T.GC_JH_SJ_ID    AND A.KGTJZT = '1' %Condition% AND T.XMBS = '0'), \
(SELECT NVL(COUNT(T.GC_JH_SJ_ID), '0') 				GCGL_KFGGL_ZBJBKGTJ_BD   		FROM gc_jh_tjgl A, VIEW_GC_JH_SJ T  WHERE A.JHSJID = T.GC_JH_SJ_ID    AND A.KGTJZT = '1' %Condition% AND (T.XMBS = '1' OR (T.XMBS = '0' AND T.ISNOBDXM = '1'))), \
(SELECT NVL(COUNT(distinct T.XMID), '0') 			GCGL_KFGGL_JBKGTJ_ZX 			FROM VIEW_GC_JH_SJ T WHERE T.BDBS = '1' and ND='2014' AND T.GC_JH_SJ_ID NOT IN (SELECT B.JHSJID FROM GC_JH_TJGL B WHERE B.KGTJZT = '1')),\
(SELECT NVL(COUNT(T.GC_JH_SJ_ID), '0') 				GCGL_KFGGL_JBKGTJ_BD 			FROM  VIEW_GC_JH_SJ T WHERE T.BDBS = '1' %Condition% AND T.GC_JH_SJ_ID NOT IN (SELECT B.JHSJID FROM GC_JH_TJGL B WHERE B.KGTJZT='1')),\
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_JGZXFZ_ZX   			FROM VIEW_GC_JH_SJ T  WHERE T.XMBS='0' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_JGZXFZ_BD   			FROM VIEW_GC_JH_SJ T  WHERE T.BDBS='1' %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_WKG_ZX       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_WKG_BD       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_YKG_ZX       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_YKG_BD       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is not null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_BFKG_ZX       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_BFKG_BD       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is not null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_BFKG_WKBD       from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_YKFG_YWG_ZX   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_YWG_BD   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_ZJKNJZ_ZX   	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_YKFG_ZJKNJZ_ZX_YWBD 	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and WGSJ_SJ is not null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)  				GCGL_KFGGL_YKFG_ZJKNJZ_ZX_WWBD 	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and WGSJ_SJ is null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_TGL_ZX   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) and T.XMID in (SELECT A.XDKID FROM GC_GCB_KFG A WHERE KGFG = '2') %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_YB_BD   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (T.KGTJZT='0' or T.KGTJZT is null) and T.GC_JH_SJ_ID in (SELECT A.TCJHSJID FROM GC_GCB_KFG A WHERE KGFG = '2') %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_WB_BD   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (T.KGTJZT='0' or T.KGTJZT is null) and T.XMID in (SELECT A.XDKID FROM GC_GCB_KFG A WHERE KGFG = '2') and T.GC_JH_SJ_ID not in (SELECT A.TCJHSJID FROM GC_GCB_KFG A WHERE KGFG = '2') %Condition%), \
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_WKG_ZX 			from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%),\
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_WKG_BD 			from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%),\
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_YKG_ZX 			from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%),\
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_YKG_BD 			from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.GC_JH_SJ_ID not IN (select K.TCJHSJID from GC_GCB_KFG K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (select XMID,count(distinct GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%),\
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_BFKG_ZX 		from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID IN (select K.XMID from WITH_WBKFG_BD K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%),\
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_BFKG_BD 		from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID IN (select K.XMID from WITH_WBKFG_BD K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is not null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%),\
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_BFKG_WKBD 		from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID IN (select K.XMID from WITH_WBKFG_BD K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.KGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%),\
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_YWG_ZX   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_YWG_BD   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_WKFG_ZJKNJZ_ZX   	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_ZJKNJZ_YB_BD   	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and WGSJ_SJ is not null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_ZJKNJZ_WB_BD   	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and WGSJ_SJ is null and (T.KGTJZT='0' or T.KGTJZT is null) %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_TGL_ZX   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (T.KGTJZT='0' or T.KGTJZT is null) and T.XMID in (SELECT A.XDKID FROM GC_GCB_KFG A WHERE KGFG = '2') %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_WKFG_TGL_YB_BD   	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (T.KGTJZT='0' or T.KGTJZT is null) and T.GC_JH_SJ_ID in (SELECT A.TCJHSJID FROM GC_GCB_KFG A WHERE KGFG = '2') %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_TGL_WB_BD     	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and (KGTJZT='0' or KGTJZT is null) and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (T.KGTJZT='0' or T.KGTJZT is null) and T.XMID in (SELECT A.XDKID FROM GC_GCB_KFG A WHERE KGFG = '2') and T.GC_JH_SJ_ID not in (SELECT A.TCJHSJID FROM GC_GCB_KFG A WHERE KGFG = '2') %Condition%) \

#工程部-履约保证金-统筹概况
GC_LYBZJ_TCGK=select * from \
(select count(qs.id) GC_LYBZJ_TCGK_CNT from gc_zjgl_lybzj qs where qs.sfyx = '1' %Condition%), \
(select count(distinct qs.xmid) GC_LYBZJ_TCGK_ZX from gc_zjgl_lybzj qs where qs.sfyx='1' %Condition%), \
(select count( distinct t.gc_jh_sj_id) GC_LYBZJ_TCGK_BD from gc_zjgl_lybzj qs, VIEW_GC_JH_SJ t where qs.sfyx = '1' and t.bdbs='1' and qs.jhsjid = t.gc_jh_sj_id %Condition%), \
(select count(qs.id) GC_LYBZJ_TCGK_SPTG from GC_ZJGL_LYBZJ QS where QS.sfyx = '1' and QS.fhqk='2' %Condition%), \
(select count(qs.id) GC_LYBZJ_TCGK_YFH  from GC_ZJGL_LYBZJ QS where QS.sfyx = '1' and QS.fhqk='6' %Condition%) \

#工程部-工程甩项-统筹概况
GC_GCSX_TCGK=select * from \
(select count(distinct t.gc_jh_sj_id) GC_GCSX_TCGK_CNT from GC_GCGL_GCSX qs, VIEW_GC_JH_SJ t where qs.sfyx = '1'  and qs.jhsjid=t.gc_jh_sj_id %Condition%), \
(select count(distinct t.xmid) GC_GCSX_TCGK_ZX from GC_GCGL_GCSX qs, VIEW_GC_JH_SJ t where qs.sfyx = '1'  and qs.xmid = t.xmid %Condition%), \
(select count(distinct t.gc_jh_sj_id) GC_GCSX_TCGK_BD from GC_GCGL_GCSX qs, VIEW_GC_JH_SJ t where QS.SFYX = '1' AND QS.JHSJID = T.GC_JH_SJ_ID AND T.BDBS='1' %Condition%), \
(select count(distinct t.gc_jh_sj_id) GC_GCSX_TCGK_YSP_CNT from GC_GCGL_GCSX qs, VIEW_GC_JH_SJ t,FS_EVENT E where qs.sfyx = '1'  and qs.jhsjid = t.gc_jh_sj_id and E.SJBH=QS.SJBH and E.SJZT='2' %Condition%), \
(select count(distinct t.xmid) GC_GCSX_TCGK_YSP_ZX from GC_GCGL_GCSX qs, VIEW_GC_JH_SJ t,FS_EVENT E where qs.sfyx = '1'  and qs.xmid = t.xmid and E.SJBH=QS.SJBH and E.SJZT='2' %Condition%), \
(select count(distinct t.gc_jh_sj_id) GC_GCSX_TCGK_YSP_BD from GC_GCGL_GCSX qs, VIEW_GC_JH_SJ t,FS_EVENT E where QS.SFYX = '1' AND QS.JHSJID = T.GC_JH_SJ_ID and E.SJBH=QS.SJBH and E.SJZT='2' AND T.BDBS='1' %Condition%) \

#已提报申请 子项、标段	GC_GCQS_TXFX_YTBSQ_ZX、GC_GCQS_TXFX_YTBSQ_BD
#审批完 子项、标段		GC_GCQS_TXFX_SPW_ZX、GC_GCQS_TXFX_SPW_BD
#审批中 子项、标段		GC_GCQS_TXFX_SPZ_ZX、GC_GCQS_TXFX_SPZ_BD
#工程部-工程洽商-图形分析
GC_GCQS_TXFX=select * from \
(select count(distinct t.gc_jh_sj_id) GC_GCQS_TXFX_YTBSQ_ZX from gc_gcgl_gcqs qs, fs_event event,VIEW_GC_JH_SJ t where qs.sjbh=event.sjbh and qs.sfyx='1'  and qs.jhsjid=t.gc_jh_sj_id and event.sjzt in ('1','2','7','8') AND T.XMBS='0' %Condition%), \
(select count(distinct t.gc_jh_sj_id) GC_GCQS_TXFX_YTBSQ_BD from gc_gcgl_gcqs qs, fs_event event,VIEW_GC_JH_SJ t where qs.sjbh=event.sjbh and qs.sfyx='1'  and qs.jhsjid=t.gc_jh_sj_id and event.sjzt in ('1','2','7','8') AND T.XMBS='1' %Condition%), \
(select count(distinct t.gc_jh_sj_id) GC_GCQS_TXFX_SPW_ZX from gc_gcgl_gcqs qs, fs_event event,VIEW_GC_JH_SJ t where qs.sjbh=event.sjbh and qs.sfyx='1'  and qs.jhsjid=t.gc_jh_sj_id and event.sjzt='2' AND T.XMBS='0' %Condition%), \
(select count(distinct t.gc_jh_sj_id) GC_GCQS_TXFX_SPW_BD from gc_gcgl_gcqs qs, fs_event event,VIEW_GC_JH_SJ t where qs.sjbh=event.sjbh and qs.sfyx='1'  and qs.jhsjid=t.gc_jh_sj_id and event.sjzt='2' AND T.XMBS='1' %Condition%), \
(select count(distinct t.gc_jh_sj_id) GC_GCQS_TXFX_SPZ_ZX from gc_gcgl_gcqs qs, fs_event event,VIEW_GC_JH_SJ t where qs.sjbh=event.sjbh and qs.sfyx='1'  and qs.jhsjid=t.gc_jh_sj_id and event.sjzt in ('1','7','8') AND T.XMBS='0' %Condition%), \
(select count(distinct t.gc_jh_sj_id) GC_GCQS_TXFX_SPZ_BD from gc_gcgl_gcqs qs, fs_event event,VIEW_GC_JH_SJ t where qs.sjbh=event.sjbh and qs.sfyx='1'  and qs.jhsjid=t.gc_jh_sj_id and event.sjzt in ('1','7','8') AND T.XMBS='1' %Condition%) \

#工程部-工程洽商-统筹概况
GC_GCQS_TCGK=select * from \
(select count(qs.gc_gcgl_gcqs_id) GC_GCQS_TCGK_CNT from gc_gcgl_gcqs qs where qs.sfyx = '1' %Condition%), \
(select count(distinct qs.xmid) GC_GCQS_TCGK_ZX from gc_gcgl_gcqs qs where qs.sfyx = '1' %Condition%), \
(select count(t.gc_jh_sj_id) GC_GCQS_TCGK_BD from gc_gcgl_gcqs qs, VIEW_GC_JH_SJ t where QS.SFYX = '1' AND QS.JHSJID = T.GC_JH_SJ_ID AND T.BDBS = '1' %Condition%), \
(select TO_CHAR(nvl(sum(qs.gszj),0), 'FM99999999999990.00') GC_GCQS_TCGK_QZJE from gc_gcgl_gcqs qs where qs.sfyx = '1' %Condition%) ,\
(select count(qs.gc_gcgl_gcqs_id) GC_GCQS_TCGK_SPTG_CNT from gc_gcgl_gcqs qs, fs_event e where qs.sjbh=e.sjbh and e.sjzt='2' AND qs.sfyx='1' %Condition%), \
(SELECT count(distinct qs.xmid) GC_GCQS_TCGK_SPTG_ZX from gc_gcgl_gcqs qs, fs_event e where qs.sjbh=e.sjbh and e.sjzt='2' and qs.sfyx = '1' %Condition%), \
(select count(t.gc_jh_sj_id) GC_GCQS_TCGK_SPTG_BD from gc_gcgl_gcqs qs, fs_event e, view_gc_jh_sj t where qs.sjbh=e.sjbh and e.sjzt='2' and qs.jhsjid=t.gc_jh_sj_id and t.BDBS='1' AND qs.sfyx='1' %Condition%), \
(select TO_CHAR(nvl(sum(qs.gszj),0), 'FM99999999999990.00') GC_GCQS_TCGK_SPTG_QZJE from gc_gcgl_gcqs qs, fs_event e where qs.sjbh=e.sjbh and e.sjzt='2' AND qs.sfyx='1' %Condition%) \

GC_GCGL_TCGK1=\
WITH  \
 WITH_YBKFG_XM as (select XMID, GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.XMID in (select K.XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0', '1')) and T.ISKGSJ='1' and XMBS = '0' %Condition%) \
,WITH_WBKFG_XM as (select XMID, GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.XMID not in (select K.XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0', '1')) and T.ISKGSJ='1' and XMBS = '0' %Condition% ) \
,WITH_WBKFG_BD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.ISKGSJ='1' and XMID not in (select XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0','1')) and BDBS='1' %Condition%) \
,WITH_YBKFG_BD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.ISKGSJ='1' and GC_JH_SJ_ID in (select TCJHSJID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0','1')) and BDBS='1' %Condition%) \
,WITH_YBKFG_WKBD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.ISKGSJ='1' and GC_JH_SJ_ID not in (select TCJHSJID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0','1')) and XMID in (select XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0','1')) and BDBS='1' %Condition%) \
SELECT * FROM \
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_ZX 				from WITH_WBKFG_XM T), \
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_BD 				from WITH_WBKFG_BD T), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_BYKFG_ZX       		from WITH_YBKFG_XM T),\
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_BYKFG_BD       		from WITH_YBKFG_BD T),\
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_BYKFG_WKBD       	from WITH_YBKFG_WKBD T),\
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_JGZXFZ_ZX   			FROM VIEW_GC_JH_SJ T  WHERE T.XMBS='0' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_JGZXFZ_BD   			FROM VIEW_GC_JH_SJ T  WHERE T.BDBS='1' %Condition%) \

GC_GCGL_TCGK2=\
WITH  \
 WITH_YBKFG_XM as (select XMID, GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.XMID in (select K.XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0', '1')) and T.ISKGSJ='1' and XMBS = '0' %Condition%) \
,WITH_YBKFG_QBBD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.ISKGSJ='1' and T.XMID in (select K.XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0', '1')) and BDBS='1'  %Condition%) \
SELECT * FROM \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_WKG_ZX       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and KGSJ_SJ is null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and T.ISKGSJ='1' %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_WKG_BD       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and KGSJ_SJ is null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is null and T.ISKGSJ='1' %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_YKG_ZX       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and KGSJ_SJ is not null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and T.ISKGSJ='1' %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_YKG_BD       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and KGSJ_SJ is not null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is not null and T.ISKGSJ='1' %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_BFKG_ZX       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and  KGSJ_SJ is null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and T.ISKGSJ='1' %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_BFKG_BD       	from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and KGSJ_SJ is not null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is not null and T.ISKGSJ='1' %Condition%), \
(select count(distinct T.GC_JH_SJ_ID)             	GCGL_KFGGL_YKFG_BFKG_WKBD       from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and KGSJ_SJ is null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_YBKFG_QBBD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is null and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_YKFG_YWG_ZX   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_YWG_BD   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' %Condition%) \

GC_GCGL_TCGK3=\
WITH  \
 WITH_YBKFG_XM as (select XMID, GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.XMID in (select K.XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0', '1')) and T.ISKGSJ='1' and XMBS = '0' %Condition%) \
,WITH_YBKFG_QBBD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.ISKGSJ='1' and T.XMID in (select K.XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0', '1')) and BDBS='1'  %Condition%) \
SELECT * FROM \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_ZJKNJZ_ZX   	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_YKFG_ZJKNJZ_ZX_YWBD 	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and WGSJ_SJ is not null and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)  				GCGL_KFGGL_YKFG_ZJKNJZ_ZX_WWBD 	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and WGSJ_SJ is null and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_TGL_ZX   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_YB_BD   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' and T.GC_JH_SJ_ID in (SELECT K.TCJHSJID FROM GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG = '2') %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_WB_BD   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_YBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_YBKFG_QBBD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' and T.GC_JH_SJ_ID not in (SELECT K.TCJHSJID FROM GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG = '2') %Condition%) \

GC_GCGL_TCGK4=\
WITH  \
WITH_WBKFG_XM as (select XMID, GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.XMID not in (select K.XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0', '1')) and T.ISKGSJ='1' and XMBS = '0' %Condition% ) \
,WITH_WBKFG_BD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.ISKGSJ='1' and XMID not in (select XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0','1')) and BDBS='1' %Condition%) \
SELECT * FROM \
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_WKG_ZX 			from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and  KGSJ_SJ is null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and T.ISKGSJ='1' %Condition%),\
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_WKG_BD 			from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and  KGSJ_SJ is null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is null and T.ISKGSJ='1' %Condition%),\
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_YKG_ZX 			from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and  KGSJ_SJ is not null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and T.ISKGSJ='1' %Condition%) \

GC_GCGL_TCGK5=\
SELECT * FROM \
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_YKG_BD 			from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.GC_JH_SJ_ID not IN (select K.TCJHSJID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0','1')) %Condition% and ISKGSJ='1' and BDBS='1' and KGSJ_SJ is not null GROUP BY T.XMID) A, (select XMID,count(distinct GC_JH_SJ_ID) BDZS from (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.ISKGSJ='1' and XMID not in (select XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0','1')) and BDBS='1' %Condition%) group by XMID) B WHERE A.XMID = B.XMID and BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and T.ISKGSJ='1' %Condition%)\

GC_GCGL_TCGK6=\
WITH  \
WITH_WBKFG_XM as (select XMID, GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.XMID not in (select K.XDKID from GC_GCB_KFG  K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0', '1')) and T.ISKGSJ='1' and XMBS = '0' %Condition% ) \
,WITH_WBKFG_BD as (select XMID,GC_JH_SJ_ID from VIEW_GC_JH_SJ T where T.ISKGSJ='1' and XMID not in (select XDKID from GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG in ('0','1')) and BDBS='1' %Condition%) \
SELECT * FROM \
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_BFKG_ZX 		from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID IN (select K.XMID from WITH_WBKFG_BD K) %Condition% and ISKGSJ='1' and BDBS='1' and KGSJ_SJ is null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and T.ISKGSJ='1' %Condition%), \
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_BFKG_BD 		from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID IN (select K.XMID from WITH_WBKFG_BD K) %Condition% and ISKGSJ='1' and BDBS='1' and KGSJ_SJ is not null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is not null and T.ISKGSJ='1' %Condition%),\
(select count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_BFKG_WKBD 		from (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID IN (select K.XMID from WITH_WBKFG_BD K) %Condition% and ISKGSJ='1' and BDBS='1' and KGSJ_SJ is null GROUP BY T.XMID) A, (select XMID,count(GC_JH_SJ_ID) BDZS from WITH_WBKFG_BD group by XMID) B WHERE A.XMID = B.XMID and BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and KGSJ_SJ is null and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_YWG_ZX   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_YWG_BD   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0  and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_WKFG_ZJKNJZ_ZX   	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_ZJKNJZ_YB_BD   	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)>0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and WGSJ_SJ is not null and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_ZJKNJZ_WB_BD   	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and WGSJ_SJ is null and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_TGL_ZX   		FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.XMBS='0' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID)				GCGL_KFGGL_WKFG_TGL_YB_BD   	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' and T.GC_JH_SJ_ID in (SELECT K.TCJHSJID FROM GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG = '2') %Condition%), \
(SELECT count(distinct T.GC_JH_SJ_ID) 				GCGL_KFGGL_WKFG_TGL_WB_BD     	FROM (SELECT A.XMID FROM (SELECT T.XMID, COUNT(T.GC_JH_SJ_ID) BDS FROM VIEW_GC_JH_SJ T WHERE T.XMID  IN (select K.XMID from WITH_WBKFG_XM K) %Condition% and ISKGSJ='1' and BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ X where X.SJWYBH=T.SJWYBH and X.WGSJ_SJ is not null)=0 GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDZS, T.XMID FROM WITH_WBKFG_BD T GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND BDS<=BDZS) S,VIEW_GC_JH_SJ T where S.XMID=T.XMID and T.BDBS='1' and (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ SS where SS.XMID=T.XMID and KGSJ_SJ is not null)>0 and T.ISKGSJ='1' and T.GC_JH_SJ_ID not in (SELECT K.TCJHSJID FROM GC_GCB_KFG K,FS_EVENT E where E.SJBH=K.SJBH and E.SJZT='2' and KGFG = '2') %Condition%) \

GC_GCGL_TCGK7=\
SELECT * FROM \
(SELECT sum(decode(FUN_TJ_WCQK_ZX(GC_JH_SJ_ID,'ISSGDW','SGDW_SJ'),1,1,0)) 			GCGL_KFGGL_YQDSGDW_ZX   		FROM VIEW_GC_JH_SJ T  WHERE XMBS='0' %Condition%), \
(SELECT NVL(COUNT(DISTINCT T.SJWYBH), 0) 			GCGL_KFGGL_YQDSGDW_BD   		FROM VIEW_GC_JH_SJ T  WHERE T.SJWYBH IN (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE 1=1 %Condition% AND (T.XMBS = '1' OR (T.XMBS = '0' AND T.ISNOBDXM = '1')))    AND T.SGDW_SJ IS NOT NULL), \
(SELECT NVL(COUNT(T.GC_JH_SJ_ID), '0') 				GCGL_KFGGL_ZBJBKGTJ_ZX   		FROM VIEW_GC_JH_SJ T  WHERE T.ISKGSJ = '0' %Condition% AND T.XMBS = '0'), \
(SELECT NVL(COUNT(T.GC_JH_SJ_ID), '0') 				GCGL_KFGGL_ZBJBKGTJ_BD   		FROM VIEW_GC_JH_SJ T  WHERE T.ISKGSJ = '0' %Condition% AND (T.XMBS = '1' OR (T.XMBS = '0' AND T.ISNOBDXM = '1'))), \
(SELECT NVL(COUNT(T.GC_JH_SJ_ID), '0')       		GCGL_KFGGL_JBKGTJ_ZX       		FROM VIEW_GC_JH_SJ T  WHERE T.XMBS = '0' %Condition% AND T.ISKGSJ = '1'), \
(SELECT NVL(COUNT(T.GC_JH_SJ_ID), '0') 				GCGL_KFGGL_JBKGTJ_BD 			FROM VIEW_GC_JH_SJ T  WHERE T.BDBS = '1' %Condition% AND T.ISKGSJ = '1'), \
(SELECT COUNT(distinct DXID)		ZBGL_TJGK_JGZX_DX FROM VIEW_GC_JH_DX T where T.DXID is not null %Condition%), \
(SELECT NVL(COUNT(GC_JH_SJ_ID), 0) 	ZBGL_TJGK_JGZX_ZX FROM VIEW_GC_JH_SJ T WHERE XMBS='0' %Condition%), \
(SELECT COUNT(distinct DXID) 		ZBGL_TJGK_XINJ_DX FROM VIEW_GC_JH_DX T,GC_CJJH C where T.DXID=C.GC_CJJH_ID and T.DXID is not null and C.XMXZ='0' %Condition%), \
(SELECT NVL(COUNT(GC_JH_SJ_ID), 0) 	ZBGL_TJGK_XINJ_ZX FROM VIEW_GC_JH_SJ T WHERE XMBS='0' AND XMXZ='0' %Condition%), \
(SELECT count(distinct DXID) 		ZBGL_TJGK_XUJ_DX  FROM VIEW_GC_JH_DX T,GC_CJJH C where T.DXID=C.GC_CJJH_ID and T.DXID is not null and C.XMXZ='1' %Condition%), \
(SELECT COUNT(GC_JH_SJ_ID) 			ZBGL_TJGK_XUJ_ZX  FROM VIEW_GC_JH_SJ T WHERE XMBS='0' AND XMXZ='1' %Condition%), \
(SELECT COUNT(DISTINCT T.XMID) 						GCGL_KFGGL_YKFG_ZX 				FROM VIEW_GC_JH_SJ T WHERE T.KGSJ_SJ IS NOT NULL AND BDBS='1' %Condition%), \
(SELECT COUNT(DISTINCT T.GC_JH_SJ_ID) 				GCGL_KFGGL_YKFG_BD  			FROM VIEW_GC_JH_SJ T WHERE T.KGSJ_SJ IS NOT NULL AND BDBS='1' %Condition%), \
(SELECT NVL(SUM(ZS), '0') 							GCGL_KFGGL_YWG_ZX   			FROM (SELECT COUNT(A.XMID) ZS FROM (SELECT COUNT(T.GC_JH_SJ_ID) ZS, T.XMID FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL AND T.ISWGSJ = '1' %Condition% AND T.XMBS = '1' GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE T.XMBS = '1' %Condition% AND T.ISWGSJ = '1' GROUP BY T.XMID) B WHERE A.XMID = B.XMID AND A.ZS = BDS UNION ALL SELECT COUNT(T.GC_JH_SJ_ID) ZS FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL %Condition% AND T.XMBS = '0' AND T.ISNOBDXM = '1' GROUP BY T.XMID)), \
(SELECT NVL(SUM(ZS), '0') 							GCGL_KFGGL_YWG_BD   			FROM (SELECT COUNT(T.GC_JH_SJ_ID) ZS FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL %Condition% AND T.XMBS = '1' UNION ALL  SELECT COUNT(T.GC_JH_SJ_ID) ZS FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL %Condition% AND T.XMBS = '0' AND T.ISNOBDXM = '1' GROUP BY T.XMID)) \

#进度管理
GC_JDGL_TCGK=select * from  \
/*应开工未开工xx子项xx标段  子项标段有一个开工就算一个子项。计划时间是今天之前的还没实际开工时间的。*/ \
(SELECT COUNT(DISTINCT T.XMID) YKGWKG_ZX        FROM   VIEW_GC_JH_SJ T WHERE T.KGSJ <=TRUNC(SYSDATE) AND T.KGSJ_SJ IS  NULL AND BDBS='1' %Condition% \
AND T.XMID NOT IN (SELECT DISTINCT T.XMID FROM VIEW_GC_JH_SJ T WHERE T.KGSJ_SJ IS NOT NULL AND BDBS='1' %Condition% AND T.XMID IS NOT NULL)), \
(SELECT COUNT(DISTINCT T.GC_JH_SJ_ID) YKGWKG_BD FROM   VIEW_GC_JH_SJ T WHERE T.KGSJ <=TRUNC(SYSDATE) AND T.KGSJ_SJ IS  NULL AND BDBS='1' %Condition%), \
/*已开（复）工xx子项xx标段   子项标段有一个开工就算一个子项。*/ \
(SELECT COUNT(DISTINCT T.XMID) YKG_ZX FROM VIEW_GC_JH_SJ T WHERE T.KGSJ_SJ IS NOT NULL AND BDBS='1' %Condition%), \
/*延期开（复）工xx子项xx标段 有一个标段延期开工就算一个子项*/ \
(SELECT COUNT(DISTINCT T.XMID) YQKG_ZX        FROM VIEW_GC_JH_SJ T WHERE T.KGSJ_SJ>T.KGSJ AND BDBS='1' %Condition%), \
(SELECT COUNT(DISTINCT T.GC_JH_SJ_ID) YKG_BD  FROM VIEW_GC_JH_SJ T WHERE T.KGSJ_SJ IS NOT NULL AND BDBS='1' %Condition%), \
(SELECT COUNT(DISTINCT T.GC_JH_SJ_ID) YQKG_BD  FROM VIEW_GC_JH_SJ T WHERE T.KGSJ_SJ>T.KGSJ AND BDBS='1' %Condition%), \
/*已完工xx子项xx标段  所有的标段都完工子项加1*/ \
(SELECT   COUNT(DISTINCT T.XMID) YWG_ZX FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL AND BDBS='1' %Condition% AND T.XMID NOT IN  \
(SELECT DISTINCT T.XMID FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS  NULL AND T.ISWGSJ='1' AND BDBS='1' %Condition% AND  T.XMID IS NOT NULL)), \
(SELECT   COUNT(DISTINCT T.GC_JH_SJ_ID) YWKG_BD FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL AND BDBS='1' %Condition% ), \
/*其中延期完工xx子项xx标段。所有的标段都完工子项加1 有一个延期完工就算一个子项*/ \
(SELECT   COUNT(DISTINCT T.XMID) YQWG_ZX FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL AND BDBS='1' %Condition% AND T.XMID NOT IN  \
(SELECT DISTINCT T.XMID FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS  NULL AND T.ISWGSJ='1' AND BDBS='1' %Condition% AND  T.XMID IS NOT NULL) \
AND T.WGSJ_SJ>T.WGSJ), \
(SELECT   COUNT(DISTINCT T.GC_JH_SJ_ID) YQWG_BD FROM VIEW_GC_JH_SJ T WHERE T.WGSJ_SJ IS NOT NULL AND BDBS='1' %Condition% AND T.WGSJ_SJ>T.WGSJ) \


GC_JDGL_PIE1=SELECT '正常开工' LABEL, COUNT( T.GC_JH_SJ_ID) VALUE FROM VIEW_GC_JH_SJ T, GC_XMGLGS_XXJD_JHBZ A WHERE A.JHSJID = T.GC_JH_SJ_ID %Condition% AND BDBS = '1' AND T.KGSJ_SJ <= T.KGSJ  AND T.KGSJ_SJ IS NOT NULL AND T.KGSJ IS NOT NULL  %conditionXmlx% \
UNION ALL  \
SELECT '延期开工' LABEL,COUNT( T.GC_JH_SJ_ID) VALUE FROM VIEW_GC_JH_SJ T, GC_XMGLGS_XXJD_JHBZ A WHERE A.JHSJID = T.GC_JH_SJ_ID %Condition% AND BDBS = '1' AND T.KGSJ_SJ > T.KGSJ  AND T.KGSJ_SJ IS NOT NULL AND T.KGSJ IS NOT NULL %conditionXmlx%


GC_JDGL_PIE2=SELECT  '正常未开工' LABEL, COUNT( T.GC_JH_SJ_ID) VALUE FROM VIEW_GC_JH_SJ T, GC_XMGLGS_XXJD_JHBZ A WHERE A.JHSJID = T.GC_JH_SJ_ID %Condition% AND BDBS = '1' AND TRUNC(SYSDATE) <= T.KGSJ  AND T.KGSJ_SJ IS  NULL AND T.KGSJ IS NOT NULL  %conditionXmlx% \
UNION ALL  \
SELECT  '延期未开工' LABEL,COUNT( T.GC_JH_SJ_ID) VALUE FROM VIEW_GC_JH_SJ T, GC_XMGLGS_XXJD_JHBZ A WHERE A.JHSJID = T.GC_JH_SJ_ID %Condition% AND BDBS = '1' AND TRUNC(SYSDATE) > T.KGSJ AND T.KGSJ_SJ IS  NULL AND T.KGSJ IS NOT NULL  %conditionXmlx% \

