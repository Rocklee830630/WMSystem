#--年度计划XX子项统筹计划里有施工图是否办理的值为“是”当前年的  NDJH_ZX--
#--可研报告编制情况XX子项同年度计划 KYBGBZ_ZX--
#--已编制可研报告XX子项--计划表立项可研实际时间有值的，或者续建项目的旧项目立项可研实际时间有值的 YBZKYBG--
#--未编制可研报告XX子项  立项可研实际时间点为空值的，并且续建项目的原项目立项可研实际时间点也为空值的 WBZKYBG--
#--其他单位负责00子项
#--建管中心负责 同建管中心共负责XX项
#--已招XX子项--全招标的和部分招的--------子项根据标段 ZBZX--
#--未招标XX标段 已招XX子项部分招标中未招标的标段数 WZBBD--
#--已招标XX标段 已招XX子项部分招标中和全招标未招标的标段数 YZBZX--
#--未招XX表段 所有标段都没找的项目的标段 WZBBDQB--
#--未完成初设 前一条件下，项目计划表初步设计批复实际时间值为空的，考虑续建 WWCCBSJPH--
#--已完成初设 YWCCBSJPF--
#--未招XX子项 所有标段都没找的项目 WZBZX--

#未完成送审版XX子项只算项目的。WWCSSB--
#已完成送审版 前一条件下考虑续建 YWCSSB--
#未完成正式版#考虑续建 所有的都未完成 WWCZSB--
#未完正式版 标段 WWCZSB_BD--
#已完成正式版 考虑续建 标段有一个完成正式版。 YWCZSB--
#标段  YWCZSB_BD--
#部分完成正式版 考虑续建 标段有部分完成正式版。BFWCZSB--
#部分完成正式版已完标段 BFCZSB_YWBD--
#部分完成正式版未完标段 BFCZSB_WWBD--
#已完拆迁图XX标段 YWCQT_BD--
#设计管理-图形分析
SJ_SJGL_TXFX=\
SELECT * FROM \
(SELECT NVL(COUNT(DISTINCT T.XMID),0)  			ZBZX        	FROM VIEW_GC_JH_SJ T  WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH  FROM GC_ZTB_JHSJ B, GC_ZTB_XQ C, GC_ZTB_XQSJ_YS D, VIEW_GC_JH_SJ T WHERE D.ZTBXQID = C.GC_ZTB_XQ_ID AND B.XQID = C.GC_ZTB_XQ_ID AND T.GC_JH_SJ_ID = B.JHSJID AND C.ZBLX = '11' AND C.XQZT = '6'  %glNdCon%) %Condition%) A,\
(SELECT NVL(COUNT(DISTINCT T.XMID),0)  			WWCCBSJPH   	FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH NOT IN (SELECT DISTINCT A.SJWYBH  FROM VIEW_GC_JH_SJ A   WHERE A.CBSJPF_SJ IS NOT NULL) %Condition% AND T.XMBS = '0') B,\
(SELECT NVL(COUNT(DISTINCT T.XMID),0)  			YWCCBSJPF   	FROM VIEW_GC_JH_SJ T  WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH  FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T  WHERE T.XMBS = '0' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.CBSJPF_SJ IS NOT NULL AND T.XMBS = '0' %glNdCon%) %Condition% AND T.XMBS = '0') C,\
(SELECT NVL(COUNT(DISTINCT T.XMID),0)  			WWCSSB 	   		FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH NOT IN (SELECT DISTINCT A.SJWYBH  FROM GC_SJ A  WHERE A.WCSJ_SGT_SSB IS NOT NULL and SJWYBH is not null) %Condition% AND T.XMBS = '0')D,\
(SELECT NVL(COUNT(DISTINCT T.XMID),0)  			YWCSSB 	   		FROM VIEW_GC_JH_SJ T, GC_SJ A  WHERE A.SJWYBH = T.SJWYBH  AND A.WCSJ_SGT_SSB IS NOT NULL %Condition% AND T.XMBS = '0')E,\
(SELECT NVL(COUNT(DISTINCT A.XMID),0)  			WWCZSB			FROM (SELECT COUNT(T.GC_JH_SJ_ID) WCBDS, XMID FROM VIEW_GC_JH_SJ T  WHERE 1=1 %Condition% AND T.SJWYBH NOT IN (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.SGT_SJ IS NOT NULL AND T.BDBS = '1' %glNdCon%)  AND T.BDBS = '1' GROUP BY T.XMID) A, (SELECT COUNT(T.GC_JH_SJ_ID) BDS, XMID FROM VIEW_GC_JH_SJ T   WHERE 1 = 1 %Condition% AND T.ISSGT = '1' AND T.BDBS = '1'  GROUP BY T.XMID) B  WHERE A.XMID = B.XMID  AND A.WCBDS >= BDS)F,\
(SELECT NVL(SUM(A.WCBDS), 0) 					WWCZSB_BD 		FROM (SELECT COUNT(T.GC_JH_SJ_ID) WCBDS, XMID FROM VIEW_GC_JH_SJ T  WHERE 1=1 %Condition% AND T.SJWYBH NOT IN (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.SGT_SJ IS NOT NULL AND T.BDBS = '1'  %glNdCon%) AND T.BDBS = '1' GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID FROM VIEW_GC_JH_SJ T   WHERE 1 = 1 %Condition% AND T.ISSGT = '1' AND T.BDBS = '1'  GROUP BY T.XMID) B  WHERE A.XMID = B.XMID  AND A.WCBDS >= BDS)G,\
(SELECT NVL(COUNT(DISTINCT A.XMID),0) 			YWCZSB			FROM (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN  (SELECT DISTINCT T.SJWYBH FROM VIEW_GC_JH_SJ T,(SELECT T.SJWYBH  FROM VIEW_GC_JH_SJ T WHERE T.BDBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH  AND T.SGT_SJ IS NOT NULL %glNdCon%) %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE 1 = 1 %Condition% AND T.BDBS = '1'  GROUP BY T.XMID) B WHERE A.XMID = B.XMID AND A.BDWCS >= BDS) H,\
(SELECT NVL(SUM(A.BDWCS),0) 					YWCZSB_BD 		FROM (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH  FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T   WHERE T.BDBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH  AND T.SGT_SJ IS NOT NULL %glNdCon%) %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE 1 = 1 %Condition% AND T.BDBS = '1' GROUP BY T.XMID) B WHERE A.XMID = B.XMID AND A.BDWCS >= BDS)I,\
(SELECT NVL(COUNT(A.XMID),0) 					BFWCZSB 		FROM (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T  WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH  FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH  FROM VIEW_GC_JH_SJ T WHERE T.XMBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.SGT_SJ IS NOT NULL %glNdCon%)  %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE 1 = 1 %Condition% AND T.XMBS = '1' GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND A.BDWCS < BDS)J,\
(SELECT NVL(SUM(A.BDWCS),0) 					BFCZSB_YWBD 	FROM (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN  (SELECT DISTINCT T.SJWYBH  FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH  FROM VIEW_GC_JH_SJ T  WHERE T.XMBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.SGT_SJ IS NOT NULL %glNdCon%) %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID  FROM VIEW_GC_JH_SJ T   WHERE 1 = 1 %Condition% AND T.XMBS = '1'  GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND A.BDWCS < BDS)K,\
(SELECT NVL(SUM(B.BDS),0)-NVL(SUM(A.BDWCS),0) 	BFCZSB_WWBD 	FROM (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN  (SELECT DISTINCT T.SJWYBH  FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.XMBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.SGT_SJ IS NOT NULL %glNdCon%)  %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID  FROM VIEW_GC_JH_SJ T WHERE 1 = 1 %Condition% AND T.XMBS = '1' GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND A.BDWCS < BDS)L,\
(SELECT NVL(SUM(A.BDWCS),0) 					YWCQT_BD  		FROM (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN  (SELECT DISTINCT T.SJWYBH  FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.BDBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.CQT_SJ IS NOT NULL %glNdCon%)  %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID  FROM VIEW_GC_JH_SJ T WHERE 1 = 1 %Condition% AND T.BDBS = '1' GROUP BY T.XMID) B  WHERE A.XMID = B.XMID AND A.BDWCS >= BDS) M, \
(SELECT NVL(COUNT(DISTINCT T.XMID),0)  			WWCSGTSCBA 	   	FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH NOT IN (SELECT DISTINCT A.SJWYBH from GC_SJ_ZLSF_JS A  WHERE A.tzlb ='6' and SJWYBH is not null) %Condition% AND T.XMBS = '0')N,\
(SELECT NVL(COUNT(DISTINCT T.XMID),0)  			YWCSGTSCBA 	   	FROM VIEW_GC_JH_SJ T, GC_SJ_ZLSF_JS A  WHERE A.SJWYBH = T.SJWYBH and A.tzlb ='6'  %Condition% AND T.XMBS = '0')O,\
(SELECT NVL(COUNT(DISTINCT T.XMID),0)  			WWCGHTJ 	   	FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH NOT IN (SELECT DISTINCT A.SJWYBH from  GC_SJ_ZLSF_JS A  WHERE A.tzlb ='0' and SJWYBH is not null) %Condition% AND T.XMBS = '0')P,\
(SELECT NVL(COUNT(DISTINCT T.XMID),0)  			YWCGHTJ 	   	FROM VIEW_GC_JH_SJ T, GC_SJ_ZLSF_JS A  WHERE A.SJWYBH = T.SJWYBH and A.tzlb ='0'  %Condition% AND T.XMBS = '0')Q \

SJ_SJGL_TXFX_NEW1=SELECT * FROM \
(SELECT NVL(COUNT(T.GC_JH_SJ_ID),0) 			NDJH_ZX 					FROM VIEW_GC_JH_SJ T WHERE T.XMBS='0' %Condition%), \
(SELECT NVL(COUNT(T.GC_JH_SJ_ID),0) 			KYBGBZ_ZX 					FROM VIEW_GC_JH_SJ T WHERE T.XMBS='0' %Condition%) \

SJ_SJGL_TXFX_NEW2=SELECT * FROM \
(SELECT NVL(COUNT(DISTINCT T.SJWYBH),0) 		YBZKYBG 					FROM VIEW_GC_JH_SJ T ,(SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.XMBS='0' %Condition%)  A WHERE  T.SJWYBH=A.SJWYBH AND T.KYPF_SJ IS NOT  NULL AND T.XMBS='0' %glNdCon%), \
(SELECT NVL(COUNT(A.SJWYBH),0) 					WBZKYBG 					FROM (SELECT COUNT(T.GC_JH_SJ_ID) WCS,  T.SJWYBH FROM VIEW_GC_JH_SJ T ,(SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.XMBS='0' AND T.KYPF_SJ IS NULL %Condition%)  A WHERE  T.SJWYBH=A.SJWYBH AND T.KYPF_SJ IS   NULL AND T.XMBS='0' %glNdCon% GROUP BY T.SJWYBH)A,(SELECT COUNT(T.GC_JH_SJ_ID) ZS, T.SJWYBH FROM VIEW_GC_JH_SJ T ,(SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.XMBS='0' AND T.KYPF_SJ IS   NULL %Condition%)  A WHERE  T.SJWYBH=A.SJWYBH  AND T.XMBS='0' %glNdCon% GROUP BY T.SJWYBH) B WHERE  A.SJWYBH=B.SJWYBH AND A.WCS>=B.ZS), \
(SELECT NVL(SUM(ZS)-SUM(WCS),0) 				WZBBD 						FROM (SELECT COUNT(T.GC_JH_SJ_ID) WCS,T.XMID FROM (SELECT *   FROM VIEW_GC_JH_SJ T  WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH  FROM GC_ZTB_JHSJ B, GC_ZTB_XQ C, GC_ZTB_XQSJ_YS D, VIEW_GC_JH_SJ T WHERE D.ZTBXQID = C.GC_ZTB_XQ_ID AND B.XQID = C.GC_ZTB_XQ_ID AND T.GC_JH_SJ_ID = B.JHSJID AND C.ZBLX = '11' AND C.XQZT in ('6')  %glNdCon%)    AND BDBS = '1'  %Condition%) T  GROUP BY T.XMID)A, (SELECT  COUNT(T.GC_JH_SJ_ID) ZS,T.XMID  FROM VIEW_GC_JH_SJ T WHERE T.BDBS='1' %Condition% GROUP BY T.XMID) B WHERE A.XMID=B.XMID)  \

SJ_SJGL_TXFX_NEW3=SELECT * FROM \
(SELECT NVL(COUNT(DISTINCT T.GC_JH_SJ_ID),0) 	YZBBD 						FROM (SELECT *   FROM VIEW_GC_JH_SJ T  WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH  FROM GC_ZTB_JHSJ B, GC_ZTB_XQ C, GC_ZTB_XQSJ_YS D, VIEW_GC_JH_SJ T WHERE D.ZTBXQID = C.GC_ZTB_XQ_ID AND B.XQID = C.GC_ZTB_XQ_ID AND T.GC_JH_SJ_ID = B.JHSJID AND C.ZBLX = '11' AND C.XQZT = '6'  %glNdCon%)    AND BDBS = '1' %Condition%) T ), \
(SELECT NVL(ZS-WCS,0) 							WZBZX 						FROM (SELECT  COUNT(DISTINCT T.XMID) WCS FROM  (SELECT *   FROM VIEW_GC_JH_SJ T  WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH  FROM GC_ZTB_JHSJ B, GC_ZTB_XQ C, GC_ZTB_XQSJ_YS D, VIEW_GC_JH_SJ T WHERE D.ZTBXQID = C.GC_ZTB_XQ_ID AND B.XQID = C.GC_ZTB_XQ_ID AND T.GC_JH_SJ_ID = B.JHSJID AND C.ZBLX = '11' AND C.XQZT = '6'  %glNdCon%) %Condition%) T)A, (SELECT COUNT(T.GC_JH_SJ_ID) ZS FROM VIEW_GC_JH_SJ T WHERE 1=1 %Condition% AND XMBS='0') B), \
(SELECT NVL(COUNT(T.GC_JH_SJ_ID),0) 			WZBBDQB 					FROM VIEW_GC_JH_SJ T WHERE T.XMID NOT IN (SELECT DISTINCT T.XMID  FROM  (SELECT *   FROM VIEW_GC_JH_SJ T  WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH  FROM GC_ZTB_JHSJ B, GC_ZTB_XQ C, GC_ZTB_XQSJ_YS D, VIEW_GC_JH_SJ T WHERE D.ZTBXQID = C.GC_ZTB_XQ_ID AND B.XQID = C.GC_ZTB_XQ_ID AND T.GC_JH_SJ_ID = B.JHSJID AND C.ZBLX = '11' AND C.XQZT in ('6')  %glNdCon%)    AND BDBS = '1' %Condition%) T ) AND BDBS='1' %Condition%) \


#--创建临时表，桥梁类
SJ_SJGL_QLL=with WITH_JJG as (select A.*,B.JU_KSRQ,B.JU_SFBZJZ,B.JU_JBYSTJ,B.JU_SFZZYS,B.JU_YSQK,B.JU_SFZLCD,B.JU_SFZJZBA,B.JA_KSRQ from VIEW_GC_JH_SJ A,GC_SJGL_JJG B where A.GC_JH_SJ_ID=B.JHSJID and XMLX='3')\
select * from\
(select count(GC_JH_SJ_ID) QLL_YWG 		from VIEW_GC_JH_SJ T where XMLX='3' and BDBS='1' and T.WGSJ_SJ is not null %Condition%),\
(select count(GC_JH_SJ_ID) QLL_YTJ 		from VIEW_GC_JH_SJ T where XMLX='3' and BDBS='1' and T.WGSJ_SJ is not null and TBJJG='1' %Condition%),\
(select count(GC_JH_SJ_ID) QLL_WTJ 		from VIEW_GC_JH_SJ T where XMLX='3' and BDBS='1' and T.WGSJ_SJ is not null and (TBJJG != '1'OR TBJJG IS  NULL) %Condition%),\
(select count(GC_JH_SJ_ID) QLL_ZGB 		from VIEW_GC_JH_SJ T where XMLX='3' and BDBS='1' and T.WGSJ_SJ is not null and TBJJG='1' %Condition%),\
(select count(GC_JH_SJ_ID) QLL_BZJZ  	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' %Condition%),\
(select count(GC_JH_SJ_ID) QLL_WBZJZ  	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and (JU_SFBZJZ != '1'OR JU_SFBZJZ IS  NULL) %Condition%),\
(select count(GC_JH_SJ_ID) QLL_JBYSTJ  	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ='1' %Condition%),\
(select count(GC_JH_SJ_ID) QLL_BJBYSTJ  from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and (JU_JBYSTJ != '1'OR JU_JBYSTJ IS  NULL) %Condition%),\
(select count(GC_JH_SJ_ID) QLL_ZZJGYS  	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ = '1' and T.JU_SFZZYS='1' %Condition%),\
(select count(GC_JH_SJ_ID) QLL_WZZJGYS  from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ = '1' and (JU_SFZZYS != '1'OR JU_SFZZYS IS  NULL)  %Condition%),\
(select count(GC_JH_SJ_ID) QLL_YSHG  	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ = '1' and T.JU_SFZZYS='1' and T.JU_YSQK='1' %Condition%),\
(select count(GC_JH_SJ_ID) QLL_JBZJ  	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ = '1' and T.JU_SFZZYS='1' and T.JU_YSQK='2' %Condition%),\
(select count(GC_JH_SJ_ID) QLL_ZZZG  	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ = '1' and T.JU_SFZZYS='1' and T.JU_YSQK='3' %Condition%),\
(select count(GC_JH_SJ_ID) QLL_ZLCD  	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ = '1' and T.JU_SFZZYS='1' and T.JU_YSQK='1' and T.JU_SFZLCD='1' %Condition%),\
(select count(GC_JH_SJ_ID) QLL_ZJZBA 	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ = '1' and T.JU_SFZZYS='1' and T.JU_YSQK='1' and T.JU_SFZJZBA='1' %Condition%)
#--创建临时表,道路类
SJ_SJGL_DLL=with WITH_JJG as (select A.*,B.JU_KSRQ,B.JU_SFBZJZ,B.JU_JBYSTJ,B.JU_SFZZYS,B.JU_YSQK,B.JU_SFZLCD,B.JU_SFZJZBA,B.JA_KSRQ from VIEW_GC_JH_SJ A,GC_SJGL_JJG B where A.GC_JH_SJ_ID=B.JHSJID)\
select * from\
(select count(GC_JH_SJ_ID) DLL_YWG    		from VIEW_GC_JH_SJ T where BDBS='1' and T.WGSJ_SJ is not null %Condition%),\
(select count(GC_JH_SJ_ID) DLL_YTJ    		from VIEW_GC_JH_SJ T where BDBS='1' and T.WGSJ_SJ is not null and TBJJG='1' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_WTJ    		from VIEW_GC_JH_SJ T where BDBS='1' and T.WGSJ_SJ is not null and (TBJJG != '1'OR TBJJG IS  NULL) %Condition%),\
(select count(GC_JH_SJ_ID) DLL_ZGB    		from VIEW_GC_JH_SJ T where BDBS='1' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_JUNGYS   	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_BZJZ   		from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_WBZJZ   		from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and (JU_SFBZJZ != '1'OR JU_SFBZJZ IS  NULL)  %Condition%),\
(select count(GC_JH_SJ_ID) DLL_JBYSTJ   	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ='1' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_BJBYSTJ   	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and (JU_JBYSTJ != '1'OR JU_JBYSTJ IS  NULL) %Condition%),\
(select count(GC_JH_SJ_ID) DLL_ZZJGYS   	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ='1' and T.JU_SFZZYS='1' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_WZZJGYS   	from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ='1' and (JU_SFZZYS != '1'OR JU_SFZZYS IS  NULL) %Condition%),\
(select count(GC_JH_SJ_ID) DLL_YSHG   		from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ='1' and T.JU_SFZZYS='1' and T.JU_YSQK='1' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_JBZJ   		from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ='1' and T.JU_SFZZYS='1' and T.JU_YSQK='2' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_ZZZG   		from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ='1' and T.JU_SFZZYS='1' and T.JU_YSQK='3' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_ZLCD   		from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ='1' and T.JU_SFZZYS='1' and T.JU_YSQK='1' and T.JU_SFZLCD='1' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_ZJZBA   		from WITH_JJG T where JU_KSRQ is not null and TBJJG='1' and BDBS='1' and JU_SFBZJZ='1' and JU_JBYSTJ='1' and T.JU_SFZZYS='1' and T.JU_YSQK='1' and T.JU_SFZJZBA='1' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_JGYS   		from WITH_JJG T where JA_KSRQ is not null and TBJJG='1' and BDBS='1' %Condition%),\
(select count(GC_JH_SJ_ID) DLL_YJG   		from WITH_JJG T where JA_KSRQ is not null and TBJJG='1' and BDBS='1' and JG_SJ is not null %Condition%),\
(select count(GC_JH_SJ_ID) DLL_WJG   		from WITH_JJG T where JA_KSRQ is not null and TBJJG='1' and BDBS='1' and JG_SJ is null %Condition%)

#设计部门-设计管理-统筹概况
SJ_SJGL_TCGK=select * from  \
(SELECT NVL(COUNT(distinct DXID), 0) SJ_SJGL_TCGK_JGZX_DX  FROM VIEW_GC_JH_DX T where T.DXID is not null  %Condition% ), \
(SELECT NVL(COUNT(GC_JH_SJ_ID), 0) SJ_SJGL_TCGK_JGZX_ZX  FROM VIEW_GC_JH_SJ T  WHERE XMBS = '0'  %Condition% ), \
(SELECT count(distinct DXID) 	SJ_SJGL_TCGK_XINJ_DX FROM VIEW_GC_JH_DX T,GC_CJJH C where T.DXID=C.GC_CJJH_ID and T.DXID is not null and C.XMXZ='0' %Condition%), \
(SELECT COUNT(GC_JH_SJ_ID) 		SJ_SJGL_TCGK_XINJ_ZX FROM VIEW_GC_JH_SJ T WHERE XMBS='0' AND XMXZ='0' %Condition%), \
(SELECT count(distinct DXID) 	SJ_SJGL_TCGK_XUJ_DX  FROM VIEW_GC_JH_DX T,GC_CJJH C where T.DXID=C.GC_CJJH_ID and T.DXID is not null and C.XMXZ='1' %Condition%), \
(SELECT COUNT(GC_JH_SJ_ID) 		SJ_SJGL_TCGK_XUJ_ZX  FROM VIEW_GC_JH_SJ T WHERE XMBS='0' AND XMXZ='1' %Condition%) \

#--标段都完才算一个项目 都考虑续建项目 YWG_ZX
#---标段 YWG_BD
#--交工 YJG_ZX
#---标段 YJG_BD
#--竣工 YJG_ZX
#---标段 YJG_BD
SJ_JGJVG_TCGK=SELECT * FROM  \
(select COUNT(A.XMID) 			YWG_ZX   from (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.BDBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.WGSJ_SJ IS NOT NULL %glNdCon%) %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE 1=1 %Condition% AND T.BDBS = '1' GROUP BY T.XMID) B  WHERE A.XMID = B.XMID    AND A.BDWCS >= BDS), \
(select NVL(SUM(A.BDWCS),0) 	YWG_BD   from (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.BDBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.WGSJ_SJ IS NOT NULL %glNdCon%) %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE 1=1 %Condition% AND T.BDBS = '1' GROUP BY T.XMID) B  WHERE A.XMID = B.XMID    AND A.BDWCS >= BDS), \
(SELECT COUNT(A.XMID) 			YJG_ZX   FROM (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.BDBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.JG_SJ IS NOT NULL   %glNdCon%) %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE 1=1 %Condition% AND T.BDBS = '1' GROUP BY T.XMID) B  WHERE A.XMID = B.XMID    AND A.BDWCS >= BDS), \
(SELECT NVL(SUM(A.BDWCS),0) 	YJG_BD   FROM (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.BDBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.JG_SJ IS NOT NULL   %glNdCon%) %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE 1=1 %Condition% AND T.BDBS = '1' GROUP BY T.XMID) B  WHERE A.XMID = B.XMID    AND A.BDWCS >= BDS), \
(SELECT COUNT(A.XMID) 			YJVG_ZX   FROM (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.BDBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.JS_SJ IS NOT NULL   %glNdCon%) %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE 1=1 %Condition% AND T.BDBS = '1' GROUP BY T.XMID) B  WHERE A.XMID = B.XMID    AND A.BDWCS >= BDS), \
(SELECT NVL(SUM(A.BDWCS),0) 	YJVG_BD   FROM (SELECT COUNT(T.GC_JH_SJ_ID) BDWCS, XMID FROM VIEW_GC_JH_SJ T WHERE T.SJWYBH IN (SELECT DISTINCT T.SJWYBH FROM VIEW_GC_JH_SJ T, (SELECT T.SJWYBH FROM VIEW_GC_JH_SJ T WHERE T.BDBS = '1' %Condition%) A WHERE T.SJWYBH = A.SJWYBH AND T.JS_SJ IS NOT NULL   %glNdCon%) %Condition% GROUP BY T.XMID) A, (SELECT COUNT(*) BDS, XMID FROM VIEW_GC_JH_SJ T WHERE 1=1 %Condition% AND T.BDBS = '1' GROUP BY T.XMID) B  WHERE A.XMID = B.XMID    AND A.BDWCS >= BDS) \
   
#交（竣）工验收管理 统筹概况（不统计子项）
#完工 标段 YWG_BD
#交工 标段 YJG_BD
#竣工 标段 YJVG_BD
#设计变更xx次 SJBG_CS--考虑续建 所有的项目和标段
#涉及xx子项 SJBG_ZX--考虑续建 所有的项目
#xx标段--SJBG_BD考虑续建 所有的标段
#变更金额共计xx万元--考虑续建 所有的项目和标段
JS_JGJVG_TCGK_NEW=SELECT * FROM \
(select COUNT(*) YWG_BD from VIEW_GC_JH_SJ t where t.wgsj_sj is not null  %Condition% and T.BDBS = '1'), \
(select COUNT(*) YJG_BD from VIEW_GC_JH_SJ t where t.jg_sj is not null  %Condition% and T.BDBS = '1'), \
(select COUNT(*) YJVG_BD from VIEW_GC_JH_SJ t where t.js_sj is not null  %Condition% and T.BDBS = '1'), \
(SELECT NVL(COUNT(A.GC_SJ_SJBG_JS2_ID),'0')  SJBG_CS FROM GC_SJ_SJBG_JS2 A,VIEW_GC_JH_SJ  T WHERE  A.SJWYBH=T.SJWYBH AND A.SFYX='1' %Condition%),\
(SELECT NVL(COUNT(DISTINCT T.XMWYBH),'0')  SJBG_ZX FROM GC_SJ_SJBG_JS2 A,VIEW_GC_JH_SJ  T WHERE A.SJWYBH=T.SJWYBH AND A.SFYX='1' %Condition%),\
(SELECT NVL(COUNT(DISTINCT T.GC_JH_SJ_ID),'0')  SJBG_BD FROM GC_SJ_SJBG_JS2 A,VIEW_GC_JH_SJ  T WHERE A.SJWYBH=T.SJWYBH AND A.SFYX='1' %Condition% AND BDBS='1'),\
(SELECT NVL(TO_CHAR((NVL(SUM(A.BGFY),0)) / 10000, 'FM999999999999990.00'), 0)  SJBG_JE FROM GC_SJ_SJBG_JS2 A,VIEW_GC_JH_SJ  T WHERE A.SJWYBH=T.SJWYBH AND A.SFYX='1' %Condition%)


