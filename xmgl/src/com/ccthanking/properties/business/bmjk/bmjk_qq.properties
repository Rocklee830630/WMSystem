
# 部门监控-前期部-计划项目数
BMJK_QQ_XM_MAX=SELECT GC_JH_SJ_ID  \
		FROM GC_JH_SJ JHSJ WHERE BDID IS NULL AND  SFYX = '1' AND \
		(JHSJ.ISSGXK = '1' OR JHSJ.ISKYPF='1' OR JHSJ.ISGCXKZ='1' AND JHSJ.ISHPJDS='1') 

# 部门监控-前期部-计划标段数
BMJK_QQ_BD_MAX=WITH SXXX AS \
    (SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,JH1.ISKYPF AS ZT FROM GC_JH_SJ JH1 WHERE JH1.XMBS = '0' AND JH1.ISNOBDXM = '1' \
    UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,JH1.ISHPJDS AS ZT FROM GC_JH_SJ JH1 WHERE JH1.XMBS = '0' AND JH1.ISNOBDXM = '1' \
    UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,JH1.ISGCXKZ AS ZT FROM GC_JH_SJ JH1 WHERE JH1.XMBS = '0' AND JH1.ISNOBDXM = '1' \
    UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,JH1.ISSGXK AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NOT NULL OR (XMBS = '0' AND ISNOBDXM = '1')) \
    SELECT GC_JH_SJ_ID \
	FROM GC_JH_SJ JHSJ WHERE JHSJ.GC_JH_SJ_ID NOT IN \
	(SELECT GC_JH_SJ_ID FROM GC_JH_SJ WHERE XMBS = '0' AND ISNOBDXM = '0') AND SFYX = '1' AND \
	JHSJ.GC_JH_SJ_ID IN (SELECT GC_JH_SJ_ID FROM SXXX WHERE ZT='1')
		
# 部门监控-前期部-项目办结
BMJK_QQ_XM_BJ=WITH SXXX AS (SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID, JH1.ISKYPF||'#'||JH1.KYPF_SJ AS MARK,JH1.ISKYPF AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NULL AND JH1.ISKYPF='1' \
		UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,JH1.ISHPJDS||'#'||JH1.HPJDS_SJ AS MARK,JH1.ISHPJDS AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NULL AND JH1.ISHPJDS='1' \
		UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID, JH1.ISGCXKZ||'#'||JH1.GCXKZ_SJ AS MARK,JH1.ISGCXKZ AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NULL AND JH1.ISGCXKZ='1' \
		UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,JH1.ISSGXK||'#'||JH1.SGXK_SJ AS MARK,JH1.ISSGXK AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NULL AND JH1.ISSGXK='1'), \
		SJXX AS (SELECT DISTINCT XMID FROM SXXX WHERE XMID NOT IN (SELECT DISTINCT XMID FROM SXXX WHERE MARK='1#'))\
		SELECT GC_JH_SJ_ID  \
		FROM GC_JH_SJ JHSJ WHERE BDID IS NULL AND  SFYX = '1' AND \
		JHSJ.XMID IN (SELECT DISTINCT XMID FROM SJXX WHERE XMID IS NOT NULL) 

# 部门监控-前期部-标段办结
BMJK_QQ_BD_BJ=WITH SXXX AS \
    (SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID, JH1.ISKYPF||'#'||JH1.KYPF_SJ AS MARK,JH1.ISKYPF AS ZT FROM GC_JH_SJ JH1 WHERE JH1.XMBS = '0' AND JH1.ISNOBDXM = '1' \
    UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,JH1.ISHPJDS||'#'||JH1.HPJDS_SJ AS MARK,JH1.ISHPJDS AS ZT FROM GC_JH_SJ JH1 WHERE JH1.XMBS = '0' AND JH1.ISNOBDXM = '1' \
    UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID, JH1.ISGCXKZ||'#'||JH1.GCXKZ_SJ AS MARK,JH1.ISGCXKZ AS ZT FROM GC_JH_SJ JH1 WHERE JH1.XMBS = '0' AND JH1.ISNOBDXM = '1' \
    UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,JH1.ISSGXK||'#'||JH1.SGXK_SJ AS MARK,JH1.ISSGXK AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NOT NULL OR (XMBS = '0' AND ISNOBDXM = '1')), \
    SJXX AS (SELECT DISTINCT GC_JH_SJ_ID AS JHSJID FROM SXXX WHERE GC_JH_SJ_ID NOT IN (SELECT DISTINCT GC_JH_SJ_ID FROM SXXX WHERE MARK ='1#' )) \
	SELECT GC_JH_SJ_ID  \
	FROM GC_JH_SJ JHSJ WHERE SFYX='1' AND \
	JHSJ.GC_JH_SJ_ID IN (SELECT DISTINCT JHSJID FROM SJXX WHERE SJXX.JHSJID IS NOT NULL)

# 部门监控-前期部-项目反馈
BMJK_QQ_XM_FK=SELECT GC_JH_SJ_ID  \
		FROM GC_JH_SJ JHSJ WHERE BDID IS NULL AND  SFYX = '1' AND \
		(JHSJ.ISSGXK = '1' OR JHSJ.ISKYPF='1' OR JHSJ.ISGCXKZ='1' AND JHSJ.ISHPJDS='1') AND \
		JHSJ.GC_JH_SJ_ID IN (SELECT DISTINCT JHSJID FROM GC_JH_FKQK WHERE YWLX='070001' AND SFYX='1')

# 部门监控-前期部-标段反馈
BMJK_QQ_BD_FK=SELECT GC_JH_SJ_ID  \
		FROM GC_JH_SJ JHSJ WHERE SFYX='1' AND JHSJ.GC_JH_SJ_ID NOT IN \
		(SELECT GC_JH_SJ_ID FROM GC_JH_SJ WHERE XMBS = '0' AND ISNOBDXM = '0') AND \
		JHSJ.GC_JH_SJ_ID IN (SELECT DISTINCT JHSJID FROM GC_JH_FKQK WHERE YWLX='070001' AND SFYX='1')
		
# 部门监控-前期部-项目拖期
BMJK_QQ_XM_TQ=WITH SXXX AS (SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,NVL(JH1.KYPF_SJ,SYSDATE) AS SJ,JH1.KYPF AS JH,JH1.ISKYPF AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NULL \
		UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,NVL(JH1.HPJDS_SJ,SYSDATE) AS SJ,JH1.HPJDS AS JH,JH1.ISHPJDS AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NULL \
		UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,NVL(JH1.GCXKZ_SJ,SYSDATE) AS SJ,JH1.GCXKZ AS JH,JH1.ISGCXKZ AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NULL \
		UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,NVL(JH1.SGXK_SJ,SYSDATE) AS SJ,JH1.SGXK AS JH,JH1.ISSGXK AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NULL ), \
		INFO AS (SELECT DISTINCT (CASE WHEN ZT='1' AND SJ-NVL(JH,SJ)>10 THEN GC_JH_SJ_ID END) AS JHSJID FROM SXXX) \
		SELECT GC_JH_SJ_ID  \
		FROM GC_JH_SJ JHSJ WHERE SFYX = '1' AND \
		JHSJ.GC_JH_SJ_ID IN (SELECT JHSJID FROM INFO WHERE INFO.JHSJID IS NOT NULL)							

# 部门监控-前期部-标段拖期
BMJK_QQ_BD_TQ=WITH SXXX AS (SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,NVL(JH1.KYPF_SJ,SYSDATE) AS SJ,JH1.KYPF AS JH,JH1.ISKYPF AS ZT FROM GC_JH_SJ JH1 WHERE JH1.XMBS = '0' AND JH1.ISNOBDXM = '1' \
		UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,NVL(JH1.HPJDS_SJ,SYSDATE) AS SJ,JH1.HPJDS AS JH,JH1.ISHPJDS AS ZT FROM GC_JH_SJ JH1 WHERE JH1.XMBS = '0' AND JH1.ISNOBDXM = '1' \
		UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,NVL(JH1.GCXKZ_SJ,SYSDATE) AS SJ,JH1.GCXKZ AS JH,JH1.ISGCXKZ AS ZT FROM GC_JH_SJ JH1 WHERE JH1.XMBS = '0' AND JH1.ISNOBDXM = '1'\
		UNION SELECT JH1.XMID,JH1.GC_JH_SJ_ID,JH1.BDID,NVL(JH1.SGXK_SJ,SYSDATE) AS SJ,JH1.SGXK AS JH,JH1.ISSGXK AS ZT FROM GC_JH_SJ JH1 WHERE JH1.BDID IS NOT NULL OR (XMBS = '0' AND ISNOBDXM = '1')), \
		INFO AS (SELECT DISTINCT (CASE WHEN ZT='1' AND SJ-NVL(JH,SJ)>10 THEN GC_JH_SJ_ID END) AS JHSJID FROM SXXX) \
		SELECT GC_JH_SJ_ID  \
		FROM GC_JH_SJ JHSJ WHERE JHSJ.SFYX='1' AND \
		JHSJ.GC_JH_SJ_ID NOT IN (SELECT GC_JH_SJ_ID FROM GC_JH_SJ WHERE XMBS = '0' AND ISNOBDXM = '0') AND \
		JHSJ.GC_JH_SJ_ID IN (SELECT JHSJID FROM INFO WHERE INFO.JHSJID IS NOT NULL)		
		
# 部门监控-前期部-规划
BMJK_QQ_GH=SELECT XMID,XMBH,XMMC,XMXZ ,\
		(SELECT XMGLGS FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM = 1) AS XMGLGS,\
		(SELECT XMDZ FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM = 1) AS XMDZ,\
		(SELECT JSMB FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM=1) AS NDMB \
		FROM GC_JH_SJ JHSJ WHERE BDID IS NULL AND  SFYX = '1' AND \
		JHSJ.ISGCXKZ='1' AND JHSJ.GCXKZ_SJ IS NOT NULL

# 部门监控-前期部-土地
BMJK_QQ_TD=SELECT XMID,XMBH,XMMC,XMXZ ,\
		(SELECT XMGLGS FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM = 1) AS XMGLGS,\
		(SELECT XMDZ FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM = 1) AS XMDZ,\
		(SELECT JSMB FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM=1) AS NDMB \
		FROM GC_JH_SJ JHSJ WHERE BDID IS NULL AND  SFYX = '1' AND \
		JHSJ.ISHPJDS='1' AND JHSJ.HPJDS_SJ IS NOT NULL 

# 部门监控-前期部-立项
BMJK_QQ_LX=SELECT XMID,XMBH,XMMC,XMXZ ,\
		(SELECT XMGLGS FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM = 1) AS XMGLGS,\
		(SELECT XMDZ FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM = 1) AS XMDZ,\
		(SELECT JSMB FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM=1) AS NDMB \
		FROM GC_JH_SJ JHSJ WHERE BDID IS NULL AND  SFYX = '1' AND \
		JHSJ.ISKYPF='1' AND KYPF_SJ IS NOT NULL
		
# 部门监控-前期部-施工
BMJK_QQ_SG=SELECT XMID,XMBH,XMMC,BDMC,XMXZ, \
		(SELECT XMGLGS FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM = 1) AS XMGLGS,\
		(CASE WHEN JHSJ.BDID IS NULL THEN (SELECT XMDZ FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM = 1) \
		ELSE (SELECT BDDD FROM GC_XMBD WHERE GC_XMBD_ID = JHSJ.BDID AND ROWNUM = 1) END) AS XMDZ,\
		(SELECT JSMB FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM=1) AS NDMB \
		FROM GC_JH_SJ JHSJ WHERE SFYX='1' AND JHSJ.GC_JH_SJ_ID NOT IN \
		(SELECT GC_JH_SJ_ID FROM GC_JH_SJ WHERE XMBS = '0' AND ISNOBDXM = '0') \
		AND JHSJ.ISSGXK = '1' AND JHSJ.SGXK_SJ IS NOT NULL
		
# 部门监控-前期部-材料交接
BMJK_QQ_CL=SELECT XMID,XMBH,XMMC,BDMC,XMXZ, \
		(SELECT XMGLGS FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM = 1) AS XMGLGS,\
		(CASE WHEN JHSJ.BDID IS NULL THEN (SELECT XMDZ FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM = 1) \
		ELSE (SELECT BDDD FROM GC_XMBD WHERE GC_XMBD_ID = JHSJ.BDID AND ROWNUM = 1) END) AS XMDZ,\
		(SELECT JSMB FROM GC_TCJH_XMXDK WHERE ND = JHSJ.ND AND GC_TCJH_XMXDK_ID = JHSJ.XMID AND ROWNUM=1) AS NDMB \
		FROM GC_JH_SJ JHSJ WHERE SFYX='1' AND \
		JHSJ.GC_JH_SJ_ID IN (SELECT JHSJID FROM GC_ZGB_QQSX WHERE SFYX='1' AND JJSJ IS NOT NULL) 			 						 			 				