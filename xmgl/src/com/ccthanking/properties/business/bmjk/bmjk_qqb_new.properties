#立项可研批复手续进展
lxList=select '立项批复' mc,FUN_QQSX_YINGBL('%Condition%','2020','qq.LXKYBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','2020') yibanli, to_char('-') bfbl ,fun_qqsx_wbl('%Condition%','2020') weibanli,FUN_QQSX_BXBL('%Condition%','2020','qq.LXKYBBLSX') buxubanli from dual \
		union all \
		select '能评' mc,FUN_QQSX_YINGBL('%Condition%','2023','qq.LXKYBBLSX') yingbanli, FUN_QQSX_YIBL('%Condition%','2023') yibanli, to_char('-') bfbl, fun_qqsx_wbl('%Condition%','2023') weibanli, FUN_QQSX_BXBL('%Condition%','2023','qq.LXKYBBLSX') buxubanli from dual \
		union all \
		select '环评' mc,FUN_QQSX_YINGBL('%Condition%','2021','qq.LXKYBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','2021') yibanli, to_char('-') bfbl,fun_qqsx_wbl('%Condition%','2021') weibanli,FUN_QQSX_BXBL('%Condition%','2021','qq.LXKYBBLSX') buxubanli from dual \
		union all \
		select '选址意见书' mc,FUN_QQSX_YINGBL('%Condition%','0007','qq.GHSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0007') yibanli, to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0007') weibanli,FUN_QQSX_BXBL('%Condition%','0007','qq.GHSPBBLSX') buxubanli from dual \
		union all \
		select '土地意见函' mc,FUN_QQSX_YINGBL('%Condition%','2022','qq.LXKYBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','2022') yibanli, to_char('-') bfbl,fun_qqsx_wbl('%Condition%','2022') weibanli,FUN_QQSX_BXBL('%Condition%','2022','qq.LXKYBBLSX') buxubanli from dual \
		union all \
		select '可研批复' mc,FUN_QQSX_YINGBL('%Condition%','2024','qq.LXKYBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','2024') yibanli, to_char('-') bfbl,fun_qqsx_wbl('%Condition%','2024') weibanli,FUN_QQSX_BXBL('%Condition%','2024','qq.LXKYBBLSX') buxubanli from dual \

#土地手续进展
tdList=select '用地批准书' mc,FUN_QQSX_YINGBL('%Condition%','0023','qq.TDSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0023') yibanli,to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0023') weibanli,FUN_QQSX_BXBL('%Condition%','0023','qq.TDSPBBLSX') buxubanli from dual \
union all \
select '划拨决定书' mc,FUN_QQSX_YINGBL('%Condition%','0025','qq.TDSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0025') yibanli,to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0025') weibanli,FUN_QQSX_BXBL('%Condition%','0025','qq.TDSPBBLSX') buxubanli from dual \
union all \
select '登记发证' mc,FUN_QQSX_YINGBL('%Condition%','0014','qq.TDSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0014') yibanli,to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0014') weibanli,FUN_QQSX_BXBL('%Condition%','0014','qq.TDSPBBLSX') buxubanli from dual \

#规划手续进展
ghList=select '选址意见书' mc,FUN_QQSX_YINGBL('%Condition%','0007','qq.GHSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0007') yibanli,to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0007') weibanli,FUN_QQSX_BXBL('%Condition%','0007','qq.GHSPBBLSX') buxubanli from dual \
union all \
select '用地规划许可证' mc,FUN_QQSX_YINGBL('%Condition%','0008','qq.GHSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0008') yibanli,to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0008') weibanli,FUN_QQSX_BXBL('%Condition%','0008','qq.GHSPBBLSX') buxubanli from dual \
union all \
select '工程规划许可证' mc,FUN_QQSX_YINGBL('%Condition%','0009','qq.GHSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0009') yibanli,to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0009') weibanli,FUN_QQSX_BXBL('%Condition%','0009','qq.GHSPBBLSX') buxubanli from dual \

#各手续进展
sxList=select '立项批复' mc,FUN_QQSX_YINGBL('%Condition%','2020','qq.LXKYBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','2020') yibanli, to_char('-') bfbl ,fun_qqsx_wbl('%Condition%','2020') weibanli,FUN_QQSX_BXBL('%Condition%','2020','qq.LXKYBBLSX') buxubanli from dual \
union all \
select '可研批复' mc,FUN_QQSX_YINGBL('%Condition%','2024','qq.LXKYBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','2024') yibanli, to_char('-') bfbl,fun_qqsx_wbl('%Condition%','2024') weibanli,FUN_QQSX_BXBL('%Condition%','2024','qq.LXKYBBLSX') buxubanli from dual \
union all \
select '用地规划许可证' mc,FUN_QQSX_YINGBL('%Condition%','0008','qq.GHSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0008') yibanli,to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0008') weibanli,FUN_QQSX_BXBL('%Condition%','0008','qq.GHSPBBLSX') buxubanli from dual \
union all \
select '用地批准书' mc,FUN_QQSX_YINGBL('%Condition%','0023','qq.TDSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0023') yibanli,to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0023') weibanli,FUN_QQSX_BXBL('%Condition%','0023','qq.TDSPBBLSX') buxubanli from dual \
union all \
select '划拨决定书' mc,FUN_QQSX_YINGBL('%Condition%','0025','qq.TDSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0025') yibanli,to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0025') weibanli,FUN_QQSX_BXBL('%Condition%','0025','qq.TDSPBBLSX') buxubanli from dual \
union all \
select '工程规划许可证' mc,FUN_QQSX_YINGBL('%Condition%','0009','qq.GHSPBBLSX') yingbanli,FUN_QQSX_YIBL('%Condition%','0009') yibanli,to_char('-') bfbl,fun_qqsx_wbl('%Condition%','0009') weibanli,FUN_QQSX_BXBL('%Condition%','0009','qq.GHSPBBLSX') buxubanli from dual \
union all \
select '施工许可证' mc, fun_qqsx_yingbl('%Condition%','0022','qq.SGXKBBLSX') YINGBANLI,fun_qqsx_sg_blwc('%Condition%','0022') YIBANLI,to_char(fun_qqsx_sg_bfbl('%Condition%','0022')) BFBL ,fun_qqsx_sg_wbl('%Condition%','0022') WEIBANLI,fun_qqsx_bxbl('%Condition%','0022','qq.SGXKBBLSX') BUXUBANLI from dual \

#各手续进展柱形图
sxZxt=select * from(   \
select '1' xh,1 JDXH, '立项批复' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','2020','qq.LXKYBBLSX')) value from dual UNION ALL    \
select '3' xh,1 JDXH, '立项批复' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','2020')) value from dual UNION ALL    \
select '2' xh,1 JDXH, '立项批复' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,2 JDXH, '可研批复' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','2024','qq.LXKYBBLSX')) value from dual UNION ALL    \
select '3' xh,2 JDXH, '可研批复' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','2024')) value from dual UNION ALL    \
select '2' xh,2 JDXH, '可研批复' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,3 JDXH, '用地规划许可证' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0008','qq.GHSPBBLSX')) value from dual UNION ALL    \
select '3' xh,3 JDXH, '用地规划许可证' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0008')) value from dual UNION ALL    \
select '2' xh,3 JDXH, '用地规划许可证' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,4 JDXH, '用地批准书' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0023','qq.TDSPBBLSX')) value from dual UNION ALL    \
select '3' xh,4 JDXH, '用地批准书' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0023')) value from dual UNION ALL    \
select '2' xh,4 JDXH, '用地批准书' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,5 JDXH, '划拨决定书' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0012','qq.TDSPBBLSX')) value from dual UNION ALL    \
select '3' xh,5 JDXH, '划拨决定书' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0012')) value from dual UNION ALL    \
select '2' xh,5 JDXH, '划拨决定书' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,6 JDXH, '工程规划许可证' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0009','qq.GHSPBBLSX')) value from dual UNION ALL    \
select '3' xh,6 JDXH, '工程规划许可证' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0009')) value from dual UNION ALL   \
select '2' xh,6 JDXH, '工程规划许可证' LABEL, '部分办理' seriesname, '0' value from dual  UNION ALL \
select '1' xh,7 JDXH, '施工许可证' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0022','qq.SGXKBBLSX')) value from dual UNION ALL    \
select '3' xh,7 JDXH, '施工许可证' LABEL, '已办理' seriesname, to_char(fun_qqsx_sg_blwc('%Condition%','0022')) value from dual  UNION ALL  \
select '2' xh,7 JDXH, '施工许可证' LABEL, '部分办理' seriesname, to_char(fun_qqsx_sg_bfbl('%Condition%','0022')) value from dual   \
)  order by JDXH asc,XH asc \

#立项手续进展柱形图
lxZxt=select * from(   \
select '1' xh,1 JDXH, '立项批复' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','2020','qq.LXKYBBLSX')) value from dual UNION ALL    \
select '3' xh,1 JDXH, '立项批复' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','2020')) value from dual UNION ALL    \
select '2' xh,1 JDXH, '立项批复' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,2 JDXH, '能评' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','2023','qq.LXKYBBLSX')) value from dual UNION ALL    \
select '3' xh,2 JDXH, '能评' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','2023')) value from dual UNION ALL    \
select '2' xh,2 JDXH, '能评' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,3 JDXH, '环评' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','2021','qq.LXKYBBLSX')) value from dual UNION ALL    \
select '3' xh,3 JDXH, '环评' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','2021')) value from dual UNION ALL    \
select '2' xh,3 JDXH, '环评' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,4 JDXH, '选址意见书' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0007','qq.GHSPBBLSX')) value from dual UNION ALL    \
select '3' xh,4 JDXH, '选址意见书' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0007')) value from dual UNION ALL    \
select '2' xh,4 JDXH, '选址意见书' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,5 JDXH, '土地意见函' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','2022','qq.LXKYBBLSX')) value from dual UNION ALL    \
select '3' xh,5 JDXH, '土地意见函' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','2022')) value from dual UNION ALL    \
select '2' xh,5 JDXH, '土地意见函' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,6 JDXH, '可研批复' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','2024','qq.LXKYBBLSX')) value from dual UNION ALL    \
select '3' xh,6 JDXH, '可研批复' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','2024')) value from dual UNION ALL   \
select '2' xh,6 JDXH, '可研批复' LABEL, '部分办理' seriesname, '0' value from dual   \
)  order by JDXH asc,XH asc \

#土地手续进展柱形图
tdZxt=select * from(   \
select '1' xh,1 JDXH, '用地批准书' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0023','qq.TDSPBBLSX')) value from dual UNION ALL    \
select '3' xh,1 JDXH, '用地批准书' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0023')) value from dual UNION ALL    \
select '2' xh,1 JDXH, '用地批准书' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,2 JDXH, '划拨决定书' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0012','qq.TDSPBBLSX')) value from dual UNION ALL    \
select '3' xh,2 JDXH, '划拨决定书' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0012')) value from dual UNION ALL    \
select '2' xh,2 JDXH, '划拨决定书' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,3 JDXH, '登记发证' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0014','qq.TDSPBBLSX')) value from dual UNION ALL    \
select '3' xh,3 JDXH, '登记发证' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0014')) value from dual UNION ALL  \
select '2' xh,3 JDXH, '登记发证' LABEL, '部分办理' seriesname, '0' value from dual   \
) order by JDXH asc,XH asc \

#规划手续进展柱形图
ghZxt=select * from(   \
select '1' xh,1 JDXH, '选址意见书' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0007','qq.GHSPBBLSX')) value from dual UNION ALL    \
select '3' xh,1 JDXH, '选址意见书' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0007')) value from dual UNION ALL    \
select '2' xh,1 JDXH, '选址意见书' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,2 JDXH, '用地规划许可证' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0008','qq.GHSPBBLSX')) value from dual UNION ALL    \
select '3' xh,2 JDXH, '用地规划许可证' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0008')) value from dual UNION ALL    \
select '2' xh,2 JDXH, '用地规划许可证' LABEL, '部分办理' seriesname, '0' value from dual UNION ALL    \
select '1' xh,3 JDXH, '工程规划许可证' LABEL, '应办理' seriesname, to_char(FUN_QQSX_YINGBL('%Condition%','0009','qq.GHSPBBLSX')) value from dual UNION ALL    \
select '3' xh,3 JDXH, '工程规划许可证' LABEL, '已办理' seriesname, to_char(FUN_QQSX_YIBL('%Condition%','0009')) value from dual  UNION ALL   \
select '2' xh,3 JDXH, '工程规划许可证' LABEL, '部分办理' seriesname, '0' value from dual \
) order by JDXH asc,xh asc \

#施工手续进展柱形图
sgList=select '报建' mc, fun_qqsx_yingbl('%Condition%','0015','qq.SGXKBBLSX') YINGBANLI,fun_qqsx_sg_blwc('%Condition%','0015') YIBANLI,fun_qqsx_sg_bfbl('%Condition%','0015')BFBL ,fun_qqsx_sg_wbl('%Condition%','0015') WEIBANLI,fun_qqsx_bxbl('%Condition%','0015','qq.SGXKBBLSX') BUXUBANLI from dual \
union all \
select '招投标' mc, \
(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and (ISSGDW='1' or ISSGDW='2') and ND = '%Condition%') YINGBANLI, \
(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and (( \
       (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
       (select count(GC_JH_SJ_ID) BDZS from VIEW_GC_JH_SJ where XMID = T.XMID and (ISSGDW='1' or ISSGDW='2') and XMBS = '1') = \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') and XMBS = '1')) or  \
       (ISNOBDXM = '1' and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') )) \
   and ND = '%Condition%')  YIBANLI, \
(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and ( \
       (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
       (select count(GC_JH_SJ_ID) BDZS from VIEW_GC_JH_SJ where XMID = T.XMID and (ISSGDW='1' or ISSGDW='2') and XMBS = '1') >  \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') and XMBS = '1') and \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') and XMBS = '1') > 0 \
       ) and ND = '%Condition%') BFBL, \
(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' \
   and (((select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') \
             and XMBS = '1')=0) or (ISNOBDXM = '1' and (ISSGDW='1' and SGDW_SJ is null) and ISSGDW!='2'))  \
             and ND = '%Condition%') WEIBANLI, \
(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and ISSGDW='0' and ND = '%Condition%') BUXUBANLI from dual \
union all \
select '施工图审查备案' mc, \
(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and (ISSGT='1' or ISSGT='2') and ND = '%Condition%') YINGBANLI, \
(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' \
   and (((select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
       (select count(GC_JH_SJ_ID) BDZS from VIEW_GC_JH_SJ where XMID = T.XMID and (ISSGT='1' or ISSGT='2') and XMBS = '1') = \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGT='1' and SGT_SJ is not null) or ISSGT='2') and XMBS = '1')) or  \
       (ISNOBDXM = '1' and ((ISSGT='1' and SGT_SJ is not null) or ISSGT='2') )) \
   and ND = '%Condition%') YIBANLI, \
(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and ( \
       (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
       (select count(GC_JH_SJ_ID) BDZS from VIEW_GC_JH_SJ where XMID = T.XMID and (ISSGT='1' or ISSGT='2') and XMBS = '1') >  \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGT='1' and SGT_SJ is not null) or ISSGT='2') and XMBS = '1') and \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGT='1' and SGT_SJ is not null) or ISSGT='2') and XMBS = '1') > 0) \
   and ND = '%Condition%') BFBL, \
(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' \
   and (((select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGT='1' and SGT_SJ is not null) or ISSGT='2') and XMBS = '1')=0) or  \
       (ISNOBDXM = '1' and (ISSGT='1' and SGT_SJ is null) and ISSGT!='2')) \
   and ND = '%Condition%') WEIBANLI, \
(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and ISSGT='0' and ND = '%Condition%') BUXUBANLI from dual \
union all \
select '质量监督' mc, fun_qqsx_yingbl('%Condition%','0017','qq.SGXKBBLSX') YINGBANLI,fun_qqsx_sg_blwc('%Condition%','0017') YIBANLI,fun_qqsx_sg_bfbl('%Condition%','0017')BFBL ,fun_qqsx_sg_wbl('%Condition%','0017') WEIBANLI,fun_qqsx_bxbl('%Condition%','0017','qq.SGXKBBLSX') BUXUBANLI from dual \
union all \
select '安全管理' mc, fun_qqsx_yingbl('%Condition%','0018','qq.SGXKBBLSX') YINGBANLI,fun_qqsx_sg_blwc('%Condition%','0018') YIBANLI,fun_qqsx_sg_bfbl('%Condition%','0018')BFBL ,fun_qqsx_sg_wbl('%Condition%','0018') WEIBANLI,fun_qqsx_bxbl('%Condition%','0018','qq.SGXKBBLSX') BUXUBANLI from dual \
union all \
select '执法监督' mc, fun_qqsx_yingbl('%Condition%','0021','qq.SGXKBBLSX') YINGBANLI,fun_qqsx_sg_blwc('%Condition%','0021') YIBANLI,fun_qqsx_sg_bfbl('%Condition%','0021')BFBL ,fun_qqsx_sg_wbl('%Condition%','0021') WEIBANLI,fun_qqsx_bxbl('%Condition%','0021','qq.SGXKBBLSX') BUXUBANLI from dual \
union all \
select '双拖欠' mc, fun_qqsx_yingbl('%Condition%','0020','qq.SGXKBBLSX') YINGBANLI,fun_qqsx_sg_blwc('%Condition%','0020') YIBANLI,fun_qqsx_sg_bfbl('%Condition%','0020')BFBL ,fun_qqsx_sg_wbl('%Condition%','0020') WEIBANLI,fun_qqsx_bxbl('%Condition%','0020','qq.SGXKBBLSX') BUXUBANLI from dual \
union all \
select '其他' mc, fun_qqsx_yingbl('%Condition%','0016','qq.SGXKBBLSX') YINGBANLI,fun_qqsx_sg_blwc('%Condition%','0016') YIBANLI,fun_qqsx_sg_bfbl('%Condition%','0016')BFBL ,fun_qqsx_sg_wbl('%Condition%','0016') WEIBANLI,fun_qqsx_bxbl('%Condition%','0016','qq.SGXKBBLSX') BUXUBANLI from dual \
union all \
select '施工许可证' mc, fun_qqsx_yingbl('%Condition%','0022','qq.SGXKBBLSX') YINGBANLI,fun_qqsx_sg_blwc('%Condition%','0022') YIBANLI,fun_qqsx_sg_bfbl('%Condition%','0022')BFBL ,fun_qqsx_sg_wbl('%Condition%','0022') WEIBANLI,fun_qqsx_bxbl('%Condition%','0022','qq.SGXKBBLSX') BUXUBANLI from dual \

#施工柱形图
sgZxt=select * from(    \
select '1' xh,1 JDXH, '报建' LABEL, '应办理' seriesname, FUN_QQSX_YINGBL('%Condition%','0015','qq.SGXKBBLSX') value from dual UNION ALL     \
select '3' xh,1 JDXH, '报建' LABEL, '已办理' seriesname, fun_qqsx_sg_blwc('%Condition%','0015') value from dual UNION ALL      \
select '2' xh,1 JDXH, '报建' LABEL, '部分办理' seriesname, fun_qqsx_sg_bfbl('%Condition%','0015') value from dual UNION ALL    \
select '1' xh,2 JDXH, '招投标' LABEL, '应办理' seriesname, (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and (ISSGDW='1' or ISSGDW='2') and ND = '%Condition%') value from dual UNION ALL    \
select '3' xh,2 JDXH, '招投标' LABEL, '已办理' seriesname, (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and (( \
       (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
       (select count(GC_JH_SJ_ID) BDZS from VIEW_GC_JH_SJ where XMID = T.XMID and (ISSGDW='1' or ISSGDW='2') and XMBS = '1') = \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') and XMBS = '1')) or  \
       (ISNOBDXM = '1' and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') )) \
   and ND = '%Condition%') value from dual UNION ALL    \
select '2' xh,2 JDXH, '招投标' LABEL, '部分办理' seriesname, (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and ( \
       (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
       (select count(GC_JH_SJ_ID) BDZS from VIEW_GC_JH_SJ where XMID = T.XMID and (ISSGDW='1' or ISSGDW='2') and XMBS = '1') >  \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') and XMBS = '1') and \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') and XMBS = '1') > 0 \
       ) and ND = '%Condition%') value from dual UNION ALL    \
select '1' xh,3 JDXH, '施工图审查备案' LABEL, '应办理' seriesname, (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and (ISSGT='1' or ISSGT='2') and ND = '%Condition%') value from dual UNION ALL     \
select '3' xh,3 JDXH, '施工图审查备案' LABEL, '已办理' seriesname, (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' \
   and (((select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
       (select count(GC_JH_SJ_ID) BDZS from VIEW_GC_JH_SJ where XMID = T.XMID and (ISSGT='1' or ISSGT='2') and XMBS = '1') = \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGT='1' and SGT_SJ is not null) or ISSGT='2') and XMBS = '1')) or  \
       (ISNOBDXM = '1' and ((ISSGT='1' and SGT_SJ is not null) or ISSGT='2') )) \
   and ND = '%Condition%') value from dual UNION ALL    \
select '2' xh,3 JDXH, '施工图审查备案' LABEL, '部分办理' seriesname, (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and ( \
       (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
       (select count(GC_JH_SJ_ID) BDZS from VIEW_GC_JH_SJ where XMID = T.XMID and (ISSGT='1' or ISSGT='2') and XMBS = '1') >  \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGT='1' and SGT_SJ is not null) or ISSGT='2') and XMBS = '1') and \
       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGT='1' and SGT_SJ is not null) or ISSGT='2') and XMBS = '1') > 0) \
   and ND = '%Condition%') value from dual UNION ALL  \
select '1' xh,4 JDXH, '质量监督' LABEL, '应办理' seriesname, FUN_QQSX_YINGBL('%Condition%','0017','qq.SGXKBBLSX') value from dual UNION ALL     \
select '3' xh,4 JDXH, '质量监督' LABEL, '已办理' seriesname, fun_qqsx_sg_blwc('%Condition%','0017') value from dual UNION ALL    \
select '2' xh,4 JDXH, '质量监督' LABEL, '部分办理' seriesname, fun_qqsx_sg_bfbl('%Condition%','0017') value from dual UNION ALL  \
select '1' xh,5 JDXH, '安全管理' LABEL, '应办理' seriesname, FUN_QQSX_YINGBL('%Condition%','0018','qq.SGXKBBLSX') value from dual UNION ALL    \
select '3' xh,5 JDXH, '安全管理' LABEL, '已办理' seriesname, fun_qqsx_sg_blwc('%Condition%','0018') value from dual  UNION ALL  \
select '2' xh,5 JDXH, '安全管理' LABEL, '部分办理' seriesname, fun_qqsx_sg_bfbl('%Condition%','0018') value from dual  UNION ALL \
select '1' xh,6 JDXH, '执法监督' LABEL, '应办理' seriesname, FUN_QQSX_YINGBL('%Condition%','0021','qq.SGXKBBLSX') value from dual UNION ALL    \
select '3' xh,6 JDXH, '执法监督' LABEL, '已办理' seriesname, fun_qqsx_sg_blwc('%Condition%','0021') value from dual  UNION ALL  \
select '2' xh,6 JDXH, '执法监督' LABEL, '部分办理' seriesname, fun_qqsx_sg_bfbl('%Condition%','0021') value from dual  UNION ALL  \
select '1' xh,7 JDXH, '双拖欠' LABEL, '应办理' seriesname, FUN_QQSX_YINGBL('%Condition%','0020','qq.SGXKBBLSX') value from dual UNION ALL    \
select '3' xh,7 JDXH, '双拖欠' LABEL, '已办理' seriesname, fun_qqsx_sg_blwc('%Condition%','0020') value from dual  UNION ALL  \
select '2' xh,7 JDXH, '双拖欠' LABEL, '部分办理' seriesname, fun_qqsx_sg_bfbl('%Condition%','0020') value from dual  UNION ALL  \
select '1' xh,8 JDXH, '其他' LABEL, '应办理' seriesname, FUN_QQSX_YINGBL('%Condition%','0016','qq.SGXKBBLSX') value from dual UNION ALL    \
select '3' xh,8 JDXH, '其他' LABEL, '已办理' seriesname, fun_qqsx_sg_blwc('%Condition%','0016') value from dual  UNION ALL  \
select '2' xh,8 JDXH, '其他' LABEL, '部分办理' seriesname, fun_qqsx_sg_bfbl('%Condition%','0016') value from dual  UNION ALL  \
select '1' xh,9 JDXH, '施工许可证' LABEL, '应办理' seriesname, FUN_QQSX_YINGBL('%Condition%','0022','qq.SGXKBBLSX') value from dual UNION ALL    \
select '3' xh,9 JDXH, '施工许可证' LABEL, '已办理' seriesname, fun_qqsx_sg_blwc('%Condition%','0022') value from dual  UNION ALL  \
select '2' xh,9 JDXH, '施工许可证' LABEL, '部分办理' seriesname, fun_qqsx_sg_bfbl('%Condition%','0022') value from dual   \
) order by JDXH asc,xh asc \

#整体情况
QQ_ZTQK=SELECT * FROM  \
(select count(distinct DXID) DX from VIEW_GC_JH_DX T where T.DXID is not null and nd='%Condition%'), \
(SELECT nvl(count(GC_JH_SJ_ID),0)  ZX FROM VIEW_GC_JH_SJ T WHERE  XMBS='0' and nd='%Condition%'), \
(select  TO_CHAR(round(nvl(sum(CBK_JHZTZE/10000),0),3), 'FM999999999999999990.000') ZTZ from view_gc_jh_sj t where t.DXZX like '%0%' and  XMBS='0' and nd='%Condition%'), \
(select  TO_CHAR(round(nvl(sum(CBK_WCZTZE/10000),0),3), 'FM999999999999999990.000') JHWCTZ from view_gc_jh_sj t where t.DXZX like '%0%' and XMBS='0'  and nd='%Condition%') \

#导视图1建设选址项目意见书-选址意见书from dual \
DST1=select  (SELECT COUNT(T.GC_JH_SJ_ID) NDTCJH  FROM VIEW_GC_JH_SJ T   WHERE T.XMBS='0' and t.nd='%Condition%') NDTCJH,\
			 FUN_QQSX_YIBL('%Condition%','2020') XMJYSYIBANLI,\
			 fun_qqsx_wbl('%Condition%','2020')  XMJYSWEIBANLI,\
			 FUN_QQSX_BXBL('%Condition%','2020','qq.GHSPBBLSX') XMJYSBUXUBANLI ,\
			 FUN_QQSX_YIBL('%Condition%','2021') HPYIBANLI,\
			 FUN_QQSX_YIBL('%Condition%','2022') TDYIBANLI,\
			 FUN_QQSX_YIBL('%Condition%','0007') XZYJSYIBANLI ,\
			 FUN_QQSX_YIBL('%Condition%','2023') NPYIBANLI,\
			 FUN_QQSX_YIBL('%Condition%','2024') KYPFYIBANLI,\
  			 fun_qqsx_wbl('%Condition%','2024') KYPFYWEIBANLI,\
  			 FUN_QQSX_BXBL('%Condition%','2024','qq.LXKYBBLSX') KYPFYBUXUBANLI ,\
			 FUN_QQSX_YIBL('%Condition%','0008') JSYDYIBANLI ,\
			 fun_qqsx_wbl('%Condition%','0008') JSYDWEIBANLI, \
			 FUN_QQSX_BXBL('%Condition%','0008','qq.GHSPBBLSX') JSYDBUXUBANLI,\
			 FUN_QQSX_YIBL('%Condition%','0023') YDPZSYIBANLI ,\
			 fun_qqsx_wbl('%Condition%','0023') YDPZSWEIBANLI,\
			 FUN_QQSX_BXBL('%Condition%','0023','qq.TDSPBBLSX') YDPZSBUXUBANLI ,  \
		 	 FUN_QQSX_YIBL('%Condition%','0009') JSGCYIBANLI, \
		 	 fun_qqsx_wbl('%Condition%','0009') JSGCWEIBANLI,\
		 	 FUN_QQSX_BXBL('%Condition%','0009','qq.GHSPBBLSX') JSGCBUXUBANLI   from dual  \
		
#导视图2
DST2=select   	(SELECT COUNT(T.GC_JH_SJ_ID) NDTCJH  FROM VIEW_GC_JH_SJ T   WHERE T.XMBS='0' and t.nd='%Condition%') NDTCJH,\
				fun_qqsx_sg_blwc('%Condition%','0015') BJYIBANLI,\
				fun_qqsx_sg_bfbl('%Condition%','0015') BJBFBL ,\
				fun_qqsx_sg_wbl('%Condition%','0015') BJWEIBANLI ,\
				(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and (( \
				       (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
				       (select count(GC_JH_SJ_ID) BDZS from VIEW_GC_JH_SJ where XMID = T.XMID and (ISSGDW='1' or ISSGDW='2') and XMBS = '1') = \
				       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') and XMBS = '1')) or  \
				       (ISNOBDXM = '1' and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') )) \
				   and ND = '%Condition%')  ZBYIBANLI, \
				(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and ( \
				       (select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
				       (select count(GC_JH_SJ_ID) BDZS from VIEW_GC_JH_SJ where XMID = T.XMID and (ISSGDW='1' or ISSGDW='2') and XMBS = '1') >  \
				       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') and XMBS = '1') and \
				       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') and XMBS = '1') > 0 \
				       ) and ND = '%Condition%') ZBBFBL, \
				(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' \
				   and (((select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ where XMID = T.XMID and XMBS = '1') > 0 and \
				       (select count(GC_JH_SJ_ID) YWBD from VIEW_GC_JH_SJ where XMID = T.XMID and ((ISSGDW='1' and SGDW_SJ is not null) or ISSGDW='2') \
				             and XMBS = '1')=0) or (ISNOBDXM = '1' and (ISSGDW='1' and SGDW_SJ is null) and ISSGDW!='2'))  \
				             and ND = '%Condition%') ZBWEIBANLI, \
					(select count(GC_JH_SJ_ID) from VIEW_GC_JH_SJ T where XMBS = '0' and ISSGDW='0' and ND = '%Condition%') ZBBUXUBANLI,\
				FUN_QQSX_YIBL('%Condition%','0009') JSGCYIBANLI, \
		 	 	fun_qqsx_wbl('%Condition%','0009') JSGCWEIBANLI,\
			 	FUN_QQSX_BXBL('%Condition%','0009','qq.GHSPBBLSX') JSGCBUXUBANLI,   \
 				fun_qqsx_sg_blwc('%Condition%','0022') SGXKYIBANLI,\
 				fun_qqsx_sg_wbl('%Condition%','0022') SGXKWEIBANLI,\
 				fun_qqsx_bxbl('%Condition%','0022','qq.SGXKBBLSX') SGXKBUXUBANLI,  \
				FUN_QQSX_SG_BLWC_YKG('%Condition%','0022') SGXK_YKG,\
				FUN_QQSX_SG_BLWC_WKG('%Condition%','0022') SGXK_WKG,\
				FUN_QQSX_SG_WBL_YKG('%Condition%','0022') SGXKWG_YKG,\
				FUN_QQSX_SG_WBL_WKG('%Condition%','0022') SGXKWG_WKG ,\
				(SELECT   COUNT(DISTINCT T.XMID) YKG FROM VIEW_GC_JH_SJ T WHERE T.BDBS='1' AND T.KGSJ_SJ IS NOT NULL AND T.ND='%Condition%') YKG,\
				(SELECT  COUNT(DISTINCT T.XMID)  WKG FROM VIEW_GC_JH_SJ T WHERE T.BDBS='1' AND T.XMID NOT IN (\
				SELECT   DISTINCT T.XMID  YKG FROM VIEW_GC_JH_SJ T WHERE T.BDBS='1' AND T.KGSJ_SJ IS NOT NULL ) AND T.ND='%Condition%') WKG , \
				 (select count(distinct A.XMID) YBQXSP from (select count(distinct GC_JH_SJ_ID) BDZS,XMID from VIEW_GC_JH_SJ where (ISSGXK='1' or ISSGXK='2') and BDBS='1' group by XMID) A,\
				(select count(distinct T.GC_JH_SJ_ID) BDS,XMID \
				  from (select JH.SJWYBH,\
				               case when (Q.SGXKBBLSX like '%0016%' or S.FJLX like '%0016%') then 1 else 0 end SX1,\
				               case when (Q.SGXKBBLSX like '%0017%' or S.FJLX like '%0017%') then 1 else 0 end SX2,\
				               case when (Q.SGXKBBLSX like '%0018%' or S.FJLX like '%0018%') then 1 else 0 end SX3,\
				               case when (Q.SGXKBBLSX like '%0019%' or S.FJLX like '%0019%') then 1 else 0 end SX4,\
				               case when (Q.SGXKBBLSX like '%0020%' or S.FJLX like '%0020%') then 1 else 0 end SX5,\
				               case when (Q.SGXKBBLSX like '%0021%' or S.FJLX like '%0021%') then 1 else 0 end SX6,\
				               case when (Q.SGXKBBLSX like '%0022%' or S.FJLX like '%0022%') then 1 else 0 end SX7  \
				          from VIEW_GC_JH_SJ JH, \
				          (select * from GC_ZGB_QQSX where SFYX='1') Q, \
				          (select SJWYBH,wmsys.wm_concat(FJLX) FJLX from GC_QQSX_SXFJ where SFYX='1' group by SJWYBH) S \
				         where JH.SJWYBH = Q.SJWYBH(+)  \
				           and JH.SJWYBH = S.SJWYBH(+)) A,  \
				       VIEW_GC_JH_SJ T  \
				 where A.SJWYBH = T.SJWYBH  \
				   and T.ND = '%Condition%'  \
				   and BDBS='1'  \
				   and SX1 = 1 and SX2 = 1 and SX3 = 1 and SX4 = 1 and SX5 = 1 and SX6 = 1 and SX7 = 1  \
				   group by T.XMID) B   \
				   where A.XMID=B.XMID and A.BDZS=B.BDS) YBSPQX,\
			(select count(distinct XMID) WBQXSP  \
  			from (select JH.SJWYBH,  \
               case when (Q.SGXKBBLSX like '%0016%' or S.FJLX like '%0016%') then 1 else 0 end SX1,  \
               case when (Q.SGXKBBLSX like '%0017%' or S.FJLX like '%0017%') then 1 else 0 end SX2,  \
               case when (Q.SGXKBBLSX like '%0018%' or S.FJLX like '%0018%') then 1 else 0 end SX3,  \
               case when (Q.SGXKBBLSX like '%0019%' or S.FJLX like '%0019%') then 1 else 0 end SX4,  \
               case when (Q.SGXKBBLSX like '%0020%' or S.FJLX like '%0020%') then 1 else 0 end SX5,  \
               case when (Q.SGXKBBLSX like '%0021%' or S.FJLX like '%0021%') then 1 else 0 end SX6,  \
               case when (Q.SGXKBBLSX like '%0022%' or S.FJLX like '%0022%') then 1 else 0 end SX7  \
          from VIEW_GC_JH_SJ JH,   \
          (select * from GC_ZGB_QQSX where SFYX='1') Q,   \
          (select SJWYBH,wmsys.wm_concat(FJLX) FJLX from GC_QQSX_SXFJ where SFYX='1' group by SJWYBH) S  \
         where JH.SJWYBH = Q.SJWYBH(+)  \
           and JH.SJWYBH = S.SJWYBH(+)) A,  \
       VIEW_GC_JH_SJ T  \
 where A.SJWYBH = T.SJWYBH  \
   and T.ND = '%Condition%'  \
   and BDBS='1'  \
   and (SX1 = 0 or SX2 = 0 or SX3 = 0 or SX4 = 0 or SX5 = 0 or SX6 = 0 or SX7 = 0)) WBQXSP  \
				 from dual 























